{"version":3,"file":"game.bundle.js","mappings":"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","sources":["webpack://wolfenstein/webpack/runtime/create fake namespace object","webpack://wolfenstein/webpack/runtime/load script","webpack://wolfenstein/./src/game/style.css","webpack://wolfenstein/./node_modules/css-loader/dist/runtime/api.js","webpack://wolfenstein/./node_modules/css-loader/dist/runtime/sourceMaps.js","webpack://wolfenstein/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://wolfenstein/./node_modules/style-loader/dist/runtime/insertBySelector.js","webpack://wolfenstein/./node_modules/style-loader/dist/runtime/insertStyleElement.js","webpack://wolfenstein/./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js","webpack://wolfenstein/./node_modules/style-loader/dist/runtime/styleDomAPI.js","webpack://wolfenstein/./node_modules/style-loader/dist/runtime/styleTagTransform.js","webpack://wolfenstein/./src/game/levels|lazy|/^/.*/.json$/|groupOptions: {}|namespace object","webpack://wolfenstein/webpack/bootstrap","webpack://wolfenstein/webpack/runtime/compat get default export","webpack://wolfenstein/webpack/runtime/define property getters","webpack://wolfenstein/webpack/runtime/ensure chunk","webpack://wolfenstein/webpack/runtime/get javascript chunk filename","webpack://wolfenstein/webpack/runtime/hasOwnProperty shorthand","webpack://wolfenstein/webpack/runtime/make namespace object","webpack://wolfenstein/webpack/runtime/publicPath","webpack://wolfenstein/webpack/runtime/jsonp chunk loading","webpack://wolfenstein/./src/game/style.css?affd","webpack://wolfenstein/./src/game/components/programs/Program.ts","webpack://wolfenstein/./src/game/components/programs/ColorProgram.ts","webpack://wolfenstein/./src/game/shaders/color.vs","webpack://wolfenstein/./src/game/shaders/color.fs","webpack://wolfenstein/./src/game/components/programs/TextureProgram.ts","webpack://wolfenstein/./src/game/shaders/texture.vs","webpack://wolfenstein/./src/game/shaders/texture.fs","webpack://wolfenstein/./src/game/components/utils/utils.ts","webpack://wolfenstein/./src/game/components/utils/m4.ts","webpack://wolfenstein/./src/game/components/utils/Vec2.ts","webpack://wolfenstein/./src/game/components/utils/Vec3.ts","webpack://wolfenstein/./src/game/components/utils/Transform.ts","webpack://wolfenstein/./src/game/components/shapes/level/Shape.ts","webpack://wolfenstein/./src/game/components/shapes/level/CuboidBoundingBox.ts","webpack://wolfenstein/./src/game/components/shapes/level/Cuboid.ts","webpack://wolfenstein/./src/game/components/Config.ts","webpack://wolfenstein/./src/game/components/BetterAudio.ts","webpack://wolfenstein/./src/game/components/shapes/level/Door.ts","webpack://wolfenstein/./src/game/components/shapes/ui/Menu.ts","webpack://wolfenstein/./src/game/components/shapes/ui/LevelEnd.ts","webpack://wolfenstein/./src/game/components/shapes/ui/Weapon.ts","webpack://wolfenstein/./src/game/components/shapes/ui/Weapons.ts","webpack://wolfenstein/./src/game/components/shapes/ui/LoadingScreen.ts","webpack://wolfenstein/./src/game/components/shapes/ui/DeathScreen.ts","webpack://wolfenstein/./src/game/components/shapes/ui/UI.ts","webpack://wolfenstein/./src/game/components/Input.ts","webpack://wolfenstein/./src/game/components/Camera.ts","webpack://wolfenstein/./src/game/components/Textures.ts","webpack://wolfenstein/./src/game/components/shapes/level/Wall.ts","webpack://wolfenstein/./src/common/NotCollidingFieldValues.ts","webpack://wolfenstein/./src/game/components/Pathfinder.ts","webpack://wolfenstein/./src/game/components/Raycaster.ts","webpack://wolfenstein/./src/game/components/shapes/level/Plane.ts","webpack://wolfenstein/./src/game/components/shapes/level/pickups/Pickup.ts","webpack://wolfenstein/./src/game/components/shapes/level/pickups/Ammo.ts","webpack://wolfenstein/./src/game/components/shapes/level/pickups/Flag.ts","webpack://wolfenstein/./src/game/components/shapes/level/Enemy.ts","webpack://wolfenstein/./src/game/components/shapes/level/pickups/HealthItem.ts","webpack://wolfenstein/./src/game/components/shapes/level/pickups/DogFood.ts","webpack://wolfenstein/./src/game/components/shapes/level/pickups/Food.ts","webpack://wolfenstein/./src/game/components/shapes/level/pickups/HealthPack.ts","webpack://wolfenstein/./src/game/components/shapes/level/pickups/Machinegun.ts","webpack://wolfenstein/./src/common/DecorationMap.ts","webpack://wolfenstein/./src/game/components/shapes/level/GridBoundingBox.ts","webpack://wolfenstein/./src/game/components/shapes/level/decorations/Decoration.ts","webpack://wolfenstein/./src/game/components/shapes/level/pickups/PointItem.ts","webpack://wolfenstein/./src/game/components/shapes/level/pickups/GoldenCross.ts","webpack://wolfenstein/./src/game/components/shapes/level/pickups/GoldenCup.ts","webpack://wolfenstein/./src/game/components/shapes/level/pickups/GoldenBox.ts","webpack://wolfenstein/./src/game/components/shapes/level/pickups/GoldenCrown.ts","webpack://wolfenstein/./src/game/components/shapes/level/pickups/PowerUp.ts","webpack://wolfenstein/./src/game/components/shapes/level/Lever.ts","webpack://wolfenstein/./src/game/components/shapes/level/WallSecretDoor.ts","webpack://wolfenstein/./src/game/components/Level.ts","webpack://wolfenstein/./src/game/components/shapes/ui/Crosshair.ts","webpack://wolfenstein/./src/game/components/Game.ts","webpack://wolfenstein/./src/game/index.ts"],"sourcesContent":["var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","var inProgress = {};\nvar dataWebpackPrefix = \"wolfenstein:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\t;\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"html, body {\\r\\n    margin: 0;\\r\\n    height: 100%;\\r\\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\\r\\n    color: white;\\r\\n}\\r\\n\\r\\nbody {\\r\\n    height: 100vh;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    justify-content: center;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n#canvas {\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    /* display: block; */\\r\\n    visibility: hidden;\\r\\n    top: 0;\\r\\n    bottom: 0;\\r\\n    left: 0;\\r\\n    right: 0;\\r\\n    /* width: 1; */\\r\\n    position: absolute;\\r\\n}\\r\\n\\r\\nmain {\\r\\n    /* height: 100%;\\r\\n    display: flex;\\r\\n    justify-content: center;\\r\\n    align-items: center; */\\r\\n}\\r\\n\\r\\n#uiCanvas {\\r\\n    /* width: 100%;\\r\\n    height: 100%; */\\r\\n    display: block;\\r\\n\\r\\n    image-rendering: -moz-crisp-edges;\\r\\n    image-rendering: -webkit-crisp-edges;\\r\\n    image-rendering: pixelated;\\r\\n    image-rendering: crisp-edges;\\r\\n}\\r\\n\\r\\n#ui {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    width: 100vw;\\r\\n    height: 50px;\\r\\n    opacity: 0.9;\\r\\n    background-color: black;\\r\\n    display: flex;\\r\\n    justify-content: center;\\r\\n}\\r\\n\\r\\n#ui > * {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    align-items: center;\\r\\n    min-width: 100px;\\r\\n}\\r\\n\\r\\n#levelEditor {\\r\\n    background-color: red;\\r\\n    opacity: 0.9;\\r\\n    position: absolute;\\r\\n    bottom: 0px;\\r\\n    left: 0px;\\r\\n    border-radius: 5px;\\r\\n    padding: 10px;\\r\\n    margin: 5px;\\r\\n    display: flex;\\r\\n    justify-content: center;\\r\\n    align-items: center;\\r\\n    text-align: center;\\r\\n}\\r\\n\\r\\n#levelEditor > * {\\r\\n    text-decoration: none;\\r\\n    color: white;\\r\\n}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/game/style.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,SAAS;IACT,YAAY;IACZ,4DAA4D;IAC5D,YAAY;AAChB;;AAEA;IACI,aAAa;IACb,aAAa;IACb,sBAAsB;IACtB,uBAAuB;IACvB,mBAAmB;AACvB;;AAEA;IACI,WAAW;IACX,YAAY;IACZ,oBAAoB;IACpB,kBAAkB;IAClB,MAAM;IACN,SAAS;IACT,OAAO;IACP,QAAQ;IACR,cAAc;IACd,kBAAkB;AACtB;;AAEA;IACI;;;0BAGsB;AAC1B;;AAEA;IACI;mBACe;IACf,cAAc;;IAEd,iCAAiC;IACjC,oCAAoC;IACpC,0BAA0B;IAC1B,4BAA4B;AAChC;;AAEA;IACI,kBAAkB;IAClB,MAAM;IACN,YAAY;IACZ,YAAY;IACZ,YAAY;IACZ,uBAAuB;IACvB,aAAa;IACb,uBAAuB;AAC3B;;AAEA;IACI,aAAa;IACb,sBAAsB;IACtB,mBAAmB;IACnB,gBAAgB;AACpB;;AAEA;IACI,qBAAqB;IACrB,YAAY;IACZ,kBAAkB;IAClB,WAAW;IACX,SAAS;IACT,kBAAkB;IAClB,aAAa;IACb,WAAW;IACX,aAAa;IACb,uBAAuB;IACvB,mBAAmB;IACnB,kBAAkB;AACtB;;AAEA;IACI,qBAAqB;IACrB,YAAY;AAChB\",\"sourcesContent\":[\"html, body {\\r\\n    margin: 0;\\r\\n    height: 100%;\\r\\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\\r\\n    color: white;\\r\\n}\\r\\n\\r\\nbody {\\r\\n    height: 100vh;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    justify-content: center;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n#canvas {\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    /* display: block; */\\r\\n    visibility: hidden;\\r\\n    top: 0;\\r\\n    bottom: 0;\\r\\n    left: 0;\\r\\n    right: 0;\\r\\n    /* width: 1; */\\r\\n    position: absolute;\\r\\n}\\r\\n\\r\\nmain {\\r\\n    /* height: 100%;\\r\\n    display: flex;\\r\\n    justify-content: center;\\r\\n    align-items: center; */\\r\\n}\\r\\n\\r\\n#uiCanvas {\\r\\n    /* width: 100%;\\r\\n    height: 100%; */\\r\\n    display: block;\\r\\n\\r\\n    image-rendering: -moz-crisp-edges;\\r\\n    image-rendering: -webkit-crisp-edges;\\r\\n    image-rendering: pixelated;\\r\\n    image-rendering: crisp-edges;\\r\\n}\\r\\n\\r\\n#ui {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    width: 100vw;\\r\\n    height: 50px;\\r\\n    opacity: 0.9;\\r\\n    background-color: black;\\r\\n    display: flex;\\r\\n    justify-content: center;\\r\\n}\\r\\n\\r\\n#ui > * {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    align-items: center;\\r\\n    min-width: 100px;\\r\\n}\\r\\n\\r\\n#levelEditor {\\r\\n    background-color: red;\\r\\n    opacity: 0.9;\\r\\n    position: absolute;\\r\\n    bottom: 0px;\\r\\n    left: 0px;\\r\\n    border-radius: 5px;\\r\\n    padding: 10px;\\r\\n    margin: 5px;\\r\\n    display: flex;\\r\\n    justify-content: center;\\r\\n    align-items: center;\\r\\n    text-align: center;\\r\\n}\\r\\n\\r\\n#levelEditor > * {\\r\\n    text-decoration: none;\\r\\n    color: white;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n\n      content += cssWithMappingToString(item);\n\n      if (needLayer) {\n        content += \"}\";\n      }\n\n      if (item[2]) {\n        content += \"}\";\n      }\n\n      if (item[4]) {\n        content += \"}\";\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n\n\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var _i = 0; _i < this.length; _i++) {\n        var id = this[_i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i2 = 0; _i2 < modules.length; _i2++) {\n      var item = [].concat(modules[_i2]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","\"use strict\";\n\nvar stylesInDOM = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDOM.length; i++) {\n    if (stylesInDOM[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var indexByIdentifier = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3],\n      supports: item[4],\n      layer: item[5]\n    };\n\n    if (indexByIdentifier !== -1) {\n      stylesInDOM[indexByIdentifier].references++;\n      stylesInDOM[indexByIdentifier].updater(obj);\n    } else {\n      var updater = addElementStyle(obj, options);\n      options.byIndex = i;\n      stylesInDOM.splice(i, 0, {\n        identifier: identifier,\n        updater: updater,\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction addElementStyle(obj, options) {\n  var api = options.domAPI(options);\n  api.update(obj);\n\n  var updater = function updater(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap && newObj.supports === obj.supports && newObj.layer === obj.layer) {\n        return;\n      }\n\n      api.update(obj = newObj);\n    } else {\n      api.remove();\n    }\n  };\n\n  return updater;\n}\n\nmodule.exports = function (list, options) {\n  options = options || {};\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDOM[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDOM[_index].references === 0) {\n        stylesInDOM[_index].updater();\n\n        stylesInDOM.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","\"use strict\";\n\nvar memo = {};\n/* istanbul ignore next  */\n\nfunction getTarget(target) {\n  if (typeof memo[target] === \"undefined\") {\n    var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n    if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n      try {\n        // This will throw an exception if access to iframe is blocked\n        // due to cross-origin restrictions\n        styleTarget = styleTarget.contentDocument.head;\n      } catch (e) {\n        // istanbul ignore next\n        styleTarget = null;\n      }\n    }\n\n    memo[target] = styleTarget;\n  }\n\n  return memo[target];\n}\n/* istanbul ignore next  */\n\n\nfunction insertBySelector(insert, style) {\n  var target = getTarget(insert);\n\n  if (!target) {\n    throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n  }\n\n  target.appendChild(style);\n}\n\nmodule.exports = insertBySelector;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction insertStyleElement(options) {\n  var element = document.createElement(\"style\");\n  options.setAttributes(element, options.attributes);\n  options.insert(element, options.options);\n  return element;\n}\n\nmodule.exports = insertStyleElement;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction setAttributesWithoutAttributes(styleElement) {\n  var nonce = typeof __webpack_nonce__ !== \"undefined\" ? __webpack_nonce__ : null;\n\n  if (nonce) {\n    styleElement.setAttribute(\"nonce\", nonce);\n  }\n}\n\nmodule.exports = setAttributesWithoutAttributes;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction apply(styleElement, options, obj) {\n  var css = \"\";\n\n  if (obj.supports) {\n    css += \"@supports (\".concat(obj.supports, \") {\");\n  }\n\n  if (obj.media) {\n    css += \"@media \".concat(obj.media, \" {\");\n  }\n\n  var needLayer = typeof obj.layer !== \"undefined\";\n\n  if (needLayer) {\n    css += \"@layer\".concat(obj.layer.length > 0 ? \" \".concat(obj.layer) : \"\", \" {\");\n  }\n\n  css += obj.css;\n\n  if (needLayer) {\n    css += \"}\";\n  }\n\n  if (obj.media) {\n    css += \"}\";\n  }\n\n  if (obj.supports) {\n    css += \"}\";\n  }\n\n  var sourceMap = obj.sourceMap;\n\n  if (sourceMap && typeof btoa !== \"undefined\") {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  options.styleTagTransform(css, styleElement, options.options);\n}\n\nfunction removeStyleElement(styleElement) {\n  // istanbul ignore if\n  if (styleElement.parentNode === null) {\n    return false;\n  }\n\n  styleElement.parentNode.removeChild(styleElement);\n}\n/* istanbul ignore next  */\n\n\nfunction domAPI(options) {\n  var styleElement = options.insertStyleElement(options);\n  return {\n    update: function update(obj) {\n      apply(styleElement, options, obj);\n    },\n    remove: function remove() {\n      removeStyleElement(styleElement);\n    }\n  };\n}\n\nmodule.exports = domAPI;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction styleTagTransform(css, styleElement) {\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css;\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild);\n    }\n\n    styleElement.appendChild(document.createTextNode(css));\n  }\n}\n\nmodule.exports = styleTagTransform;","var map = {\n\t\"./1.json\": [\n\t\t9244,\n\t\t244\n\t],\n\t\"./test 1.json\": [\n\t\t7918,\n\t\t918\n\t],\n\t\"./test 2.json\": [\n\t\t345,\n\t\t345\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(() => {\n\t\treturn __webpack_require__.t(id, 3 | 16);\n\t});\n}\nwebpackAsyncContext.keys = () => (Object.keys(map));\nwebpackAsyncContext.id = 442;\nmodule.exports = webpackAsyncContext;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".bundle_\" + {\"244\":\"d7b103709ce9f074d1b5\",\"345\":\"0848b24577dca9d5e4e6\",\"918\":\"bc55be310ccd27075c00\"}[chunkId] + \".js\";\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t757: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkwolfenstein\"] = self[\"webpackChunkwolfenstein\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!./style.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!./style.css\";\n       export default content && content.locals ? content.locals : undefined;\n","export interface ProgramInfo {\r\n    attributes: {\r\n        position: number,\r\n        color?: number,\r\n        texcoord?: number,\r\n    },\r\n    uniforms: {\r\n        matrix: WebGLUniformLocation\r\n    },\r\n}\r\n\r\nexport abstract class Program {\r\n    info: ProgramInfo\r\n    private readonly program: WebGLProgram\r\n    protected readonly gl: WebGLRenderingContext\r\n\r\n    constructor(\r\n        gl: WebGLRenderingContext,\r\n        vertexShaderSource: string,\r\n        fragmentShaderSource: string\r\n    ) {\r\n        this.gl = gl\r\n\r\n        const vertexShader = this.createShader(gl, gl.VERTEX_SHADER, vertexShaderSource);\r\n        const fragmentShader = this.createShader(gl, gl.FRAGMENT_SHADER, fragmentShaderSource);\r\n\r\n        this.program = this.createProgram(gl, vertexShader, fragmentShader);\r\n    }\r\n\r\n    use() {\r\n        this.gl.useProgram(this.program);\r\n    }\r\n\r\n    attribute(name: string) {\r\n        return this.gl.getAttribLocation(this.program, name);\r\n    }\r\n\r\n    uniform(name: string) {\r\n        return this.gl.getUniformLocation(this.program, name);\r\n    }\r\n\r\n    private createShader(gl: WebGLRenderingContext, type: number, source: string) {\r\n        const shader = gl.createShader(type);\r\n        gl.shaderSource(shader, source);\r\n        gl.compileShader(shader);\r\n        const success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\r\n        if (success) {\r\n            return shader;\r\n        }\r\n\r\n        gl.deleteShader(shader);\r\n    }\r\n\r\n    private createProgram(gl: WebGLRenderingContext, vertexShader: WebGLShader, fragmentShader: WebGLShader) {\r\n        const program = gl.createProgram();\r\n        gl.attachShader(program, vertexShader);\r\n        gl.attachShader(program, fragmentShader);\r\n        gl.linkProgram(program);\r\n        const success = gl.getProgramParameter(program, gl.LINK_STATUS);\r\n        if (success) {\r\n            return program;\r\n        }\r\n\r\n        gl.deleteProgram(program);\r\n    }\r\n}","import { Program, ProgramInfo } from \"./Program\";\r\nimport vertexShaderSource from '../../shaders/color.vs';\r\nimport fragmentShaderSource from '../../shaders/color.fs';\r\n\r\nexport interface ColorProgramInfo extends ProgramInfo {\r\n    attributes: {\r\n        position: number,\r\n        color: number,\r\n    },\r\n    uniforms: {\r\n        matrix: WebGLUniformLocation\r\n    },\r\n}\r\n\r\nexport class ColorProgram extends Program {\r\n    info: ColorProgramInfo = {\r\n        attributes: {\r\n            position: this.attribute(\"a_position\"),\r\n            color: this.attribute(\"a_color\"),\r\n        },\r\n        uniforms: {\r\n            matrix: this.uniform(\"u_matrix\")\r\n        },\r\n    }\r\n\r\n    constructor(gl: WebGLRenderingContext) {\r\n        super(gl, vertexShaderSource, fragmentShaderSource,)\r\n    }\r\n}","export default \"attribute vec4 a_position;\\r\\nattribute vec4 a_color;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\nvarying vec4 v_color;\\r\\n\\r\\nvoid main() {\\r\\n  gl_Position = u_matrix * a_position;    \\r\\n  // Pass the color to the fragment shader.\\r\\n  v_color = a_color;\\r\\n}\"","export default \"precision mediump float;\\r\\n\\r\\n// Passed in from the vertex shader.\\r\\nvarying vec4 v_color;\\r\\n\\r\\nvoid main() {\\r\\n   gl_FragColor = v_color;\\r\\n}\"","import { Program, ProgramInfo } from \"./Program\";\r\nimport vertexShaderSource from '../../shaders/texture.vs';\r\nimport fragmentShaderSource from '../../shaders/texture.fs';\r\n\r\nexport interface TextureProgramInfo extends ProgramInfo {\r\n    attributes: {\r\n        position: number,\r\n        texcoord: number,\r\n    },\r\n    uniforms: {\r\n        matrix: WebGLUniformLocation\r\n    },\r\n}\r\n\r\nexport class TextureProgram extends Program {\r\n    info: TextureProgramInfo = {\r\n        attributes: {\r\n            position: this.attribute(\"a_position\"),\r\n            texcoord: this.attribute(\"a_texcoord\"),\r\n        },\r\n        uniforms: {\r\n            matrix: this.uniform(\"u_matrix\")\r\n        },\r\n    }\r\n\r\n    constructor(gl: WebGLRenderingContext) {\r\n        super(gl, vertexShaderSource, fragmentShaderSource,)\r\n    }\r\n\r\n    loadTexture(src: string, callback: () => void) {\r\n        // Create a texture.\r\n        const texture = this.gl.createTexture();\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n\r\n        // Fill the texture with a 1x1 blue pixel.\r\n        this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, 1, 1, 0, this.gl.RGBA, this.gl.UNSIGNED_BYTE,\r\n            new Uint8Array([0, 0, 255, 255]));\r\n\r\n        // Asynchronously load an image\r\n        var image = new Image();\r\n        image.src = src\r\n        image.addEventListener('load', () => {\r\n            // Now that the image has loaded make copy it to the texture.\r\n            // this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n            // this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, this.gl.RGBA, this.gl.UNSIGNED_BYTE, image);\r\n            // this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.LINEAR_MIPMAP_LINEAR);\r\n            // this.gl.generateMipmap(this.gl.TEXTURE_2D);\r\n\r\n            callback()\r\n        });\r\n    }\r\n}","export default \"attribute vec4 a_position;\\r\\nattribute vec2 a_texcoord;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\nvarying vec2 v_texcoord;\\r\\n\\r\\nvoid main() {\\r\\n  gl_Position = u_matrix * a_position;    \\r\\n  \\r\\n  // Pass the texcoord to the fragment shader.\\r\\n  v_texcoord = a_texcoord;\\r\\n}\"","export default \"precision mediump float;\\r\\n\\r\\n// Passed in from the vertex shader.\\r\\nvarying vec2 v_texcoord;\\r\\n\\r\\n// The texture.\\r\\nuniform sampler2D u_texture;\\r\\n\\r\\nvoid main() {\\r\\n    vec4 texColor = texture2D(u_texture, v_texcoord);\\r\\n    if(texColor.a < 0.1)\\r\\n        discard;\\r\\n    gl_FragColor = texColor;\\r\\n    // gl_FragColor = texture2D(u_texture, v_texcoord);\\r\\n}\"","import { Vec3 } from \".\";\r\n\r\nexport function radToDeg(r: number) {\r\n    return r * 180 / Math.PI;\r\n}\r\n\r\nexport function degToRad(d: number) {\r\n    return d * Math.PI / 180;\r\n}\r\n\r\nexport function hexToRgb(hex: string) {\r\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n    return result ? new Vec3(\r\n        parseInt(result[1], 16),\r\n        parseInt(result[2], 16),\r\n        parseInt(result[3], 16)\r\n    ) : null;\r\n}","import { Vec3 } from '.'\r\n\r\nconst m4 = {\r\n    translation: (v: Vec3) => {\r\n        return [\r\n            1, 0, 0, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 1, 0,\r\n            v.x, v.y, v.z, 1,\r\n        ]\r\n    },\r\n\r\n    get identity() {\r\n        return [\r\n            1, 0, 0, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 1, 0,\r\n            0, 0, 0, 1,\r\n        ]\r\n    },\r\n\r\n    rotate: (mTarget: number[], v: Vec3) => {\r\n        let m = m4.multiply(mTarget, m4.xRotation(v.x))\r\n        m = m4.multiply(m, m4.yRotation(v.y))\r\n        m = m4.multiply(m, m4.zRotation(v.z))\r\n        return m\r\n    },\r\n\r\n    xRotation: (angleInRadians: number) => {\r\n        const c = Math.cos(angleInRadians)\r\n        const s = Math.sin(angleInRadians)\r\n\r\n        return [\r\n            1, 0, 0, 0,\r\n            0, c, s, 0,\r\n            0, -s, c, 0,\r\n            0, 0, 0, 1,\r\n        ]\r\n    },\r\n\r\n    yRotation: (angleInRadians: number) => {\r\n        const c = Math.cos(angleInRadians)\r\n        const s = Math.sin(angleInRadians)\r\n\r\n        return [\r\n            c, 0, -s, 0,\r\n            0, 1, 0, 0,\r\n            s, 0, c, 0,\r\n            0, 0, 0, 1,\r\n        ]\r\n    },\r\n\r\n    zRotation: (angleInRadians: number) => {\r\n        const c = Math.cos(angleInRadians)\r\n        const s = Math.sin(angleInRadians)\r\n\r\n        return [\r\n            c, s, 0, 0,\r\n            -s, c, 0, 0,\r\n            0, 0, 1, 0,\r\n            0, 0, 0, 1,\r\n        ]\r\n    },\r\n\r\n    scaling: (v: Vec3) => {\r\n        return [\r\n            v.x, 0, 0, 0,\r\n            0, v.y, 0, 0,\r\n            0, 0, v.z, 0,\r\n            0, 0, 0, 1,\r\n        ]\r\n    },\r\n\r\n    translate: (m: number[], v: Vec3) => {\r\n        return m4.multiply(m, m4.translation(v))\r\n    },\r\n\r\n    xRotate: (m: number[], angleInRadians: number) => {\r\n        return m4.multiply(m, m4.xRotation(angleInRadians))\r\n    },\r\n\r\n    yRotate: (m: number[], angleInRadians: number) => {\r\n        return m4.multiply(m, m4.yRotation(angleInRadians))\r\n    },\r\n\r\n    zRotate: (m: number[], angleInRadians: number) => {\r\n        return m4.multiply(m, m4.zRotation(angleInRadians))\r\n    },\r\n\r\n    scale: (m: number[], v: Vec3) => {\r\n        return m4.multiply(m, m4.scaling(v))\r\n    },\r\n\r\n    perspective: (fieldOfViewInRadians: number, aspect: number, near: number, far: number) => {\r\n        var f = Math.tan(Math.PI * 0.5 - 0.5 * fieldOfViewInRadians);\r\n        var rangeInv = 1.0 / (near - far);\r\n\r\n        return [\r\n            f / aspect, 0, 0, 0,\r\n            0, f, 0, 0,\r\n            0, 0, (near + far) * rangeInv, -1,\r\n            0, 0, near * far * rangeInv * 2, 0\r\n        ];\r\n    },\r\n\r\n    makeZToWMatrix(fudgeFactor: number) {\r\n        return [\r\n            1, 0, 0, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 1, fudgeFactor,\r\n            0, 0, 0, 1,\r\n        ];\r\n    },\r\n\r\n    multiply: (a: number[], b: number[]) => {\r\n        const a11 = a[0 * 4 + 0]\r\n        const a12 = a[0 * 4 + 1]\r\n        const a13 = a[0 * 4 + 2]\r\n        const a14 = a[0 * 4 + 3]\r\n        const a21 = a[1 * 4 + 0]\r\n        const a22 = a[1 * 4 + 1]\r\n        const a23 = a[1 * 4 + 2]\r\n        const a24 = a[1 * 4 + 3]\r\n        const a31 = a[2 * 4 + 0]\r\n        const a32 = a[2 * 4 + 1]\r\n        const a33 = a[2 * 4 + 2]\r\n        const a34 = a[2 * 4 + 3]\r\n        const a41 = a[3 * 4 + 0]\r\n        const a42 = a[3 * 4 + 1]\r\n        const a43 = a[3 * 4 + 2]\r\n        const a44 = a[3 * 4 + 3]\r\n        const b11 = b[0 * 4 + 0]\r\n        const b12 = b[0 * 4 + 1]\r\n        const b13 = b[0 * 4 + 2]\r\n        const b14 = b[0 * 4 + 3]\r\n        const b21 = b[1 * 4 + 0]\r\n        const b22 = b[1 * 4 + 1]\r\n        const b23 = b[1 * 4 + 2]\r\n        const b24 = b[1 * 4 + 3]\r\n        const b31 = b[2 * 4 + 0]\r\n        const b32 = b[2 * 4 + 1]\r\n        const b33 = b[2 * 4 + 2]\r\n        const b34 = b[2 * 4 + 3]\r\n        const b41 = b[3 * 4 + 0]\r\n        const b42 = b[3 * 4 + 1]\r\n        const b43 = b[3 * 4 + 2]\r\n        const b44 = b[3 * 4 + 3]\r\n\r\n        return [\r\n            a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41,\r\n            a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42,\r\n            a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43,\r\n            a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44,\r\n            a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41,\r\n            a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42,\r\n            a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43,\r\n            a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44,\r\n            a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41,\r\n            a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42,\r\n            a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43,\r\n            a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44,\r\n            a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41,\r\n            a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42,\r\n            a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43,\r\n            a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44,\r\n        ]\r\n    },\r\n\r\n    multiplyScalar(m: number[], scalar: number) {\r\n        return m.map(el => el * scalar)\r\n    },\r\n\r\n    det: (m: number[]) => {\r\n        const m11 = m[0 * 4 + 0]\r\n        const m12 = m[0 * 4 + 1]\r\n        const m13 = m[0 * 4 + 2]\r\n        const m14 = m[0 * 4 + 3]\r\n        const m21 = m[1 * 4 + 0]\r\n        const m22 = m[1 * 4 + 1]\r\n        const m23 = m[1 * 4 + 2]\r\n        const m24 = m[1 * 4 + 3]\r\n        const m31 = m[2 * 4 + 0]\r\n        const m32 = m[2 * 4 + 1]\r\n        const m33 = m[2 * 4 + 2]\r\n        const m34 = m[2 * 4 + 3]\r\n        const m41 = m[3 * 4 + 0]\r\n        const m42 = m[3 * 4 + 1]\r\n        const m43 = m[3 * 4 + 2]\r\n        const m44 = m[3 * 4 + 3]\r\n\r\n        return (\r\n            m11 * m22 * m33 * m44 + m11 * m23 * m34 * m42 + m11 * m24 * m32 * m43 +\r\n            +m12 * m21 * m34 * m43 + m12 * m23 * m31 * m44 + m12 * m24 * m33 * m41 +\r\n            +m13 * m21 * m32 * m44 + m13 * m22 * m34 * m41 + m13 * m24 * m31 * m42 +\r\n            +m14 * m21 * m33 * m42 + m14 * m22 * m31 * m43 + m14 * m23 * m32 * m41 +\r\n            -m11 * m22 * m34 * m43 - m11 * m23 * m32 * m44 - m11 * m24 * m33 * m42 +\r\n            -m12 * m21 * m33 * m44 - m12 * m23 * m34 * m41 - m12 * m24 * m31 * m43 +\r\n            -m13 * m21 * m34 * m42 - m13 * m22 * m31 * m44 - m13 * m24 * m32 * m41 +\r\n            -m14 * m21 * m32 * m43 - m14 * m22 * m33 * m41 - m14 * m23 * m31 * m42\r\n        )\r\n    },\r\n\r\n    inverse(m: number[]) {\r\n        let dst = new Array(16);\r\n        var m00 = m[0 * 4 + 0];\r\n        var m01 = m[0 * 4 + 1];\r\n        var m02 = m[0 * 4 + 2];\r\n        var m03 = m[0 * 4 + 3];\r\n        var m10 = m[1 * 4 + 0];\r\n        var m11 = m[1 * 4 + 1];\r\n        var m12 = m[1 * 4 + 2];\r\n        var m13 = m[1 * 4 + 3];\r\n        var m20 = m[2 * 4 + 0];\r\n        var m21 = m[2 * 4 + 1];\r\n        var m22 = m[2 * 4 + 2];\r\n        var m23 = m[2 * 4 + 3];\r\n        var m30 = m[3 * 4 + 0];\r\n        var m31 = m[3 * 4 + 1];\r\n        var m32 = m[3 * 4 + 2];\r\n        var m33 = m[3 * 4 + 3];\r\n\r\n        var tmp_0 = m22 * m33;\r\n        var tmp_1 = m32 * m23;\r\n        var tmp_2 = m12 * m33;\r\n        var tmp_3 = m32 * m13;\r\n        var tmp_4 = m12 * m23;\r\n        var tmp_5 = m22 * m13;\r\n        var tmp_6 = m02 * m33;\r\n        var tmp_7 = m32 * m03;\r\n        var tmp_8 = m02 * m23;\r\n        var tmp_9 = m22 * m03;\r\n        var tmp_10 = m02 * m13;\r\n        var tmp_11 = m12 * m03;\r\n        var tmp_12 = m20 * m31;\r\n        var tmp_13 = m30 * m21;\r\n        var tmp_14 = m10 * m31;\r\n        var tmp_15 = m30 * m11;\r\n        var tmp_16 = m10 * m21;\r\n        var tmp_17 = m20 * m11;\r\n        var tmp_18 = m00 * m31;\r\n        var tmp_19 = m30 * m01;\r\n        var tmp_20 = m00 * m21;\r\n        var tmp_21 = m20 * m01;\r\n        var tmp_22 = m00 * m11;\r\n        var tmp_23 = m10 * m01;\r\n\r\n        var t0 = (tmp_0 * m11 + tmp_3 * m21 + tmp_4 * m31) - (tmp_1 * m11 + tmp_2 * m21 + tmp_5 * m31);\r\n        var t1 = (tmp_1 * m01 + tmp_6 * m21 + tmp_9 * m31) - (tmp_0 * m01 + tmp_7 * m21 + tmp_8 * m31);\r\n        var t2 = (tmp_2 * m01 + tmp_7 * m11 + tmp_10 * m31) - (tmp_3 * m01 + tmp_6 * m11 + tmp_11 * m31);\r\n        var t3 = (tmp_5 * m01 + tmp_8 * m11 + tmp_11 * m21) - (tmp_4 * m01 + tmp_9 * m11 + tmp_10 * m21);\r\n\r\n        var d = 1.0 / (m00 * t0 + m10 * t1 + m20 * t2 + m30 * t3);\r\n\r\n        dst[0] = d * t0;\r\n        dst[1] = d * t1;\r\n        dst[2] = d * t2;\r\n        dst[3] = d * t3;\r\n        dst[4] = d * ((tmp_1 * m10 + tmp_2 * m20 + tmp_5 * m30) - (tmp_0 * m10 + tmp_3 * m20 + tmp_4 * m30));\r\n        dst[5] = d * ((tmp_0 * m00 + tmp_7 * m20 + tmp_8 * m30) - (tmp_1 * m00 + tmp_6 * m20 + tmp_9 * m30));\r\n        dst[6] = d * ((tmp_3 * m00 + tmp_6 * m10 + tmp_11 * m30) - (tmp_2 * m00 + tmp_7 * m10 + tmp_10 * m30));\r\n        dst[7] = d * ((tmp_4 * m00 + tmp_9 * m10 + tmp_10 * m20) - (tmp_5 * m00 + tmp_8 * m10 + tmp_11 * m20));\r\n        dst[8] = d * ((tmp_12 * m13 + tmp_15 * m23 + tmp_16 * m33) - (tmp_13 * m13 + tmp_14 * m23 + tmp_17 * m33));\r\n        dst[9] = d * ((tmp_13 * m03 + tmp_18 * m23 + tmp_21 * m33) - (tmp_12 * m03 + tmp_19 * m23 + tmp_20 * m33));\r\n        dst[10] = d * ((tmp_14 * m03 + tmp_19 * m13 + tmp_22 * m33) - (tmp_15 * m03 + tmp_18 * m13 + tmp_23 * m33));\r\n        dst[11] = d * ((tmp_17 * m03 + tmp_20 * m13 + tmp_23 * m23) - (tmp_16 * m03 + tmp_21 * m13 + tmp_22 * m23));\r\n        dst[12] = d * ((tmp_14 * m22 + tmp_17 * m32 + tmp_13 * m12) - (tmp_16 * m32 + tmp_12 * m12 + tmp_15 * m22));\r\n        dst[13] = d * ((tmp_20 * m32 + tmp_12 * m02 + tmp_19 * m22) - (tmp_18 * m22 + tmp_21 * m32 + tmp_13 * m02));\r\n        dst[14] = d * ((tmp_18 * m12 + tmp_23 * m32 + tmp_15 * m02) - (tmp_22 * m32 + tmp_14 * m02 + tmp_19 * m12));\r\n        dst[15] = d * ((tmp_22 * m22 + tmp_16 * m02 + tmp_21 * m12) - (tmp_20 * m12 + tmp_23 * m22 + tmp_17 * m02));\r\n\r\n        return dst;\r\n    },\r\n\r\n    lookAt: function (source: Vec3, target: Vec3) {\r\n        var zAxis = source.substract(target).normalize;\r\n        var xAxis = Vec3.up.cross(zAxis).normalize;\r\n        var yAxis = zAxis.cross(xAxis).normalize;\r\n\r\n        return [\r\n            xAxis.x, xAxis.y, xAxis.z, 0,\r\n            yAxis.x, yAxis.y, yAxis.z, 0,\r\n            zAxis.x, zAxis.y, zAxis.z, 0,\r\n            source.x, source.y, source.z, 1,\r\n        ];\r\n    },\r\n\r\n    getPositionVector: function (m: number[]) {\r\n        return new Vec3(m[12], m[13], m[14]).map(v => v < 0.0000001 ? 0 : v)\r\n    },\r\n\r\n    getScaleVector: function (m: number[]) {\r\n        return new Vec3(\r\n            new Vec3(m[0], m[4], m[8]).magnitude,\r\n            new Vec3(m[1], m[5], m[9]).magnitude,\r\n            new Vec3(m[2], m[6], m[10]).magnitude,\r\n        )\r\n    },\r\n\r\n    getRotationMatrix: function (m: number[]) {\r\n        const s = m4.getScaleVector(m)\r\n        return [\r\n            m[0] / s.x, m[1] / s.y, m[2] / s.z, 0,\r\n            m[4] / s.x, m[5] / s.y, m[6] / s.z, 0,\r\n            m[8] / s.x, m[9] / s.y, m[10] / s.z, 0,\r\n            0, 0, 0, 1\r\n        ]\r\n    },\r\n\r\n}\r\n\r\n// export default m4\r\nexport { m4 }","import { Vec3 } from \".\"\r\n\r\nexport class Vec2 {\r\n    x: number\r\n    y: number\r\n\r\n    static arrayToVec2Array(a: number[] | Float32Array) {\r\n        let array: Vec2[] = []\r\n        for (let i = 0; i < a.length; i += 2) {\r\n            array.push(new Vec2(\r\n                a[i],\r\n                a[i + 1],\r\n            ))\r\n        }\r\n        return array\r\n    }\r\n\r\n    static vec2ArrayToArray(a: Vec2[]) {\r\n        let array: number[] = []\r\n        for (let vec of a) {\r\n            array.push(vec.x, vec.y)\r\n        }\r\n        return array\r\n    }\r\n\r\n    constructor(x: number, y: number) {\r\n        this.set(x, y)\r\n    }\r\n\r\n    set(x: number, y: number) {\r\n        this.x = x\r\n        this.y = y\r\n    }\r\n\r\n    multiply(scalar: number) {\r\n        return new Vec2(this.x * scalar, this.y * scalar)\r\n    }\r\n\r\n    add(v: Vec2) {\r\n        return new Vec2(\r\n            this.x + v.x,\r\n            this.y + v.y\r\n        )\r\n    }\r\n\r\n    map(f: (value: number) => number) {\r\n        return new Vec2(\r\n            f(this.x),\r\n            f(this.y),\r\n        )\r\n    }\r\n\r\n    multiplyByVector(v: Vec2) {\r\n        return new Vec2(this.x * v.x, this.y * v.y)\r\n    }\r\n\r\n    substract(v: Vec2) {\r\n        return new Vec2(\r\n            this.x - v.x,\r\n            this.y - v.y,\r\n        )\r\n    }\r\n\r\n    get abs() {\r\n        return this.map(v => Math.abs(v))\r\n    }\r\n\r\n    equals(v: Vec2) {\r\n        return this.x == v.x && this.y == v.y\r\n    }\r\n\r\n    toVec3() {\r\n        return new Vec3(this.x, 0, this.y)\r\n    }\r\n}","import { Vec2 } from \".\"\r\n\r\nexport class Vec3 {\r\n    x: number\r\n    y: number\r\n    z: number\r\n\r\n    static get one() {\r\n        return new Vec3(1, 1, 1)\r\n    }\r\n\r\n    static get zero() {\r\n        return new Vec3(0, 0, 0)\r\n    }\r\n\r\n    static get forward() {\r\n        return new Vec3(0, 0, 1)\r\n    }\r\n\r\n    static get backward() {\r\n        return new Vec3(0, 0, -1)\r\n    }\r\n\r\n    static get right() {\r\n        return new Vec3(1, 0, 0)\r\n    }\r\n\r\n    static get left() {\r\n        return new Vec3(-1, 0, 0)\r\n    }\r\n\r\n    static get up() {\r\n        return new Vec3(0, 1, 0)\r\n    }\r\n\r\n    static get down() {\r\n        return new Vec3(0, -1, 0)\r\n    }\r\n\r\n    static arrayToVec3Array(a: number[] | Float32Array | Uint8Array) {\r\n        let array: Vec3[] = []\r\n        for (let i = 0; i < a.length; i += 3) {\r\n            array.push(new Vec3(\r\n                a[i],\r\n                a[i + 1],\r\n                a[i + 2]\r\n            ))\r\n        }\r\n        return array\r\n    }\r\n\r\n    static vec3ArrayToArray(a: Vec3[]) {\r\n        let array: number[] = []\r\n        for (let vec of a) {\r\n            array.push(vec.x, vec.y, vec.z)\r\n        }\r\n        return array\r\n    }\r\n\r\n    constructor(x: number, y: number, z: number) {\r\n        this.set(x, y, z)\r\n    }\r\n\r\n    set(x: number, y: number, z: number) {\r\n        this.x = x\r\n        this.y = y\r\n        this.z = z\r\n    }\r\n\r\n    get copy() {\r\n        return new Vec3(this.x, this.y, this.z)\r\n    }\r\n\r\n    get xInverted() {\r\n        return new Vec3(-this.x, this.y, this.z)\r\n    }\r\n\r\n    get yInverted() {\r\n        return new Vec3(this.x, -this.y, this.z)\r\n    }\r\n\r\n    get zInverted() {\r\n        return new Vec3(this.x, this.y, -this.z)\r\n    }\r\n\r\n    multiply(scalar: number) {\r\n        return new Vec3(this.x * scalar, this.y * scalar, this.z * scalar)\r\n    }\r\n\r\n    multiplyByVector(v: Vec3) {\r\n        return new Vec3(this.x * v.x, this.y * v.y, this.z * v.z)\r\n    }\r\n\r\n    equals(v: Vec3) {\r\n        return this.x == v.x && this.y == v.y && this.z == v.z\r\n    }\r\n\r\n    isGreater(v: Vec3) {\r\n        return this.x >= v.x && this.y >= v.y && this.z >= v.z && (this.x > v.x || this.y > v.y || this.z > v.z)\r\n    }\r\n\r\n    isLess(v: Vec3) {\r\n        return this.x <= v.x && this.y <= v.y && this.z <= v.z && (this.x < v.x || this.y < v.y || this.z < v.z)\r\n    }\r\n\r\n    cross(v: Vec3) {\r\n        return new Vec3(\r\n            this.y * v.z - this.z * v.y,\r\n            this.z * v.x - this.x * v.z,\r\n            this.x * v.y - this.y * v.x,\r\n        )\r\n    }\r\n\r\n    dot(v: Vec3) {\r\n        return this.x * v.x + this.y * v.y + this.z * v.z\r\n    }\r\n\r\n    add(v: Vec3) {\r\n        return new Vec3(\r\n            this.x + v.x,\r\n            this.y + v.y,\r\n            this.z + v.z\r\n        )\r\n    }\r\n\r\n    substract(v: Vec3) {\r\n        return new Vec3(\r\n            this.x - v.x,\r\n            this.y - v.y,\r\n            this.z - v.z\r\n        )\r\n    }\r\n\r\n    distanceTo(v: Vec3) {\r\n        return Math.sqrt(\r\n            (v.x - this.x) ** 2 +\r\n            (v.y - this.y) ** 2 +\r\n            (v.z - this.z) ** 2\r\n        )\r\n    }\r\n\r\n    horizontalDistanceTo(v: Vec3) {\r\n        return this.yZeroed.distanceTo(v.yZeroed)\r\n    }\r\n\r\n    to(v: Vec3) {\r\n        return new Vec3(\r\n            v.x - this.x,\r\n            v.y - this.y,\r\n            v.z - this.z,\r\n        )\r\n    }\r\n\r\n    get inverted() {\r\n        return this.multiply(-1)\r\n    }\r\n\r\n    get normalize() {\r\n        if (this.magnitude != 0) {\r\n            const scale = 1 / this.magnitude\r\n            return this.multiply(scale)\r\n        } else {\r\n            return Vec3.zero\r\n        }\r\n    }\r\n\r\n    get magnitude() {\r\n        return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z)\r\n    }\r\n\r\n    transformMat4(m: number[]) {\r\n        var w = m[3] * this.x + m[7] * this.y + m[11] * this.z + m[15]\r\n        w = w || 1.0\r\n        let out = Vec3.zero\r\n        out.x = (m[0] * this.x + m[4] * this.y + m[8] * this.z + m[12]) / w\r\n        out.y = (m[1] * this.x + m[5] * this.y + m[9] * this.z + m[13]) / w\r\n        out.z = (m[2] * this.x + m[6] * this.y + m[10] * this.z + m[14]) / w\r\n        return out\r\n    }\r\n\r\n    clone() {\r\n        return new Vec3(this.x, this.y, this.z)\r\n    }\r\n\r\n    static fromAngle(angle: number) {\r\n        angle = angle + 3 * Math.PI / 2\r\n        return new Vec3(Math.cos(angle), 0, Math.sin(angle))\r\n    }\r\n\r\n    map(f: (value: number) => number) {\r\n        return new Vec3(\r\n            f(this.x),\r\n            f(this.y),\r\n            f(this.z),\r\n        )\r\n    }\r\n\r\n    get yZeroed() {\r\n        return new Vec3(\r\n            this.x,\r\n            0,\r\n            this.z,\r\n        )\r\n    }\r\n\r\n    get abs() {\r\n        return this.map(v => Math.abs(v))\r\n    }\r\n\r\n    get minusOneOrZeroOrOne() {\r\n        return this.map(v => {\r\n            if (v > 0) return 1\r\n            if (v < 0) return -1\r\n            return 0\r\n        })\r\n    }\r\n\r\n    toVec2() {\r\n        return new Vec2(this.x, this.z)\r\n    }\r\n}","import { Vec3 } from '.'\r\nimport { m4 } from '.'\r\n\r\nexport class Transform {\r\n    position = Vec3.zero\r\n    rotation = Vec3.zero\r\n    scale = Vec3.one\r\n    originTranslation = Vec3.zero\r\n\r\n    reset() {\r\n        this.position = Vec3.zero\r\n        this.rotation = Vec3.zero\r\n        this.scale = Vec3.one\r\n    }\r\n\r\n    get matrix() {\r\n        let matrix = m4.identity\r\n\r\n        matrix = m4.scale(matrix, this.scale);\r\n\r\n        matrix = m4.xRotate(matrix, this.rotation.x);\r\n        matrix = m4.yRotate(matrix, this.rotation.y);\r\n        matrix = m4.zRotate(matrix, this.rotation.z);\r\n\r\n        const position = this.position.add(this.originTranslation)\r\n        matrix = m4.translate(matrix, position);\r\n\r\n        return matrix\r\n    }\r\n\r\n    clone() {\r\n        const transform = new Transform()\r\n        transform.position = this.position.clone()\r\n        transform.rotation = this.rotation.clone()\r\n        transform.scale = this.scale.clone()\r\n        return transform\r\n    }\r\n}","import { m4, Vec3, Transform } from '../../utils'\r\nimport { Program, ProgramInfo } from '../../programs/Program'\r\nimport { GridBoundingBox } from './GridBoundingBox'\r\nimport { CuboidBoundingBox } from './CuboidBoundingBox'\r\n\r\nexport default abstract class Shape {\r\n    importedTexture: string\r\n    webglTexture: WebGLTexture\r\n    protected readonly gl: WebGLRenderingContext\r\n    protected positionBuffer: WebGLBuffer\r\n    protected colorBuffer: WebGLBuffer\r\n    protected texcoordsBuffer: WebGLBuffer\r\n    protected VERTICES: Float32Array\r\n    protected COLORS: Uint8Array\r\n    protected TEXCOORDS: Float32Array\r\n    protected initialTexcoords: Float32Array\r\n    private firstBufferReady = false\r\n    transform = new Transform()\r\n    initialTransform: Transform\r\n    program: Program\r\n    bb: GridBoundingBox | CuboidBoundingBox = null\r\n\r\n    constructor(gl: WebGLRenderingContext, program: Program) {\r\n        this.gl = gl\r\n        this.program = program\r\n        setTimeout(() => {\r\n            this.updateBuffers()\r\n        })\r\n    }\r\n\r\n    get verticesTransformed() {\r\n        return this.verticesVec3Array.map(vec => {\r\n            let a = m4.identity\r\n            a = m4.translate(a, vec.multiplyByVector(this.transform.scale))\r\n            a = m4.rotate(a, this.transform.rotation)\r\n            a = m4.translate(this.transform.matrix, m4.getPositionVector(a))\r\n            return m4.getPositionVector(a)\r\n        })\r\n    }\r\n\r\n    get verticesCount() {\r\n        return this.VERTICES.length / 3\r\n    }\r\n\r\n    get verticesVec3Array() {\r\n        return Vec3.arrayToVec3Array(this.VERTICES)\r\n    }\r\n\r\n    get xVertices() {\r\n        return this.VERTICES.filter((_, index) => index % 3 == 0)\r\n    }\r\n\r\n    get yVertices() {\r\n        return this.VERTICES.filter((_, index) => index % 3 == 1)\r\n    }\r\n\r\n    get zVertices() {\r\n        return this.VERTICES.filter((_, index) => index % 3 == 2)\r\n    }\r\n\r\n    get size() {\r\n        return new Vec3(\r\n            (Math.max(...this.xVertices) - Math.min(...this.xVertices)) * this.transform.scale.x,\r\n            (Math.max(...this.yVertices) - Math.min(...this.yVertices)) * this.transform.scale.y,\r\n            (Math.max(...this.zVertices) - Math.min(...this.zVertices)) * this.transform.scale.z,\r\n        )\r\n    }\r\n\r\n    get sizeRotated() {\r\n        if (!this.transform.rotation.y) return this.size\r\n        const rotationMatrix = m4.yRotation(this.transform.rotation.y)\r\n        return this.size.transformMat4(rotationMatrix).abs\r\n    }\r\n\r\n    get halfSize() {\r\n        return this.size.multiply(0.5)\r\n    }\r\n\r\n    get halfSizeRotated() {\r\n        return this.sizeRotated.multiply(0.5)\r\n    }\r\n\r\n    texturedWidth = 1\r\n    get texturedSize() {\r\n        return this.size.multiplyByVector(Vec3.right.multiply(this.texturedWidth))\r\n    }\r\n\r\n    setInitialState() {\r\n        this.initialTransform = this.transform.clone()\r\n        this.initialTexcoords = this.TEXCOORDS.slice(0)\r\n        this.onCreation()\r\n        this.updateBuffers()\r\n    }\r\n\r\n    onCreation() { }\r\n\r\n    updateBuffers() {\r\n        if (!this.firstBufferReady) {\r\n            this.setPositionBuffer()\r\n            this.setColorBuffer()\r\n        }\r\n        if (this.TEXCOORDS) {\r\n            this.setTexcoordsBuffer()\r\n        }\r\n        this.firstBufferReady = true\r\n    }\r\n\r\n    bindGeometry(positionLocation: number) {\r\n        this.gl.enableVertexAttribArray(positionLocation);\r\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.positionBuffer);\r\n        const size = 3;\r\n        const type = this.gl.FLOAT;\r\n        const normalize = false;\r\n        const stride = 0;\r\n        const offset = 0;\r\n        this.gl.vertexAttribPointer(positionLocation, size, type, normalize, stride, offset);\r\n    }\r\n\r\n    bindColors(colorLocation: number) {\r\n        // Turn on the color attribute\r\n        this.gl.enableVertexAttribArray(colorLocation);\r\n\r\n        // Bind the color buffer.\r\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.colorBuffer);\r\n\r\n        // Tell the attribute how to get data out of colorBuffer (ARRAY_BUFFER)\r\n        const size = 3;                 // 3 components per iteration\r\n        const type = this.gl.UNSIGNED_BYTE;  // the data is 8bit unsigned values\r\n        const normalize = true;         // normalize the data (convert from 0-255 to 0-1)\r\n        const stride = 0;               // 0 = move forward size * sizeof(type) each iteration to get the next position\r\n        const offset = 0;               // start at the beginning of the buffer\r\n        this.gl.vertexAttribPointer(colorLocation, size, type, normalize, stride, offset);\r\n    }\r\n\r\n    bindTexture(texcoordsLocation: number) {\r\n        // Turn on the color attribute\r\n        this.gl.enableVertexAttribArray(texcoordsLocation);\r\n\r\n        // Bind the color buffer.\r\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.texcoordsBuffer);\r\n\r\n        // Tell the attribute how to get data out of colorBuffer (ARRAY_BUFFER)\r\n        const size = 2;                 // 2 components per iteration\r\n        const type = this.gl.FLOAT;  // the data is 8bit unsigned values\r\n        const normalize = false;         // normalize the data (convert from 0-255 to 0-1)\r\n        const stride = 0;               // 0 = move forward size * sizeof(type) each iteration to get the next position\r\n        const offset = 0;               // start at the beginning of the buffer\r\n        this.gl.vertexAttribPointer(texcoordsLocation, size, type, normalize, stride, offset);\r\n    }\r\n\r\n    bindTransform(matrixLocation: WebGLUniformLocation, viewProjectionMatrix: number[]) {\r\n        let matrix = this.transform.matrix\r\n        matrix = m4.multiply(matrix, viewProjectionMatrix);\r\n\r\n        // Set the matrix.\r\n        this.gl.uniformMatrix4fv(matrixLocation, false, matrix);\r\n    }\r\n\r\n    draw(viewProjectionMatrix: number[]) {\r\n        if (!this.firstBufferReady) return\r\n        this.program.use()\r\n        this.bindGeometry(this.program.info.attributes.position)\r\n        if (this.program.info.attributes.color) {\r\n            this.bindColors(this.program.info.attributes.color)\r\n        }\r\n        if (this.program.info.attributes.texcoord) {\r\n            this.bindTexture(this.program.info.attributes.texcoord)\r\n        }\r\n        this.bindTransform(this.program.info.uniforms.matrix, viewProjectionMatrix)\r\n\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this.webglTexture);\r\n\r\n        this._draw()\r\n    }\r\n\r\n    private _draw() {\r\n        const primitiveType = this.gl.TRIANGLES;\r\n        const offset = 0;\r\n        const count = this.verticesCount;\r\n        this.gl.drawArrays(primitiveType, offset, count);\r\n    }\r\n\r\n    private setPositionBuffer() {\r\n        this.positionBuffer = this.gl.createBuffer();\r\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.positionBuffer);\r\n        this.gl.bufferData(\r\n            this.gl.ARRAY_BUFFER,\r\n            this.VERTICES,\r\n            this.gl.STATIC_DRAW\r\n        );\r\n    }\r\n\r\n    private setColorBuffer() {\r\n        this.colorBuffer = this.gl.createBuffer();\r\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.colorBuffer);\r\n        this.gl.bufferData(\r\n            this.gl.ARRAY_BUFFER,\r\n            this.COLORS,\r\n            this.gl.STATIC_DRAW\r\n        );\r\n    }\r\n\r\n    private setTexcoordsBuffer() {\r\n        this.texcoordsBuffer = this.gl.createBuffer();\r\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.texcoordsBuffer);\r\n        this.gl.bufferData(\r\n            this.gl.ARRAY_BUFFER,\r\n            this.TEXCOORDS,\r\n            this.gl.STATIC_DRAW\r\n        );\r\n    }\r\n}","import Shape from \"./Shape\";\r\nimport { log, m4, Transform, Vec3 } from \"../../utils\";\r\n\r\nexport class CuboidBoundingBox {\r\n    readonly shape: Shape\r\n    readonly transform: Transform\r\n\r\n    constructor(shape: Shape) {\r\n        this.shape = shape\r\n        this.transform = shape.transform\r\n    }\r\n\r\n    get vertices() {\r\n        return this.shape.verticesTransformed\r\n    }\r\n\r\n    get size() {\r\n        return this.shape.size\r\n    }\r\n\r\n    get sizeRotated() {\r\n        return this.shape.sizeRotated\r\n    }\r\n\r\n    get halfSize() {\r\n        return this.shape.halfSize\r\n    }\r\n\r\n    get halfSizeRotated() {\r\n        return this.shape.halfSizeRotated\r\n    }\r\n\r\n    get negativeCorner() {\r\n        return this.transform.position.substract(this.halfSize)\r\n    }\r\n\r\n    get negativeCornerRotated() {\r\n        return this.transform.position.substract(this.halfSizeRotated)\r\n    }\r\n\r\n    get positiveCorner() {\r\n        return this.transform.position.add(this.halfSize)\r\n    }\r\n\r\n    get positiveCornerRotated() {\r\n        return this.transform.position.add(this.halfSizeRotated)\r\n    }\r\n\r\n    isColliding(v: Vec3) {\r\n        const pos = this.positiveCornerRotated\r\n        const neg = this.negativeCornerRotated\r\n        return neg.x <= v.x && v.x <= pos.x && neg.z <= v.z && v.z <= pos.z\r\n    }\r\n\r\n    pointSide(v: Vec3) {\r\n        const diff = this.transform.position.substract(v)\r\n        // const rotationMatrix = m4.yRotation(this.transform.rotation.y)\r\n        // const diffRotated = diff.transformMat4(rotationMatrix)\r\n        const diffRotated = diff\r\n\r\n        let pointSide = Vec3.zero\r\n        if (diffRotated.x > this.halfSizeRotated.x) {\r\n            pointSide.x = -1\r\n        }\r\n        if (diffRotated.x < -this.halfSizeRotated.x) {\r\n            pointSide.x = 1\r\n        }\r\n        if (diffRotated.z > this.halfSizeRotated.z) {\r\n            pointSide.z = -1\r\n        }\r\n        if (diffRotated.z < -this.halfSizeRotated.z) {\r\n            pointSide.z = 1\r\n        }\r\n        return pointSide\r\n    }\r\n\r\n    nearestDistanceDirection(v: Vec3) {\r\n        const side = this.pointSide(v)\r\n        if (side.x && side.z) {\r\n            return v.substract(this.nearestCorner(v)).yZeroed.normalize\r\n        } else {\r\n            return side\r\n        }\r\n    }\r\n\r\n    pointSideRotated(v: Vec3) {\r\n        const pointSide = this.pointSide(v)\r\n        const rotationMatrix = m4.yRotation(-this.transform.rotation.y)\r\n        return pointSide.transformMat4(rotationMatrix)\r\n    }\r\n    pointFarthestSideRotated(v: Vec3) {\r\n        const pointSide = this.pointFarthestSide(v)\r\n        const rotationMatrix = m4.yRotation(-this.transform.rotation.y)\r\n        return pointSide.transformMat4(rotationMatrix)\r\n    }\r\n\r\n    // only a non rotated cuboid\r\n    pointFarthestSide(v: Vec3) {\r\n        const diff = this.transform.position.substract(v)\r\n        const rotationMatrix = m4.yRotation(this.transform.rotation.y)\r\n        const diffRotated = diff.transformMat4(rotationMatrix)\r\n        let pointSide = this.pointSide(v)\r\n        if (pointSide.x && pointSide.z) {\r\n            if (Math.abs(diffRotated.x) > Math.abs(diffRotated.z)) {\r\n                pointSide.z = 0\r\n            } else {\r\n                pointSide.x = 0\r\n            }\r\n        }\r\n        return pointSide\r\n    }\r\n\r\n    // cuboid rotated by any value\r\n    nearestCorner(v: Vec3) {\r\n        const diff = this.transform.position.substract(v)\r\n        if (diff.x <= 0 && diff.z <= 0) {\r\n            return this.transform.position.substract(this.halfSizeRotated)\r\n        } else if (diff.x <= 0 && diff.z >= 0) {\r\n            const cornerRelative = new Vec3(-this.halfSizeRotated.x, 0, this.halfSizeRotated.z)\r\n            return this.transform.position.substract(cornerRelative)\r\n        } else if (diff.x >= 0 && diff.z <= 0) {\r\n            const cornerRelative = new Vec3(this.halfSizeRotated.x, 0, -this.halfSizeRotated.z)\r\n            return this.transform.position.substract(cornerRelative)\r\n        } else if (diff.x >= 0 && diff.z >= 0) {\r\n            return this.transform.position.add(this.halfSizeRotated)\r\n        }\r\n    }\r\n\r\n    basePointsYZeroed() {\r\n        const a = this.halfSizeRotated.yZeroed\r\n        return [\r\n            this.transform.position.add(a),\r\n            this.transform.position.add(a.xInverted),\r\n            this.transform.position.add(a.yInverted),\r\n            this.transform.position.substract(a),\r\n        ]\r\n    }\r\n}","import Shape from './Shape'\r\nimport { CuboidBoundingBox } from './CuboidBoundingBox'\r\nimport { Vec2 } from '../../utils'\r\n\r\nexport default abstract class Cuboid extends Shape {\r\n    VERTICES = new Float32Array([\r\n        // front    \r\n        -0.5, -0.5, 0.5,\r\n        0.5, 0.5, 0.5,\r\n        -0.5, 0.5, 0.5,\r\n        -0.5, -0.5, 0.5,\r\n        0.5, -0.5, 0.5,\r\n        0.5, 0.5, 0.5,\r\n\r\n        // back    \r\n        -0.5, -0.5, -0.5,\r\n        -0.5, 0.5, -0.5,\r\n        0.5, 0.5, -0.5,\r\n        -0.5, -0.5, -0.5,\r\n        0.5, 0.5, -0.5,\r\n        0.5, -0.5, -0.5,\r\n\r\n        // left    \r\n        -0.5, -0.5, -0.5,\r\n        -0.5, -0.5, 0.5,\r\n        -0.5, 0.5, 0.5,\r\n        -0.5, -0.5, -0.5,\r\n        -0.5, 0.5, 0.5,\r\n        -0.5, 0.5, -0.5,\r\n\r\n        // right    \r\n        0.5, -0.5, -0.5,\r\n        0.5, 0.5, 0.5,\r\n        0.5, -0.5, 0.5,\r\n        0.5, -0.5, -0.5,\r\n        0.5, 0.5, -0.5,\r\n        0.5, 0.5, 0.5,\r\n\r\n        // top    \r\n        -0.5, 0.5, -0.5,\r\n        0.5, 0.5, 0.5,\r\n        0.5, 0.5, -0.5,\r\n        -0.5, 0.5, 0.5,\r\n        0.5, 0.5, 0.5,\r\n        -0.5, 0.5, -0.5,\r\n\r\n        // bottom    \r\n        0.5, -0.5, -0.5,\r\n        0.5, -0.5, 0.5,\r\n        -0.5, -0.5, -0.5,\r\n        -0.5, -0.5, -0.5,\r\n        0.5, -0.5, 0.5,\r\n        -0.5, -0.5, 0.5,\r\n    ])\r\n\r\n    COLORS = new Uint8Array([\r\n        80, 70, 200,\r\n        80, 70, 200,\r\n        80, 70, 200,\r\n        80, 70, 200,\r\n        80, 70, 200,\r\n        80, 70, 200,\r\n\r\n        200, 70, 0.520,\r\n        200, 70, 0.520,\r\n        200, 70, 0.520,\r\n        200, 70, 0.520,\r\n        200, 70, 0.520,\r\n        200, 70, 0.520,\r\n\r\n        70, 200, 20.50,\r\n        70, 200, 20.50,\r\n        70, 200, 20.50,\r\n        70, 200, 20.50,\r\n        70, 200, 20.50,\r\n        70, 200, 20.50,\r\n\r\n        200, 200, 70,\r\n        200, 200, 70,\r\n        200, 200, 70,\r\n        200, 200, 70,\r\n        200, 200, 70,\r\n        200, 200, 70,\r\n\r\n        20.50, 0.500, 70,\r\n        20.50, 0.500, 70,\r\n        20.50, 0.500, 70,\r\n        20.50, 0.500, 70,\r\n        20.50, 0.500, 70,\r\n        20.50, 0.500, 70,\r\n\r\n        20.50, 0.560, 70,\r\n        20.50, 0.560, 70,\r\n        20.50, 0.560, 70,\r\n        20.50, 0.560, 70,\r\n        20.50, 0.560, 70,\r\n        20.50, 0.560, 70,\r\n    ])\r\n\r\n    TEXCOORDS = new Float32Array([\r\n        // front\r\n        0, 1,\r\n        1, 0,\r\n        0, 0,\r\n        0, 1,\r\n        1, 1,\r\n        1, 0,\r\n\r\n        // back\r\n        1, 1,\r\n        1, 0,\r\n        0, 0,\r\n        1, 1,\r\n        0, 0,\r\n        0, 1,\r\n\r\n        // left\r\n        0, 1,\r\n        1, 1,\r\n        1, 0,\r\n        0, 1,\r\n        1, 0,\r\n        0, 0,\r\n\r\n        // right\r\n        1, 1,\r\n        0, 0,\r\n        0, 1,\r\n        1, 1,\r\n        1, 0,\r\n        0, 0,\r\n\r\n\r\n        // top\r\n        0, 0,\r\n        1, 1,\r\n        1, 0,\r\n        0, 1,\r\n        1, 1,\r\n        0, 0,\r\n\r\n        // bottom\r\n        1, 1,\r\n        1, 0,\r\n        0, 1,\r\n        0, 1,\r\n        1, 0,\r\n        0, 0,\r\n    ])\r\n\r\n    readonly bb: CuboidBoundingBox = new CuboidBoundingBox(this)\r\n    readonly defaultColors = this.COLORS\r\n\r\n    abstract lightTexture: number\r\n    abstract darkTexture: number\r\n\r\n    onCreation() {\r\n        this.setTexture(0)\r\n    }\r\n\r\n    setColor(wall: number, color: number[]) {\r\n        this.COLORS = new Uint8Array([\r\n            ...this.COLORS.slice(0, 3 * 6 * wall),\r\n            color[0], color[1], color[2],\r\n            color[0], color[1], color[2],\r\n            color[0], color[1], color[2],\r\n            color[0], color[1], color[2],\r\n            color[0], color[1], color[2],\r\n            color[0], color[1], color[2],\r\n            ...this.COLORS.slice(3 * 6 * (wall + 1))])\r\n    }\r\n\r\n    wallTexcoords(wall: number) {\r\n        return this.TEXCOORDS.slice(2 * 6 * wall, 2 * 6 * (wall + 1))\r\n    }\r\n\r\n    initialWallTexcoords(wall: number) {\r\n        return this.initialTexcoords.slice(2 * 6 * wall, 2 * 6 * (wall + 1))\r\n    }\r\n\r\n    resetColor() {\r\n        this.COLORS = this.defaultColors\r\n    }\r\n\r\n    texturesInLine = 1\r\n    get textureSize() {\r\n        return 1 / this.texturesInLine\r\n    }\r\n\r\n    setTexture(textureNumber: number, wallNumber?: number) {\r\n        let newTexcoords = []\r\n        if (wallNumber !== undefined) {\r\n            for (let i = 0; i < 6; i++) {\r\n                if (i == wallNumber) {\r\n                    newTexcoords.push(...this.setTexcoordsToTexture(textureNumber, this.initialWallTexcoords(wallNumber)))\r\n                } else {\r\n                    newTexcoords.push(...this.wallTexcoords(i))\r\n                }\r\n            }\r\n        } else {\r\n            newTexcoords = [...this.setTexcoordsToTexture(textureNumber, this.initialTexcoords)]\r\n        }\r\n        this.TEXCOORDS = new Float32Array(newTexcoords)\r\n    }\r\n\r\n    private setTexcoordsToTexture(textureNumber: number, texcoords: Float32Array) {\r\n        let verticesVec2Array = Vec2.arrayToVec2Array(texcoords)\r\n        const texturePos = new Vec2(textureNumber % this.texturesInLine, Math.floor(textureNumber / this.texturesInLine)).multiply(this.textureSize)\r\n        verticesVec2Array = verticesVec2Array.map(vertex => vertex.multiply(this.textureSize).add(texturePos))\r\n        return Vec2.vec2ArrayToArray(verticesVec2Array)\r\n    }\r\n}","export default {\r\n    gridSize: 64,\r\n    uiScale: 2,\r\n    debug: false,\r\n    // soundVolume: 0.05,\r\n    // musicVolume: 0.03,\r\n    soundVolume: 1,\r\n    musicVolume: 0.6,\r\n}","import Config from \"./Config\"\r\n\r\nexport default class BetterAudio {\r\n    audio: HTMLAudioElement\r\n    private playLoading = false\r\n    private playPromise: Promise<void>\r\n    name\r\n\r\n    constructor(sound: string, volume?: number) {\r\n        this.audio = new Audio(sound)\r\n        this.name = sound\r\n        this.audio.volume = volume || Config.soundVolume\r\n    }\r\n\r\n    play() {\r\n        this.audio.currentTime = 0\r\n        this.playLoading = true\r\n        this.playPromise = this.audio.play()\r\n        this.playPromise.then(() => this.playLoading = false)\r\n    }\r\n\r\n    playIfNotPlayed() {\r\n        // const isPlaying = this.audio.currentTime > 0 && !this.audio.paused && !this.audio.ended && this.audio.readyState > this.audio.HAVE_CURRENT_DATA;\r\n\r\n        // if (!isPlaying) {\r\n        //     this.audio.currentTime = 0\r\n        //     this.audio.play();\r\n        // }\r\n        if (this.audio.currentTime == 0) {\r\n            this.playLoading = true\r\n            this.playPromise = this.audio.play()\r\n            this.playPromise.then(() => this.playLoading = false)\r\n        }\r\n    }\r\n\r\n    pause() {\r\n        if (this.playLoading) {\r\n            this.playPromise.then(() => this.audio.pause())\r\n        } else {\r\n            this.audio.pause();\r\n        }\r\n    }\r\n\r\n    loop() {\r\n        this.audio.loop = true\r\n    }\r\n}","import { log, m4, Vec3 } from '../../utils'\r\nimport Cuboid from './Cuboid'\r\nimport Interactable from './Interactable'\r\nimport texture from '../../../textures/wall.png'\r\nimport Config from '../../Config'\r\nimport { Program } from '../../programs/Program'\r\nimport Camera from '../../Camera'\r\nimport Enemy from './Enemy'\r\nimport openAudio from \"../../../sounds/WSND0003.wav\"\r\nimport closeAudio from \"../../../sounds/WSND0002.wav\"\r\nimport BetterAudio from '../../BetterAudio'\r\n\r\nexport default class Door extends Cuboid implements Interactable {\r\n    importedTexture = texture\r\n    openAudio = new BetterAudio(openAudio)\r\n    closeAudio = new BetterAudio(closeAudio)\r\n\r\n    get lightTexture() {\r\n        switch (this.type) {\r\n            case 'exitDoor': return 119\r\n            default: return 104\r\n        }\r\n    }\r\n    get lightSideTexture() {\r\n        switch (this.type) {\r\n            case 'exitDoor': return 119\r\n            default: return 108\r\n        }\r\n    }\r\n    get darkTexture() {\r\n        switch (this.type) {\r\n            case 'exitDoor': return 119\r\n            default: return 105\r\n        }\r\n    }\r\n    get darkSideTexture() {\r\n        switch (this.type) {\r\n            case 'exitDoor': return 119\r\n            default: return 109\r\n        }\r\n    }\r\n\r\n    private opening = false\r\n    private closing = false\r\n\r\n    private readonly openingSpeed = Config.gridSize\r\n    private readonly openingLength = Config.gridSize\r\n\r\n    private readonly hiddenInWallScaleCorrection = new Vec3(0.1, 0.1, 0)\r\n    // private readonly hiddenInWallScaleCorrection = new Vec3(10, 10, 0)\r\n\r\n    private positionFinal: Vec3\r\n\r\n    texturesInLine = 16\r\n\r\n    TEXCOORDS = new Float32Array([\r\n        // front\r\n        0, 1,\r\n        1, 0,\r\n        0, 0,\r\n        0, 1,\r\n        1, 1,\r\n        1, 0,\r\n\r\n        // back\r\n        0, 1,\r\n        0, 0,\r\n        1, 0,\r\n        0, 1,\r\n        1, 0,\r\n        1, 1,\r\n\r\n        // left\r\n        0, 1,\r\n        1, 1,\r\n        1, 0,\r\n        0, 1,\r\n        1, 0,\r\n        0, 0,\r\n\r\n        // right\r\n        1, 1,\r\n        0, 0,\r\n        0, 1,\r\n        1, 1,\r\n        1, 0,\r\n        0, 0,\r\n\r\n\r\n        // top\r\n        0, 0,\r\n        1, 1,\r\n        1, 0,\r\n        0, 1,\r\n        1, 1,\r\n        0, 0,\r\n\r\n        // bottom\r\n        1, 1,\r\n        1, 0,\r\n        0, 1,\r\n        0, 1,\r\n        1, 0,\r\n        0, 0,\r\n    ])\r\n    type: string\r\n    constructor(gl: WebGLRenderingContext, program: Program, type?: string) {\r\n        super(gl, program)\r\n        this.transform.scale = new Vec3(Config.gridSize, Config.gridSize, Config.gridSize * 6 / 64)\r\n        this.type = type\r\n    }\r\n\r\n    onCreation() {\r\n        const translationFinal = new Vec3(this.openingLength, 0, 0)\r\n        let mFinal = m4.identity\r\n        mFinal = m4.translate(mFinal, translationFinal)\r\n        mFinal = m4.yRotate(mFinal, this.transform.rotation.y)\r\n        const positionDeltaFinal = m4.getPositionVector(mFinal)\r\n        this.positionFinal = this.initialTransform.position.add(positionDeltaFinal)\r\n        if (this.transform.rotation.y) {\r\n            this.setTexture(this.darkTexture)\r\n            this.setTexture(this.lightSideTexture, 2)\r\n            this.setTexture(this.lightSideTexture, 3)\r\n        } else {\r\n            this.setTexture(this.lightTexture)\r\n            this.setTexture(this.darkSideTexture, 2)\r\n            this.setTexture(this.darkSideTexture, 3)\r\n        }\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        const translation = new Vec3(this.openingSpeed * deltaTime, 0, 0)\r\n        let m = m4.identity\r\n        m = m4.translate(m, translation)\r\n        m = m4.yRotate(m, this.transform.rotation.y)\r\n        const positionDelta = m4.getPositionVector(m)\r\n\r\n        if (this.opening) {\r\n            if (this.transform.position.equals(this.positionFinal)) {\r\n                this.opening = false\r\n                if (this.initialTransform.scale.equals(this.transform.scale)) {\r\n                    this.transform.scale = this.transform.scale.substract(this.hiddenInWallScaleCorrection)\r\n                }\r\n            } else {\r\n                if (this.positionFinal.substract(this.transform.position).isLess(positionDelta)) {\r\n                    this.transform.position = this.positionFinal.clone()\r\n                } else {\r\n                    this.transform.position = this.transform.position.add(positionDelta)\r\n                }\r\n            }\r\n        } else if (this.closing) {\r\n            if (this.transform.position.equals(this.initialTransform.position)) {\r\n                this.closing = false\r\n            } else {\r\n                if (this.transform.position.substract(this.initialTransform.position).isLess(positionDelta)) {\r\n                    this.transform.position = this.initialTransform.position.clone()\r\n                } else {\r\n                    this.transform.position = this.transform.position.substract(positionDelta)\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    get closed() {\r\n        return this.transform.position.equals(this.initialTransform.position)\r\n    }\r\n\r\n    get opened() {\r\n        return this.transform.position.equals(this.positionFinal)\r\n    }\r\n\r\n    toggle() {\r\n        if (this.closed) {\r\n            this.closing = false\r\n            this.opening = true\r\n            this.openAudio.play()\r\n        } else if (this.opened) {\r\n            if (this.transform.scale.add(this.hiddenInWallScaleCorrection).equals(this.initialTransform.scale)) {\r\n                this.transform.scale = this.transform.scale.add(this.hiddenInWallScaleCorrection)\r\n            }\r\n            this.opening = false\r\n            this.closing = true\r\n            this.closeAudio.play()\r\n        }\r\n    }\r\n\r\n    get canInteract() {\r\n        return this.closed\r\n    }\r\n\r\n    tryToClose(deltaTime: number, camera: Camera, enemies: Enemy[]) {\r\n        const nothingCollides = [camera, ...enemies].every(obj => obj.transform.position.yZeroed.distanceTo(this.initialTransform.position.yZeroed) > Config.gridSize * 2)\r\n        if (nothingCollides && this.opened) {\r\n            this.toggle()\r\n        }\r\n    }\r\n}","import menuUnselected from '../../../textures/menuUnselected.png'\r\nimport menuSelected from '../../../textures/menuSelected.png'\r\nimport menuSelectedBlink from '../../../textures/menuSelectedBlink.png'\r\nimport Config from '../../Config'\r\nimport { Vec2 } from '../../utils'\r\nimport BetterAudio from '../../BetterAudio'\r\nimport audioMove from '../../../sounds/M_MOVE.wav'\r\nimport audioSelect from '../../../sounds/M_SELECT.wav'\r\nimport audioBack from '../../../sounds/M_BACK.wav'\r\nimport UI from './UI'\r\n\r\nexport default class Menu {\r\n    canvas: HTMLCanvasElement\r\n    private ctx: CanvasRenderingContext2D\r\n    private menuUnselected: HTMLImageElement\r\n    private menuSelected: HTMLImageElement\r\n    private menuSelectedBlink: HTMLImageElement\r\n    audioSelect = new BetterAudio(audioSelect)\r\n    audioMove = new BetterAudio(audioMove)\r\n    audioBack = new BetterAudio(audioBack)\r\n    option = 0\r\n\r\n    constructor() {\r\n        this.canvas = document.createElement('canvas')\r\n        this.ctx = this.canvas.getContext('2d')\r\n\r\n        this.canvas.width = 640\r\n        this.canvas.height = 400\r\n\r\n        this.menuUnselected = new Image();\r\n        this.menuUnselected.src = menuUnselected;\r\n\r\n        this.menuSelected = new Image();\r\n        this.menuSelected.src = menuSelected;\r\n\r\n        this.menuSelectedBlink = new Image();\r\n        this.menuSelectedBlink.src = menuSelectedBlink;\r\n\r\n        addEventListener(\"keydown\", e => {\r\n            if (UI.instance.state == \"menu\") {\r\n                if (e.code == \"ArrowDown\" || e.code == \"ArrowUp\") {\r\n                    if (this.option == 0) {\r\n                        this.option = 8\r\n                    } else {\r\n                        this.option = 0\r\n                    }\r\n                    this.audioMove.play()\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    private timeSinceLastBlink = 0\r\n    private timeSinceBlinkStart = 0\r\n    private readonly blinkInterval = 1\r\n    private readonly blinkDuration = 0.1\r\n\r\n    private readonly optionSize = new Vec2(300, 26)\r\n\r\n    update(deltaTime: number) {\r\n        this.ctx.drawImage(this.menuUnselected, 0, 0)\r\n\r\n        let image = this.menuSelected\r\n        this.timeSinceLastBlink += deltaTime\r\n        if (this.timeSinceLastBlink >= this.blinkInterval) {\r\n            image = this.menuSelectedBlink\r\n        }\r\n        if (image == this.menuSelectedBlink) {\r\n            this.timeSinceBlinkStart += deltaTime\r\n            if (this.timeSinceBlinkStart >= this.blinkDuration) {\r\n                this.timeSinceLastBlink = 0\r\n                this.timeSinceBlinkStart = 0\r\n            }\r\n        }\r\n\r\n\r\n        this.ctx.drawImage(\r\n            image,\r\n            150,\r\n            108 + this.option * this.optionSize.y,\r\n            this.optionSize.x,\r\n            this.optionSize.y,\r\n            150,\r\n            108 + this.option * this.optionSize.y,\r\n            this.optionSize.x,\r\n            this.optionSize.y\r\n        )\r\n    }\r\n}","import levelEnd from '../../../textures/levelEnd.png'\r\nimport uiElements from '../../../textures/uiElements.png'\r\nimport font from '../../../textures/font.png'\r\nimport Config from '../../Config'\r\nimport { Vec2 } from '../../utils'\r\nimport UI from './UI'\r\n\r\nexport default class LevelEnd {\r\n    canvas: HTMLCanvasElement\r\n    private ctx: CanvasRenderingContext2D\r\n    private levelEnd: HTMLImageElement\r\n    private uiElements: HTMLImageElement\r\n    private font: HTMLImageElement\r\n\r\n    private displayTime = ''\r\n    private bonusScore = 0\r\n    private animation = 0\r\n\r\n    enemiesRatio: string = '0'\r\n    secretsRatio: string = '0'\r\n    treasuresRatio: string = '0'\r\n\r\n    constructor() {\r\n        this.canvas = document.createElement('canvas')\r\n\r\n        this.ctx = this.canvas.getContext('2d')\r\n        this.ctx.imageSmoothingEnabled = false;\r\n\r\n        this.canvas.width = 320\r\n        this.canvas.height = 200\r\n\r\n        this.levelEnd = new Image();\r\n        this.levelEnd.src = levelEnd;\r\n\r\n        this.uiElements = new Image();\r\n        this.uiElements.src = uiElements;\r\n\r\n        this.font = new Image();\r\n        this.font.src = font;\r\n\r\n        setInterval(() => {\r\n            this.animation = this.animation ? 0 : 1\r\n        }, 500)\r\n    }\r\n\r\n    calculateValues() {\r\n        UI.instance.endTime = new Date()\r\n        const timeDiff = new Date(UI.instance.endTime.getTime() - UI.instance.startTime.getTime())\r\n        this.displayTime = timeDiff.toTimeString().substring(3, 8)\r\n        const playTimeSeconds = 90 - Math.floor(timeDiff.getTime() / 1000)\r\n        this.bonusScore = playTimeSeconds * 500\r\n\r\n        this.enemiesRatio = (Math.floor(UI.instance.enemiesKilled / UI.instance.enemiesCount * 100)).toString()\r\n        this.secretsRatio = (Math.floor(UI.instance.secretsFound / UI.instance.secretsCount * 100)).toString()\r\n        this.treasuresRatio = (Math.floor(UI.instance.treasuresFound / UI.instance.treasuresCount * 100)).toString()\r\n\r\n        for (let ratio of [this.enemiesRatio, this.secretsRatio, this.treasuresRatio]) {\r\n            if (ratio == '100') {\r\n                this.bonusScore += 10000\r\n            }\r\n        }\r\n        UI.instance.score += this.bonusScore\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        this.ctx.drawImage(this.levelEnd, 0, 0)\r\n        this.ctx.drawImage(this.uiElements, 81 * this.animation, 60, 81, 87, 20, 16, 81, 87)\r\n        this.drawTime()\r\n        this.drawBonusScore()\r\n        this.drawRatios()\r\n    }\r\n\r\n    drawTime() {\r\n        this.drawDigit(parseInt(this.displayTime[0]), 208 + 16 * 0, 80)\r\n        this.drawDigit(parseInt(this.displayTime[1]), 208 + 16 * 1, 80)\r\n        this.drawDigit(parseInt(this.displayTime[3]), 208 + 8 + 16 * 2, 80)\r\n        this.drawDigit(parseInt(this.displayTime[4]), 208 + 8 + 16 * 3, 80)\r\n    }\r\n\r\n    drawBonusScore() {\r\n        this.drawDigit(parseInt(this.bonusScore.toString()[0]), 208 + 16 * 0, 56)\r\n        this.drawDigit(parseInt(this.bonusScore.toString()[1]), 208 + 16 * 1, 56)\r\n        this.drawDigit(parseInt(this.bonusScore.toString()[2]), 208 + 16 * 2, 56)\r\n        this.drawDigit(parseInt(this.bonusScore.toString()[3]), 208 + 16 * 3, 56)\r\n        this.drawDigit(parseInt(this.bonusScore.toString()[4]), 208 + 16 * 4, 56)\r\n    }\r\n\r\n    drawRatios() {\r\n        for (let i = 0; i < this.enemiesRatio.length; i++) {\r\n            this.drawDigit(parseInt(this.enemiesRatio[this.enemiesRatio.length - 1 - i]), 280 - 16 * i, 112 + 16 * 0)\r\n        }\r\n        for (let i = 0; i < this.secretsRatio.length; i++) {\r\n            this.drawDigit(parseInt(this.secretsRatio[this.secretsRatio.length - 1 - i]), 280 - 16 * i, 112 + 16 * 1)\r\n        }\r\n        for (let i = 0; i < this.treasuresRatio.length; i++) {\r\n            this.drawDigit(parseInt(this.treasuresRatio[this.treasuresRatio.length - 1 - i]), 280 - 16 * i, 112 + 16 * 2)\r\n        }\r\n    }\r\n\r\n    private drawDigit(digit: number, x: number, y: number) {\r\n        this.ctx.drawImage(this.font, 16 * digit, 0, 16, 16, x, y, 16, 16)\r\n    }\r\n}","import BetterAudio from \"../../BetterAudio\"\r\nimport AudioPlayer from \"../../BetterAudio\"\r\n\r\nexport type weaponType = \"knife\" | \"pistol\" | \"machinegun\" | \"chaingun\"\r\n\r\nexport class Weapon {\r\n    type: weaponType\r\n    fireRate: number\r\n    damage: number\r\n    initTextures: number[]\r\n    loopTextures: number[]\r\n    shootTexture: number\r\n    audio: BetterAudio\r\n\r\n    range: number = 1000000\r\n\r\n    shooting = false\r\n    willShoot = false\r\n    justShot = false\r\n\r\n    private textureIndex: number = 0\r\n    private currentTextures: number[]\r\n\r\n    constructor(\r\n        type: weaponType,\r\n        fireRate: number,\r\n        damage: number,\r\n        initTextures: number[],\r\n        loopTextures: number[],\r\n        shootTexture: number,\r\n        audio: string,\r\n    ) {\r\n        this.type = type\r\n        this.fireRate = fireRate\r\n        this.damage = damage\r\n        this.initTextures = initTextures\r\n        this.loopTextures = loopTextures\r\n        this.shootTexture = shootTexture\r\n        this.audio = new BetterAudio(audio)\r\n\r\n        this.currentTextures = initTextures\r\n    }\r\n\r\n    get isAutomatic() {\r\n        return this.loopTextures.length > 0\r\n    }\r\n\r\n    get isTextureLastInit() {\r\n        return this.textureIndex\r\n    }\r\n\r\n    get framesCount() {\r\n        if (this.isAutomatic) {\r\n            return this.loopTextures.length\r\n        } else {\r\n            return this.initTextures.length\r\n        }\r\n    }\r\n\r\n    getNextTexture() {\r\n        this.justShot = false\r\n        if (!this.isAutomatic) {\r\n            if (this.willShoot) {\r\n                return this.getNextShootingTexture()\r\n            } else {\r\n                return this.initTextures[0]\r\n            }\r\n        } else {\r\n            if (this.shooting) {\r\n                return this.getNextShootingTexture()\r\n            } else {\r\n                return this.getNextStoppedShootingTexture()\r\n            }\r\n        }\r\n    }\r\n\r\n    getNextShootingTexture() {\r\n        this.textureIndex++\r\n        if (this.textureIndex >= this.currentTextures.length) {\r\n            if (this.currentTextures == this.initTextures && this.isAutomatic) {\r\n                this.currentTextures = this.loopTextures\r\n            } else {\r\n                this.willShoot = false\r\n            }\r\n            this.textureIndex = 0\r\n        }\r\n        const texture = this.currentTextures[this.textureIndex]\r\n        if (texture == this.shootTexture) {\r\n            this.justShot = true\r\n        }\r\n        return texture\r\n    }\r\n\r\n    getNextStoppedShootingTexture() {\r\n        if (this.currentTextures == this.loopTextures) {\r\n            this.currentTextures = this.initTextures\r\n            this.textureIndex = this.initTextures.length - 1\r\n        }\r\n        let texture = this.currentTextures[this.textureIndex]\r\n        this.textureIndex--\r\n        if (this.textureIndex < 0) {\r\n            this.textureIndex = 0\r\n        }\r\n        return texture\r\n    }\r\n}","import { degToRad, m4, Vec2, Vec3 } from '../../utils'\r\nimport { Weapon, weaponType } from './Weapon'\r\nimport texture from '../../../textures/weapons.png'\r\nimport Config from '../../Config'\r\nimport Input from '../../Input'\r\nimport UI from './UI'\r\nimport knife from \"../../../sounds/DSWKNIF.wav\"\r\nimport pistol from \"../../../sounds/WSND0005.wav\"\r\nimport machinegun from \"../../../sounds/WSND0004.wav\"\r\nimport chaingun from \"../../../sounds/WSND0006.wav\"\r\n\r\n\r\nexport default class Weapons {\r\n    importedTexture = texture\r\n\r\n    availableTypes: weaponType[] = ['knife', 'pistol']\r\n    // availableTypes: weaponType[] = ['knife', 'pistol', 'machinegun', 'chaingun']\r\n\r\n    private weapons: Weapon[] = []\r\n    private texturesCount = new Vec2(8, 4)\r\n    private textureNumber: number\r\n    private texture: HTMLImageElement\r\n\r\n    private timeSinceLastUpdate = 0\r\n\r\n    constructor() {\r\n        this.texture = new Image()\r\n        this.texture.src = texture\r\n\r\n        this.weapons.push(new Weapon(\"knife\", 2.4, 40, [0, 1, 2, 3, 4], [], 3, knife))\r\n        this.weapons[0].range = Config.gridSize * 0.75\r\n        this.weapons.push(new Weapon(\"pistol\", 2.4, 70, [8, 9, 10, 11, 12], [], 10, pistol))\r\n        this.weapons.push(new Weapon(\"machinegun\", 6, 70, [16, 17], [18, 19], 19, machinegun))\r\n        this.weapons.push(new Weapon(\"chaingun\", 12, 70, [24, 25], [26, 27], 26, chaingun))\r\n\r\n        this.textureNumber = this.currentWeapon.initTextures[0]\r\n    }\r\n\r\n    get textureSize() {\r\n        return this.texturesCount.map(v => 1 / v)\r\n    }\r\n\r\n    get currentWeapon() {\r\n        return this.weapons.find(weapon => weapon.type == UI.instance.weapon)\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        this.timeSinceLastUpdate += deltaTime\r\n\r\n        if (0 < Input.instance.lastNumber && Input.instance.lastNumber <= this.weapons.length) {\r\n            for (let i = 0; i < this.weapons.length; i++) {\r\n                if (Input.instance.lastNumber == i + 1) {\r\n                    if (this.availableTypes.includes(this.weapons[i].type)) {\r\n                        UI.instance.weapon = this.weapons[i].type\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        this.setShooting(Input.instance.shooting && UI.instance.ammo > 0)\r\n        if (Input.instance.shot && (UI.instance.ammo > 0 || this.currentWeapon.type == 'knife')) {\r\n            this.shoot()\r\n            Input.instance.justShot = true\r\n        }\r\n\r\n        if (this.currentWeapon.justShot) {\r\n            this.decreaseAmmo()\r\n            this.currentWeapon.audio.play()\r\n        }\r\n\r\n        const frameTime = 1 / (this.currentWeapon.fireRate * this.currentWeapon.framesCount)\r\n\r\n        this.currentWeapon.justShot = false\r\n\r\n        if (this.timeSinceLastUpdate >= frameTime) {\r\n            this.timeSinceLastUpdate = 0\r\n            this.textureNumber = this.currentWeapon.getNextTexture()\r\n        }\r\n\r\n    }\r\n\r\n    private decreaseAmmo() {\r\n        if (this.currentWeapon.type != 'knife') {\r\n            if (UI.instance.ammo > 0) {\r\n                UI.instance.ammo--\r\n            }\r\n            if (UI.instance.ammo == 0) {\r\n                UI.instance.weapon = 'knife'\r\n            }\r\n        }\r\n    }\r\n\r\n    private shoot() {\r\n        if (!this.currentWeapon.isAutomatic) {\r\n            this.currentWeapon.willShoot = true\r\n        }\r\n    }\r\n\r\n    private setShooting(shooting: boolean) {\r\n        if (this.currentWeapon.isAutomatic) {\r\n            this.currentWeapon.shooting = shooting\r\n        }\r\n    }\r\n\r\n    draw(context: CanvasRenderingContext2D) {\r\n        // x 322 - p szerokoci\r\n        // y 312 - wysoko\r\n        const width = 64\r\n        const height = 64\r\n        const row = Math.floor(this.textureNumber / this.texturesCount.x)\r\n        const col = this.textureNumber % this.texturesCount.x\r\n        // console.log(this.textureNumber)\r\n        context.drawImage(\r\n            this.texture,\r\n            64 * col,\r\n            64 * row,\r\n            64,\r\n            64,\r\n            (317.5 - (width * 4.8 / 2)) * Config.uiScale,\r\n            (312 - (height * 4.8)) * Config.uiScale,\r\n            width * Config.uiScale * 4.8,\r\n            height * Config.uiScale * 4.8\r\n        )\r\n    }\r\n}","import uiElements from '../../../textures/uiElements.png'\r\nimport Config from '../../Config'\r\nimport UI from './UI'\r\n\r\nexport default class LoadingScreen {\r\n    canvas: HTMLCanvasElement\r\n    private ctx: CanvasRenderingContext2D\r\n    private uiElements: HTMLImageElement\r\n    private progress = 0\r\n    private state = \"beforeLoading\"\r\n    private readonly loadingTime = 1\r\n    private readonly beforeLoadingDelay = 0.3\r\n    private readonly afterLoadingDelay = 0.3\r\n\r\n    constructor() {\r\n        this.canvas = document.createElement('canvas')\r\n\r\n        this.ctx = this.canvas.getContext('2d')\r\n        this.ctx.imageSmoothingEnabled = false;\r\n\r\n        this.canvas.width = 320\r\n        this.canvas.height = 200\r\n\r\n        this.uiElements = new Image();\r\n        this.uiElements.src = uiElements;\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        if (UI.instance.state != 'loading') return\r\n        this.ctx.fillStyle = \"#004141\"\r\n        this.ctx.fillRect(0, 0, 320, 160)\r\n        this.ctx.drawImage(\r\n            this.uiElements,\r\n            0,\r\n            160,\r\n            224,\r\n            48,\r\n            96 / 2,\r\n            112 / 2,\r\n            224,\r\n            48\r\n        )\r\n        if (this.state == 'beforeLoading') {\r\n            this.progress += deltaTime\r\n            if (this.progress >= this.beforeLoadingDelay) {\r\n                this.state = \"loading\"\r\n                this.progress = 0\r\n            }\r\n        } else if (this.state == 'loading') {\r\n            this.progress += deltaTime / this.loadingTime\r\n            if (this.progress >= 1) {\r\n                this.progress = 0\r\n                this.state = \"afterLoading\"\r\n            }\r\n        } else if (this.state == 'afterLoading') {\r\n            this.progress += deltaTime\r\n            if (this.progress >= this.afterLoadingDelay) {\r\n                this.progress = 0\r\n                UI.instance.state = 'game'\r\n                UI.instance.startTime = new Date()\r\n            }\r\n        }\r\n\r\n        if (this.state != 'beforeLoading') {\r\n            let width = 214 * this.progress\r\n            if (this.state == 'afterLoading') {\r\n                width = 214\r\n            }\r\n            if (width > 0) {\r\n                this.ctx.fillStyle = \"#ff0000\"\r\n                this.ctx.fillRect(53, 101, width, 2)\r\n                this.ctx.fillStyle = \"#ff9e9e\"\r\n                this.ctx.fillRect(53, 101, width - 1, 1)\r\n            }\r\n        }\r\n    }\r\n}","export default class DeathScreen {\r\n    canvas: HTMLCanvasElement\r\n    private ctx: CanvasRenderingContext2D\r\n    private pixels: ImageData\r\n    private frame = 0\r\n    private started = false\r\n    private reversed = false\r\n    private interval: NodeJS.Timer\r\n\r\n    constructor() {\r\n        this.canvas = document.createElement('canvas')\r\n\r\n        this.ctx = this.canvas.getContext('2d')\r\n        this.ctx.imageSmoothingEnabled = false;\r\n\r\n        this.canvas.width = 320\r\n        this.canvas.height = 200\r\n\r\n        this.pixels = this.ctx.createImageData(this.canvas.width, this.canvas.height);\r\n    }\r\n\r\n    start() {\r\n        if (!this.started) {\r\n            this.started = true\r\n            this.interval = setInterval(() => this.update(), 1);\r\n        }\r\n    }\r\n\r\n    /* Write a pixel, just set alpha and RGB channels. */\r\n    private setPixelRed(x: number, y: number) {\r\n        var offset = x * 4 + y * 4 * this.canvas.width;\r\n        this.pixels.data[offset + 3] = 255;\r\n        this.pixels.data[offset + 0] = 255;\r\n        this.pixels.data[offset + 1] = 0;\r\n        this.pixels.data[offset + 2] = 0;\r\n    }\r\n    private setPixelTransparent(x: number, y: number) {\r\n        var offset = x * 4 + y * 4 * this.canvas.width;\r\n        this.pixels.data[offset + 3] = 0;\r\n        this.pixels.data[offset + 0] = 0;\r\n        this.pixels.data[offset + 1] = 0;\r\n        this.pixels.data[offset + 2] = 0;\r\n    }\r\n\r\n    /* Transforms the 16 bit input into another seemingly psenduo random number\r\n     * in the same range. Every input 16 bit input will generate a different\r\n     * 16 bit output. This is called a Feistel network. */\r\n    private feistelNet(input: number) {\r\n        var l = input & 0xff;\r\n        var r = input >> 8;\r\n        for (var i = 0; i < 8; i++) {\r\n            var nl = r;\r\n            var F = (((r * 11) + (r >> 5) + 7 * 127) ^ r) & 0xff;\r\n            r = l ^ F;\r\n            l = nl;\r\n        }\r\n        return ((r << 8) | l) & 0xffff;\r\n    }\r\n\r\n    /* Called once every millisecond, sets 100 pixels. */\r\n    private update() {\r\n        /* Set 100 pixels per iteration otherwise it's too slow. */\r\n        for (let j = 0; j < 200; j++) {\r\n            if (this.frame == 65536) {\r\n                setTimeout(() => {\r\n                    this.reversed = true\r\n                    setTimeout(() => {\r\n                        this.frame = 0\r\n                        this.started = false\r\n                        this.reversed = false\r\n                        clearInterval(this.interval)\r\n                        this.interval = null\r\n                    }, 10000)\r\n                }, 2000)\r\n            }\r\n            var fn = this.feistelNet(this.frame);\r\n            var x = fn % this.canvas.width;\r\n            var y = Math.floor(fn / this.canvas.width);\r\n            if (x < this.canvas.width && y < this.canvas.height) {\r\n                if (this.reversed) {\r\n                    this.setPixelTransparent(x, y);\r\n                } else {\r\n                    this.setPixelRed(x, y);\r\n                }\r\n            }\r\n            this.frame++;\r\n        }\r\n        this.ctx.fillStyle = \"green\"\r\n        this.ctx.fillRect(0, 0, 100, 100)\r\n        this.ctx.putImageData(this.pixels, 0, 0);\r\n    }\r\n\r\n}","import Config from '../../Config';\r\nimport uiTexture from '../../../textures/ui.png'\r\nimport uiElements from '../../../textures/uiElements.png'\r\nimport startScreen from '../../../textures/startScreen.png'\r\nimport Menu from './Menu';\r\n\r\nimport audioSplash from \"../../../sounds/theme_splash.mp3\"\r\nimport audioMenu from \"../../../sounds/theme_menu.mp3\"\r\nimport audioLevel from \"../../../sounds/theme_level.mp3\"\r\nimport BetterAudio from '../../BetterAudio'\r\nimport LevelEnd from './LevelEnd';\r\nimport Weapons from './Weapons';\r\nimport LoadingScreen from './LoadingScreen';\r\nimport DeathScreen from './DeathScreen';\r\n\r\n\r\ntype FaceDirection = \"left\" | \"normal\" | \"right\"\r\ntype FaceState = \"normal\" | \"dead\" | \"win\"\r\ntype FaceAnimationStep = {\r\n    direction: FaceDirection,\r\n    duration: number,\r\n}\r\n\r\nexport default class UI {\r\n    static instance = new this\r\n    texture: HTMLImageElement\r\n    elements: HTMLImageElement\r\n    startScreen: HTMLImageElement\r\n    context: CanvasRenderingContext2D\r\n    weapons: Weapons\r\n    loadingScreen: LoadingScreen\r\n\r\n    audioSplash = new BetterAudio(audioSplash, Config.musicVolume)\r\n    audioMenu = new BetterAudio(audioMenu, Config.musicVolume)\r\n    audioLevel = new BetterAudio(audioLevel, Config.musicVolume)\r\n\r\n    floor: number = 1\r\n    score: number = 0\r\n    lives: number = 3\r\n    health: number = 100\r\n    ammo: number = 8\r\n    weapon: string = 'pistol'\r\n\r\n    faceDirection: FaceDirection = \"right\"\r\n    faceState: FaceState = \"normal\"\r\n    faceAnimationSteps: FaceAnimationStep[] = []\r\n    lastFaceAnimationStepsCount: number = null\r\n\r\n    showingMenu = true\r\n\r\n    state = 'startScreen'\r\n\r\n    menu: Menu\r\n    levelEnd: LevelEnd\r\n    deathScreen: DeathScreen\r\n\r\n    flashing = false\r\n    flashCompletion = 0\r\n    flashDuration = 0.2\r\n    flashColor: string\r\n    flashIntensity: number\r\n\r\n    startTime: Date\r\n    endTime: Date\r\n\r\n    enemiesKilled: number = 0\r\n    secretsFound: number = 0\r\n    treasuresFound: number = 0\r\n\r\n    enemiesCount: number\r\n    secretsCount: number\r\n    treasuresCount: number\r\n\r\n    constructor() {\r\n        this.menu = new Menu()\r\n        this.loadingScreen = new LoadingScreen()\r\n        this.levelEnd = new LevelEnd()\r\n        this.deathScreen = new DeathScreen()\r\n        this.audioSplash.loop()\r\n        this.audioMenu.loop()\r\n        this.audioLevel.loop()\r\n    }\r\n\r\n    init() {\r\n        this.texture = new Image();\r\n        this.texture.src = uiTexture;\r\n\r\n        this.elements = new Image();\r\n        this.elements.src = uiElements;\r\n\r\n        this.startScreen = new Image();\r\n        this.startScreen.src = startScreen;\r\n\r\n        const uiCanvas = document.getElementById(\"uiCanvas\") as HTMLCanvasElement\r\n        uiCanvas.width = 640 * Config.uiScale\r\n        uiCanvas.height = 400 * Config.uiScale\r\n\r\n        this.context = uiCanvas.getContext('2d') as CanvasRenderingContext2D\r\n        this.context.imageSmoothingEnabled = false;\r\n\r\n        document.onclick = e => { if (this.state == \"startScreen\") this.audioSplash.playIfNotPlayed() }\r\n        document.onkeydown = e => { if (this.state == \"startScreen\" && e.code == \"Space\") this.audioSplash.playIfNotPlayed() }\r\n        document.onkeyup = e => { if (this.state == \"startScreen\" && e.code == \"Space\") this.audioSplash.playIfNotPlayed() }\r\n        this.weapons = new Weapons()\r\n    }\r\n\r\n    takeLife() {\r\n        if (this.lives == 0) {\r\n            this.floor = 1\r\n            this.lives = 3\r\n        } else {\r\n            this.lives--\r\n        }\r\n        this.health = 100\r\n        this.ammo = 8\r\n        this.weapon = \"pistol\"\r\n        this.score = 0\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        this.weapons.update(deltaTime)\r\n        this.loadingScreen.update(deltaTime)\r\n        const currentStep = this.faceAnimationSteps[0]\r\n        if (currentStep) {\r\n            currentStep.duration -= deltaTime\r\n            if (currentStep.duration <= 0) {\r\n                this.faceAnimationSteps.shift()\r\n            }\r\n            if (this.faceAnimationSteps.length == 0) {\r\n                this.startFaceAnimation()\r\n            }\r\n            this.faceDirection = this.faceAnimationSteps[0].direction\r\n        }\r\n        if (!currentStep) {\r\n            this.startFaceAnimation()\r\n        }\r\n        this.menu.update(deltaTime)\r\n        this.levelEnd.update(deltaTime)\r\n        if (this.flashing) {\r\n            this.flashCompletion += deltaTime / this.flashDuration\r\n            if (this.flashCompletion >= 1) {\r\n                this.flashCompletion = 0\r\n                this.flashing = false\r\n            }\r\n        }\r\n    }\r\n\r\n    startFaceAnimation() {\r\n        const stepsCount = this.lastFaceAnimationStepsCount == 3 ? 5 : 3\r\n        for (let i = 0; i < stepsCount; i++) {\r\n            const min = 0.5\r\n            const max = 1.5\r\n            const duration = Math.random() * (max - min) + min;\r\n            let direction: FaceDirection\r\n            if (i % 2) {\r\n                direction = 'right'\r\n            } else {\r\n                direction = 'left'\r\n            }\r\n            this.faceAnimationSteps.push({ direction, duration })\r\n        }\r\n        this.lastFaceAnimationStepsCount = this.faceAnimationSteps.length\r\n        this.faceAnimationSteps.push({ direction: 'normal', duration: 2 })\r\n    }\r\n\r\n    draw(canvas: HTMLCanvasElement) {\r\n        this.context.clearRect(0, 0, this.context.canvas.width, this.context.canvas.height);\r\n        this.context.drawImage(canvas, 16 * Config.uiScale, 8 * Config.uiScale, 608 * Config.uiScale, 304 * Config.uiScale)\r\n        this.context.drawImage(this.texture, 0, 0, 640 * Config.uiScale, 400 * Config.uiScale)\r\n        this.drawNumber(this.floor, 64, 352)\r\n        this.drawNumber(this.score, 192, 352)\r\n        this.drawNumber(this.lives, 240, 352)\r\n        this.drawNumber(this.health, 384, 352)\r\n        this.drawNumber(this.ammo, 464, 352)\r\n        this.drawWeaponUI()\r\n        this.weapons.draw(this.context)\r\n        this.drawFace()\r\n        if (this.flashing) {\r\n            this.context.fillStyle = `rgba(${this.flashColor}, ${(1 - this.flashCompletion) * this.flashIntensity})`\r\n            // this.context.fillStyle = `rgba(${this.flashColor}, ${(1 - this.flashCompletion) * 0.6})`\r\n            this.context.fillRect(0, 0, this.context.canvas.width, this.context.canvas.height);\r\n        }\r\n        if (this.state == \"startScreen\") {\r\n            this.context.drawImage(this.startScreen, 0, 0, 640 * Config.uiScale, 400 * Config.uiScale)\r\n        } else if (this.state == \"menu\") {\r\n            this.context.drawImage(this.menu.canvas, 0, 0, 640 * Config.uiScale, 400 * Config.uiScale)\r\n        } else if (this.state == \"loading\") {\r\n            this.context.drawImage(this.loadingScreen.canvas, 0, 0, 640 * Config.uiScale, 400 * Config.uiScale)\r\n        } else if (this.state == \"end\") {\r\n            this.context.drawImage(this.levelEnd.canvas, 0, 0, 640 * Config.uiScale, 400 * Config.uiScale)\r\n        } else if (this.state == \"dead\") {\r\n            setTimeout(() => this.deathScreen.start(), 1500)\r\n        }\r\n        this.context.drawImage(this.deathScreen.canvas, 16 * Config.uiScale, 8 * Config.uiScale, 608 * Config.uiScale, 304 * Config.uiScale)\r\n    }\r\n\r\n    drawFace() {\r\n        let faceColumn = 0\r\n        let faceRow = 0\r\n        if (this.health == 0) {\r\n            faceRow = 7\r\n            faceColumn = 1\r\n        } else if (this.faceState == 'normal') {\r\n            if (this.faceDirection == 'left') {\r\n                faceColumn = 0\r\n            } else if (this.faceDirection == 'normal') {\r\n                faceColumn = 1\r\n            } else if (this.faceDirection == 'right') {\r\n                faceColumn = 2\r\n            }\r\n\r\n            faceRow = Math.floor(this.health / (100 / 7))\r\n            if (faceRow == 7) {\r\n                faceRow = 6\r\n            }\r\n            faceRow = 6 - faceRow\r\n        } else if (this.faceState == 'win') {\r\n            faceRow = 7\r\n            faceColumn = 0\r\n        }\r\n\r\n        this.context.drawImage(\r\n            this.elements,\r\n            240 + 24 * faceColumn,\r\n            31 * faceRow,\r\n            24,\r\n            31,\r\n            274 * Config.uiScale,\r\n            330 * Config.uiScale,\r\n            48 * Config.uiScale,\r\n            62 * Config.uiScale\r\n        )\r\n    }\r\n\r\n    drawWeaponUI() {\r\n        let weaponNumber = 0\r\n        if (this.weapon == 'knife') {\r\n            weaponNumber = 0\r\n        } else if (this.weapon == 'pistol') {\r\n            weaponNumber = 1\r\n        } else if (this.weapon == 'machinegun') {\r\n            weaponNumber = 2\r\n        } else if (this.weapon == 'chaingun') {\r\n            weaponNumber = 3\r\n        }\r\n        this.context.drawImage(\r\n            this.elements,\r\n            48 * weaponNumber,\r\n            0,\r\n            48,\r\n            24,\r\n            512 * Config.uiScale,\r\n            336 * Config.uiScale,\r\n            96 * Config.uiScale,\r\n            48 * Config.uiScale\r\n        )\r\n    }\r\n\r\n    private drawNumber(number: number, x: number, y: number) {\r\n        const digits = number.toString().split('').reverse().map(digit => parseInt(digit))\r\n        const digitWidth = 16\r\n        for (let [i, digit] of digits.entries()) {\r\n            this.drawDigit(digit, x - digitWidth * (i + 1), y)\r\n        }\r\n    }\r\n\r\n    private drawDigit(digit: number, x: number, y: number) {\r\n        this.context.drawImage(\r\n            this.elements,\r\n            8 * digit,\r\n            32,\r\n            8,\r\n            16,\r\n            x * Config.uiScale,\r\n            y * Config.uiScale,\r\n            16 * Config.uiScale,\r\n            32 * Config.uiScale\r\n        )\r\n    }\r\n\r\n    flashRed() {\r\n        this.flashColor = \"255, 0, 0\"\r\n        this.flashIntensity = 0.3\r\n        this.flashing = true\r\n    }\r\n\r\n    flashYellow() {\r\n        this.flashColor = \"255, 255, 0\"\r\n        this.flashIntensity = 0.2\r\n        this.flashing = true\r\n    }\r\n}","import Config from './Config'\r\nimport UI from './shapes/ui/UI'\r\nimport { Vec3 } from './utils'\r\n\r\nexport default class Input {\r\n    static instance = new this\r\n\r\n    direction = Vec3.zero\r\n    rotation = 0\r\n\r\n    sprinting = false\r\n    shooting = false\r\n    shot = false\r\n    justShot = true\r\n\r\n    interacting = false\r\n    justInteracted = false\r\n\r\n    noclip = false\r\n\r\n    renderWalls = true\r\n    justChangedRenderWalls = false\r\n\r\n    lastNumber: number = null\r\n\r\n    private pressedKeys: string[] = []\r\n\r\n    constructor() {\r\n        this.addKeyUpListener()\r\n        this.addKeyDownListener()\r\n        this.addAdditionalListeners()\r\n    }\r\n\r\n    get inputsBlocked() {\r\n        // return !UI.instance.health || UI.instance.showingMenu\r\n        return UI.instance.state != \"game\"\r\n    }\r\n\r\n    update() {\r\n        this.direction = Vec3.zero\r\n\r\n        this.rotation = 0\r\n\r\n        this.shooting = false\r\n\r\n        this.shot = false\r\n\r\n        this.interacting = false\r\n\r\n        this.noclip = false\r\n\r\n        this.sprinting = false\r\n\r\n        this.lastNumber = null\r\n\r\n        // console.log(this.inputsBlocked)\r\n        if (!this.inputsBlocked) {\r\n            if ((this.isPressed('ArrowUp') || this.isPressed('KeyW')) && !this.isPressed('KeyS') && !this.isPressed('ArrowDown')) this.direction.z = 1\r\n            if ((this.isPressed('ArrowDown') || this.isPressed('KeyS')) && !this.isPressed('KeyW') && !this.isPressed('ArrowUp')) this.direction.z = -1\r\n            // if (this.isPressed('KeyA') && !this.isPressed('KeyD')) this.direction.x = 1\r\n            // if (this.isPressed('KeyD') && !this.isPressed('KeyA')) this.direction.x = -1\r\n            this.direction = this.direction.normalize\r\n\r\n            if ((this.isPressed('KeyA') || this.isPressed('ArrowLeft')) && !this.isPressed('ArrowRight') && !this.isPressed('KeyD')) this.rotation = -1\r\n            if ((this.isPressed('KeyD') || this.isPressed('ArrowRight')) && !this.isPressed('ArrowLeft') && !this.isPressed('KeyA')) this.rotation = 1\r\n\r\n            if (this.isPressed('Space')) this.shooting = true\r\n\r\n            if (this.isPressed('Space')) {\r\n                if (!this.justShot) {\r\n                    this.shot = true\r\n                }\r\n            } else {\r\n                this.justShot = false\r\n            }\r\n\r\n            if (this.isPressed('KeyE')) {\r\n                if (!this.justInteracted) {\r\n                    this.interacting = true\r\n                }\r\n            } else {\r\n                this.justInteracted = false\r\n            }\r\n\r\n            if (Config.debug) {\r\n                if (this.isPressed('KeyC')) {\r\n                    this.noclip = true\r\n                }\r\n                if (this.isPressed('ShiftLeft')) {\r\n                    this.sprinting = true\r\n                }\r\n            }\r\n\r\n            if (this.isPressed('Digit0')) this.lastNumber = 0\r\n            if (this.isPressed('Digit1')) this.lastNumber = 1\r\n            if (this.isPressed('Digit2')) this.lastNumber = 2\r\n            if (this.isPressed('Digit3')) this.lastNumber = 3\r\n            if (this.isPressed('Digit4')) this.lastNumber = 4\r\n            if (this.isPressed('Digit5')) this.lastNumber = 5\r\n            if (this.isPressed('Digit6')) this.lastNumber = 6\r\n            if (this.isPressed('Digit7')) this.lastNumber = 7\r\n            if (this.isPressed('Digit8')) this.lastNumber = 8\r\n            if (this.isPressed('Digit9')) this.lastNumber = 9\r\n        }\r\n    }\r\n\r\n    private isPressed(key: string) {\r\n        return this.pressedKeys.includes(key)\r\n    }\r\n\r\n    private addKeyUpListener() {\r\n        addEventListener('keyup', e => {\r\n            if (this.pressedKeys.includes(e.code)) {\r\n                this.pressedKeys = this.pressedKeys.filter(key => key != e.code)\r\n            }\r\n        })\r\n    }\r\n\r\n    private addKeyDownListener() {\r\n        addEventListener('keydown', e => {\r\n            if (!this.pressedKeys.includes(e.code)) {\r\n                this.pressedKeys.push(e.code)\r\n            }\r\n        })\r\n    }\r\n\r\n    private addAdditionalListeners() {\r\n        addEventListener('keydown', e => {\r\n            if (e.code == \"Minus\") {\r\n                Config.uiScale -= 0.1\r\n            } else if (e.code == \"Equal\") {\r\n                Config.uiScale += 0.1\r\n            } else if (e.code == \"Backspace\") {\r\n                Config.uiScale = 1\r\n            } else if (e.code == \"KeyV\" && Config.debug) {\r\n                this.renderWalls = !this.renderWalls\r\n            } else if (e.code == 'Space' || e.code == \"Enter\") {\r\n                if (UI.instance.state == \"startScreen\") {\r\n                    UI.instance.state = \"menu\"\r\n                    UI.instance.audioSplash.pause()\r\n                    UI.instance.audioMenu.play()\r\n                } else if (UI.instance.state == \"menu\") {\r\n                    if (UI.instance.menu.option == 0) {\r\n                        UI.instance.menu.audioSelect.play()\r\n                        UI.instance.audioLevel.play()\r\n                        UI.instance.audioMenu.pause()\r\n                        UI.instance.state = \"loading\"\r\n                        // UI.instance.state = \"game\"\r\n                    } else if (UI.instance.menu.option == 8) {\r\n                        UI.instance.menu.audioSelect.play()\r\n                        UI.instance.audioMenu.pause()\r\n                        UI.instance.audioSplash.play()\r\n                        UI.instance.state = \"startScreen\"\r\n                    }\r\n                }\r\n            } else if (e.code == \"Escape\") {\r\n                if (UI.instance.state == \"menu\") {\r\n                    UI.instance.menu.audioBack.play()\r\n                    UI.instance.audioMenu.pause()\r\n                    UI.instance.audioSplash.play()\r\n                    UI.instance.state = \"startScreen\"\r\n                }\r\n            }\r\n        })\r\n    }\r\n}","import { Vec3, Transform, radToDeg, m4, degToRad, log, Vec2 } from './utils'\r\nimport Shape from './shapes/level/Shape'\r\nimport Interactable from './shapes/level/Interactable'\r\nimport Enemy from './shapes/level/Enemy'\r\nimport Door from './shapes/level/Door'\r\nimport Config from './Config'\r\nimport Weapons from './shapes/ui/Weapons'\r\nimport { Program } from './programs/Program'\r\nimport Input from './Input'\r\nimport BetterAudio from './BetterAudio'\r\nimport audioHit from '../sounds/WSND0014.wav'\r\nimport audioDeath from '../sounds/DSDEATH.wav'\r\n\r\nexport default class Camera {\r\n    transform = new Transform\r\n    initialTransform: Transform\r\n    projectionMatrix: number[]\r\n    collidingShapes: Shape[]\r\n    killer: Enemy = null\r\n\r\n    audioHit = new BetterAudio(audioHit)\r\n    audioDeath = new BetterAudio(audioDeath)\r\n    readonly weapons: Weapons\r\n    private readonly fov = 60\r\n    private readonly zNear = Config.gridSize / 64\r\n    private readonly zFar = Config.gridSize * 48\r\n    private readonly rotationSpeed = 1.6\r\n    private readonly movementSpeed = Config.gridSize * 5\r\n    private readonly collisionRadius = Config.gridSize / 3\r\n    private readonly interactionDistance = Config.gridSize * 1.5\r\n    private readonly gl: WebGLRenderingContext\r\n\r\n    private blockedDirections: Vec3[] = []\r\n\r\n    constructor(gl: WebGLRenderingContext, program: Program) {\r\n        this.gl = gl\r\n        this.updateProjectionMatrix()\r\n        this.transform.rotation.y = degToRad(90)\r\n    }\r\n\r\n    get matrix() {\r\n        let cameraMatrix = m4.identity\r\n        cameraMatrix = m4.translate(cameraMatrix, this.transform.position.inverted)\r\n        cameraMatrix = m4.yRotate(cameraMatrix, this.transform.rotation.y)\r\n        return cameraMatrix\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        this.rotate(Input.instance.rotation * deltaTime)\r\n        let speed = Input.instance.direction.multiply(deltaTime)\r\n        if (Input.instance.sprinting) {\r\n            speed = speed.multiply(5)\r\n        }\r\n        if (Input.instance.noclip) {\r\n            this.move(speed)\r\n        } else {\r\n            this.move(speed, this.collidingShapes)\r\n        }\r\n    }\r\n\r\n    nearest(shapes: Shape[]) {\r\n        const sorted = shapes.sort((a, b) => {\r\n            return (\r\n                a.initialTransform.position.distanceTo(this.transform.position) -\r\n                b.initialTransform.position.distanceTo(this.transform.position)\r\n            )\r\n        })\r\n        return sorted[0]\r\n    }\r\n\r\n    inInteractionDistance(shape: Interactable) {\r\n        return shape.initialTransform.position.distanceTo(this.transform.position) <= this.interactionDistance\r\n    }\r\n\r\n    rotate(rotation: number) {\r\n        this.transform.rotation.y += rotation * this.rotationSpeed\r\n    }\r\n\r\n    move(direction: Vec3, collidingShapes?: Shape[]) {\r\n        const transformMatrix = m4.yRotation(-this.transform.rotation.y)\r\n        let deltaPosition = direction.inverted.multiply(this.movementSpeed).transformMat4(transformMatrix)\r\n\r\n        for (let blockedDirection of this.blockedDirections) {\r\n            // corner shorter side selection\r\n            if (blockedDirection.x && blockedDirection.z) {\r\n                if (Math.abs(blockedDirection.x) > Math.abs(blockedDirection.z)) {\r\n                    blockedDirection.x = 0\r\n                } else {\r\n                    blockedDirection.z = 0\r\n                }\r\n            }\r\n\r\n            // different sign\r\n            if (blockedDirection.z * deltaPosition.z < 0) deltaPosition.z = 0\r\n            if (blockedDirection.x * deltaPosition.x < 0) deltaPosition.x = 0\r\n        }\r\n\r\n        if (collidingShapes) {\r\n            this.checkCollisions(collidingShapes.filter(c => c.transform.position.distanceTo(this.transform.position) < Config.gridSize * 2))\r\n        } else {\r\n            this.blockedDirections = []\r\n        }\r\n\r\n        this.transform.position = this.transform.position.add(deltaPosition)\r\n    }\r\n\r\n    angleTo(targetPosition: Vec3) {\r\n        let toTargetDir = targetPosition.substract(this.transform.position).yZeroed.normalize\r\n        let lookingAtDir = Vec3.fromAngle(this.transform.rotation.y)\r\n        let toTargetAngle = Math.atan2(toTargetDir.z, toTargetDir.x)\r\n        let lookingAtAngle = Math.atan2(lookingAtDir.z, lookingAtDir.x)\r\n        let angleDiff = radToDeg(lookingAtAngle - toTargetAngle)\r\n        if (angleDiff > 180) angleDiff -= 360\r\n        if (angleDiff < -180) angleDiff += 360\r\n        return angleDiff\r\n    }\r\n\r\n    cuboidCollisionSide(cuboid: Shape) {\r\n        const cameraToWall = this.transform.position.yZeroed.to(cuboid.transform.position.yZeroed)\r\n        const cameraToWallDirection = cameraToWall.normalize\r\n\r\n        let steps = 1\r\n        if (cuboid instanceof Door) {\r\n            steps = 10\r\n        }\r\n\r\n        let collisionCandidates = [this.transform.position]\r\n        for (let i = this.collisionRadius; i > 0; i -= this.collisionRadius / steps) {\r\n            const currentRadius = i\r\n            const collidingPointTranslation = cameraToWallDirection.multiply(currentRadius)\r\n            const collidingPoint = this.transform.position.add(collidingPointTranslation)\r\n            collisionCandidates.push(collidingPoint)\r\n        }\r\n        for (let candidate of collisionCandidates) {\r\n            if (cuboid.bb.isColliding(candidate)) {\r\n                let collisionSide = cuboid.bb.nearestDistanceDirection(this.transform.position)\r\n                if (collisionSide.x && collisionSide.z) {\r\n                    const nearestCorner = cuboid.bb.nearestCorner(candidate)\r\n                    const nearestCornerDiff = this.transform.position.substract(nearestCorner).abs\r\n                    if (nearestCornerDiff.x > nearestCornerDiff.z) {\r\n                        collisionSide.z = 0\r\n                    } else {\r\n                        collisionSide.x = 0\r\n                    }\r\n                }\r\n                // log('col side', collisionSide)\r\n\r\n                // this.transform.position = this.transform.position.add(collisionSide)\r\n                return collisionSide\r\n            }\r\n        }\r\n        return null\r\n    }\r\n\r\n    checkCollisions(shapes: Shape[]) {\r\n        const collidingSides = shapes\r\n            .map(c => this.cuboidCollisionSide(c))\r\n            .filter(side => side !== null)\r\n        // const blockedDirections = collidingSides.map(side => side.inverted)\r\n        const blockedDirections = collidingSides\r\n        const uniqueBlockedDirections = blockedDirections.filter((direction, index, self) =>\r\n            index === self.findIndex(d => d.equals(direction))\r\n        )\r\n        this.blockedDirections = uniqueBlockedDirections\r\n    }\r\n\r\n    isLookingAt(enemy: Enemy) {\r\n        const lookingAtDir = Vec3.fromAngle(this.transform.rotation.y)\r\n        const targetXDir = Vec3.up.cross(lookingAtDir).normalize\r\n\r\n        const enemyLeft = enemy.transform.position.add(targetXDir.multiply(enemy.texturedSize.x / 2))\r\n        const enemyRight = enemy.transform.position.substract(targetXDir.multiply(enemy.texturedSize.x / 2))\r\n\r\n        const angleLeft = this.angleTo(enemyLeft)\r\n        const angleRight = this.angleTo(enemyRight)\r\n\r\n        const lookingAtEnemy = 0 < angleLeft && angleLeft < 90 && -90 < angleRight && angleRight < 0\r\n\r\n        return lookingAtEnemy\r\n    }\r\n\r\n    get viewProjectionMatrix() {\r\n        return m4.multiply(this.matrix, this.projectionMatrix);\r\n    }\r\n\r\n    updateProjectionMatrix() {\r\n        const fieldOfViewRadians = degToRad(this.fov)\r\n        // const aspect = this.gl.canvas.clientWidth / this.gl.canvas.clientHeight\r\n        const aspect = 2\r\n        const zNear = this.zNear\r\n        const zFar = this.zFar\r\n        this.projectionMatrix = m4.perspective(fieldOfViewRadians, aspect, zNear, zFar);\r\n    }\r\n\r\n    lookAt(target: Vec3) {\r\n        let toTargetDir = target.substract(this.transform.position).yZeroed.normalize\r\n        let toTargetAngle = Math.atan2(toTargetDir.z, toTargetDir.x)\r\n        this.transform.rotation.y = toTargetAngle + degToRad(90)\r\n    }\r\n\r\n    lookAtKillerStep(deltaTime: number) {\r\n        const angle = this.angleTo(this.killer.transform.position)\r\n        if (Math.abs(angle) < Math.abs(radToDeg(this.rotationSpeed * deltaTime))) {\r\n            this.lookAt(this.killer.transform.position)\r\n        } else {\r\n            if (angle > 0) {\r\n                this.rotate(-1 * deltaTime)\r\n            } else if (angle < 0) {\r\n                this.rotate(1 * deltaTime)\r\n            }\r\n        }\r\n    }\r\n}","import Shape from \"./shapes/level/Shape\"\r\n\r\nexport default class Textures {\r\n    private readonly gl: WebGLRenderingContext\r\n\r\n    constructor(gl: WebGLRenderingContext) {\r\n        this.gl = gl\r\n    }\r\n\r\n    load(shapes: Shape[], callback?: () => void) {\r\n        let alreadyCreatedTextures: Map<string, WebGLTexture> = new Map()\r\n        const textures = [...new Set(shapes.map(shape => shape.importedTexture))]\r\n        this.loadHtmlImages(textures, textureToHtmlImageMap => {\r\n            for (let shape of shapes) {\r\n                if (!alreadyCreatedTextures.has(shape.importedTexture)) {\r\n                    const webglTexture = this.gl.createTexture()\r\n                    this.gl.bindTexture(this.gl.TEXTURE_2D, webglTexture)\r\n                    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.gl.NEAREST)\r\n                    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.NEAREST_MIPMAP_LINEAR)\r\n                    // this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.NEAREST)\r\n                    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.CLAMP_TO_EDGE)\r\n                    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.CLAMP_TO_EDGE)\r\n                    this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, this.gl.RGBA, this.gl.UNSIGNED_BYTE, textureToHtmlImageMap.get(shape.importedTexture))\r\n                    this.gl.generateMipmap(this.gl.TEXTURE_2D)\r\n                    alreadyCreatedTextures.set(shape.importedTexture, webglTexture)\r\n                }\r\n                shape.webglTexture = alreadyCreatedTextures.get(shape.importedTexture)\r\n            }\r\n            callback?.()\r\n        })\r\n    }\r\n\r\n    private loadHtmlImages(importedTextures: string[], callback: (map: Map<string, HTMLImageElement>) => void) {\r\n        let htmlImages: HTMLImageElement[] = []\r\n        let imagesToLoad = importedTextures.length\r\n\r\n        const onImageLoad = () => {\r\n            if (--imagesToLoad == 0) {\r\n                const map = new Map();\r\n                for (let i = 0; i < importedTextures.length; i++) {\r\n                    map.set(importedTextures[i], htmlImages[i]);\r\n                };\r\n                callback(map)\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < imagesToLoad; i++) {\r\n            const image = new Image()\r\n            image.src = importedTextures[i]\r\n            htmlImages.push(image)\r\n            image.onload = onImageLoad\r\n        }\r\n    }\r\n}","import { Vec2, Vec3 } from '../../utils'\r\nimport Cuboid from './Cuboid'\r\nimport texture from '../../../textures/wall.png'\r\nimport Config from '../../Config'\r\nimport { Program } from '../../programs/Program'\r\n\r\nexport default class Wall extends Cuboid {\r\n    importedTexture = texture\r\n    texturesInLine = 16\r\n\r\n    value: string\r\n\r\n    constructor(gl: WebGLRenderingContext, program: Program, value: string) {\r\n        super(gl, program)\r\n        this.value = value\r\n    }\r\n\r\n    nearDoorLightTexture = 106\r\n    nearDoorDarkTexture = 107\r\n\r\n    onCreation() {\r\n        this.transform.scale = Vec3.one.multiply(Config.gridSize)\r\n        this.setTexture(this.lightTexture)\r\n        this.setTexture(this.darkTexture, 2)\r\n        this.setTexture(this.darkTexture, 3)\r\n    }\r\n\r\n    get textureColor() {\r\n        for (let color of ['gray', 'blue', 'brown']) {\r\n            if (this.value.toLowerCase().includes(color)) {\r\n                return color\r\n            }\r\n        }\r\n        return 'gray'\r\n    }\r\n\r\n    get textureName() {\r\n        for (let lastLetter of ['F', 'E', 'H', 'B', 'S', 'E', 'H']) {\r\n            if (this.value.substr(-1) == lastLetter) {\r\n                return lastLetter\r\n            }\r\n        }\r\n        return null\r\n    }\r\n\r\n\r\n    get lightTexture(): number {\r\n        if (this.transform.rotation.y) {\r\n            return this._darkTexture\r\n        } else {\r\n            return this._lightTexture\r\n        }\r\n    }\r\n\r\n    get darkTexture() {\r\n        if (this.transform.rotation.y) {\r\n            return this._lightTexture\r\n        } else {\r\n            return this._darkTexture\r\n        }\r\n    }\r\n\r\n    private get _lightTexture() {\r\n        switch (this.value) {\r\n            case 'exitRailWall': return 100\r\n            case 'secretExitRailWall': return 122\r\n        }\r\n        switch (this.textureColor) {\r\n            case 'gray':\r\n                switch (this.textureName) {\r\n                    case 'F': return 4      //flag\r\n                    case 'H': return 16     //hitler\r\n                    case 'E': return 20     //eagle\r\n                    default: return 0\r\n                }\r\n            case 'blue':\r\n                switch (this.textureName) {\r\n                    case 'B': return 18    //bars\r\n                    case 'S': return 32     //skeleton bars\r\n                    default: return 34\r\n                }\r\n            case 'brown':\r\n                switch (this.textureName) {\r\n                    case 'E': return 48     //eagle\r\n                    case 'H': return 50     //hitler\r\n                    default: return 52\r\n                }\r\n        }\r\n    }\r\n\r\n    private get _darkTexture() {\r\n        switch (this.value) {\r\n            case 'exitRailWall': return this._lightTexture\r\n            case 'secretExitRailWall': return this._lightTexture\r\n            default: return this._lightTexture + 1\r\n        }\r\n    }\r\n}","export default [\r\n    'lamp',\r\n    'goldenLamp',\r\n    'puddle',\r\n    'bucket',\r\n    'skeleton',\r\n    'bones',\r\n    'bones1',\r\n    'bones2',\r\n    'bones3',\r\n    'bloodBones',\r\n    'enemy',\r\n    'enemyXWalking',\r\n    'enemyYWalking',\r\n    'enemyUp',\r\n    'enemyDown',\r\n    'enemyLeft',\r\n    'enemyRight',\r\n    'dogFood',\r\n    'food',\r\n    'health',\r\n    'ammo',\r\n    'powerUp',\r\n    'machinegun',\r\n    'chaingun',\r\n]","import { EvalDevToolModulePlugin } from \"webpack\"\r\nimport FieldData from \"../../common/FieldData\"\r\nimport NotCollidingFieldValues from \"../../common/NotCollidingFieldValues\"\r\nimport Config from \"./Config\"\r\nimport Level from \"./Level\"\r\nimport Shape from \"./shapes/level/Shape\"\r\nimport { log, Vec2, Vec3 } from \"./utils\"\r\n\r\nexport interface PathfinderFieldData {\r\n    subGridPos: Vec3\r\n    shape: string\r\n    realPos: Vec3\r\n}\r\n\r\nexport default class Pathfinder {\r\n    static instance = new this\r\n\r\n    private allSubFieldsCreated: PathField[] = []\r\n    private envFields: FieldData[] = []\r\n\r\n    private open: PathField[] = []\r\n    private closed: PathField[] = []\r\n\r\n    private readonly subdivisions = 3\r\n\r\n    get subGridSize() {\r\n        return Config.gridSize / this.subdivisions\r\n    }\r\n\r\n    prepareLevel(level: Level) {\r\n        this.envFields = level.gridFields\r\n        this.allSubFieldsCreated = []\r\n    }\r\n\r\n    private subFieldPosData(position: Vec2) {\r\n        const gridPos = this.subGridPosToGridPos(position)\r\n        const envField = this.envFields.find(f => new Vec2(f.x, f.y).equals(gridPos))\r\n        return {\r\n            walkable: !envField || NotCollidingFieldValues.includes(envField.value) || envField.value.toLowerCase().includes('door'),\r\n            shape: envField?.value\r\n        }\r\n    }\r\n\r\n    private subGridPosToGridPos(pos: Vec2) {\r\n        return pos.map(v => Math.floor(v / this.subdivisions))\r\n    }\r\n\r\n    private gridPosToRealPos(pos: Vec2) {\r\n        const realPosVec2 = pos.map(v => v * Config.gridSize + Config.gridSize / 2)\r\n        const gridPosVec3 = new Vec3(realPosVec2.x, 0, realPosVec2.y)\r\n        return gridPosVec3\r\n\r\n    }\r\n\r\n    private realPosToSubGridPos(v: Vec3) {\r\n        const gridPosVec3 = v.map(v => Math.floor(v / this.subGridSize))\r\n        const gridPosVec2 = new Vec2(gridPosVec3.x, gridPosVec3.z)\r\n        return gridPosVec2\r\n    }\r\n\r\n    getAllPathLocations(from: Vec3, to: Vec3) {\r\n        const subGridFrom = this.realPosToSubGridPos(from)\r\n        const subGridTo = this.realPosToSubGridPos(to)\r\n        const subGridPath = this._getAllPathfindLocations(subGridFrom, subGridTo)\r\n\r\n        const realPath: PathfinderFieldData[] = subGridPath.map(subGridField => {\r\n            return {\r\n                subGridPos: this.subGridPosToRealPos(subGridField.position),\r\n                shape: subGridField.shape,\r\n                realPos: this.gridPosToRealPos(this.subGridPosToGridPos(subGridField.position)),\r\n            }\r\n        })\r\n        return realPath\r\n    }\r\n\r\n    private subGridPosToRealPos(v: Vec2) {\r\n        const realPosVec2 = v.map(v => v * this.subGridSize + this.subGridSize / 2)\r\n        const gridPosVec3 = new Vec3(realPosVec2.x, 0, realPosVec2.y)\r\n        return gridPosVec3\r\n    }\r\n\r\n    private _getAllPathfindLocations(subGridFrom: Vec2, subGridTo: Vec2) {\r\n        this.open = []\r\n        this.closed = []\r\n\r\n        const startField = new PathField(subGridFrom, true)\r\n        this.open.push(startField)\r\n\r\n        const { walkable, shape } = this.subFieldPosData(subGridTo)\r\n        const endField = new PathField(subGridTo, walkable, shape)\r\n        if (!endField.walkable) {\r\n            return []\r\n        }\r\n\r\n        while (true) {\r\n            if (this.open.length == 0) {\r\n                return []\r\n            }\r\n            const current = this.leastFCostField()\r\n            if (current.position.equals(endField.position)) {\r\n                if (startField.position.equals(endField.position)) {\r\n                    return []\r\n                } else {\r\n                    return this.getPathUsingParents(current)\r\n                }\r\n            } else {\r\n                const validNeighbours = this.getValidNeighbours(current)\r\n                for (let neighbour of validNeighbours) {\r\n                    this.calculateCost(neighbour, current, endField)\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private leastFCostField() {\r\n        const current = this.open.reduce((acc, loc) => acc.fCost < loc.fCost ? acc : loc)\r\n        this.open = this.open.filter(field => field != current)\r\n        this.closed.push(current)\r\n        return current\r\n    }\r\n\r\n    private calculateCost(neighbour: PathField, current: PathField, endField: PathField) {\r\n        if (!this.open.includes(neighbour) || neighbour.gCostWithParent(current) < neighbour.gCost) {\r\n            neighbour.parent = current\r\n            const hDiff = endField.position.substract(neighbour.position).abs\r\n            neighbour.hCost = (hDiff.x + hDiff.y) * 10\r\n            if (this.open.every(f => !f.position.equals(neighbour.position))) {\r\n                this.open.push(neighbour)\r\n            }\r\n        }\r\n    }\r\n\r\n    private getValidNeighbours(field: PathField) {\r\n        const neighbourDiffs = [\r\n            new Vec2(-1, -1),\r\n            new Vec2(-1, 0),\r\n            new Vec2(-1, 1),\r\n            new Vec2(0, -1),\r\n            new Vec2(0, 1),\r\n            new Vec2(1, -1),\r\n            new Vec2(1, 0),\r\n            new Vec2(1, 1),\r\n        ]\r\n        const neighbours = neighbourDiffs.map(diff => {\r\n            const neighbourPos = field.position.add(diff)\r\n            const subFieldAlreadyCreated = this.allSubFieldsCreated.find(field => field.position.equals(neighbourPos))\r\n            if (subFieldAlreadyCreated) {\r\n                return subFieldAlreadyCreated\r\n            } else {\r\n                let { walkable, shape } = this.subFieldPosData(neighbourPos)\r\n                if (diff.x && diff.y && walkable) {\r\n                    const possibleCorners = [\r\n                        new Vec2(neighbourPos.x, field.position.y),\r\n                        new Vec2(field.position.x, neighbourPos.y),\r\n                    ]\r\n                    const allWalkable = possibleCorners.every(corner => {\r\n                        const { walkable, shape } = this.subFieldPosData(corner)\r\n                        return walkable\r\n                    })\r\n                    if (!allWalkable) {\r\n                        walkable = false\r\n                    }\r\n                }\r\n                const subField = new PathField(neighbourPos, walkable, shape)\r\n                this.allSubFieldsCreated.push(subField)\r\n                return subField\r\n            }\r\n        })\r\n        const validNeighbours = neighbours\r\n            .filter(f => f.walkable && !this.closed.includes(f))\r\n        // .filter(f => {\r\n        //     const diff = f.position.substract(field.position)\r\n        //     if (diff.x && diff.y) {\r\n        //         const possibleCorners = [\r\n        //             new Vec2(f.position.x, field.position.y),\r\n        //             new Vec2(field.position.x, f.position.y),\r\n        //         ]\r\n        //         return possibleCorners.every(pos => this.isSubFieldPosWalkable(pos))\r\n        //     }\r\n        // })\r\n        return validNeighbours\r\n    }\r\n\r\n    private getPathUsingParents(end: PathField) {\r\n        let path = []\r\n        path.push(end)\r\n        while (end.parent) {\r\n            end = end.parent\r\n            path.push(end)\r\n        }\r\n        path.reverse()\r\n        path.shift()\r\n        return path\r\n    }\r\n}\r\n\r\nclass PathField {\r\n    position: Vec2\r\n    walkable: boolean\r\n    shape: string\r\n\r\n    parent: PathField\r\n    hCost: number\r\n\r\n    get gCost(): number {\r\n        if (this.parent) {\r\n            return this.gCostWithParent(this.parent)\r\n        } else {\r\n            return 0\r\n        }\r\n    }\r\n\r\n    gCostWithParent(parent: PathField) {\r\n        const diff = parent.position.substract(this.position)\r\n        if (diff.x && diff.y) {\r\n            return parent.gCost + 14\r\n        } else {\r\n            return parent.gCost + 10\r\n        }\r\n    }\r\n\r\n    get fCost() {\r\n        return this.gCost + this.hCost\r\n    }\r\n\r\n    constructor(position: Vec2, walkable: boolean, shape?: string) {\r\n        this.position = position\r\n        this.walkable = walkable\r\n        this.shape = shape\r\n    }\r\n}","import Config from \"./Config\"\r\nimport Shape from \"./shapes/level/Shape\"\r\nimport { Vec3 } from \"./utils\"\r\n\r\nexport default class Raycaster {\r\n    from: Vec3\r\n    dir: Vec3\r\n    private squareGenerator: Generator<Vec3, void, unknown>\r\n\r\n    private constructor(from: Vec3, dir: Vec3) {\r\n        this.from = from.clone()\r\n        this.dir = dir.clone()\r\n        this.squareGenerator = this.nextSquareGenerator()\r\n    }\r\n\r\n    static fromDir(from: Vec3, dir: Vec3) {\r\n        return new Raycaster(from, dir)\r\n    }\r\n\r\n    static fromTo(from: Vec3, to: Vec3) {\r\n        const dir = to.substract(from).yZeroed.normalize\r\n        return new Raycaster(from, dir)\r\n    }\r\n\r\n    private nextSquare() {\r\n        return this.squareGenerator.next().value\r\n    }\r\n\r\n    nextShape(shapes: Shape[]) {\r\n        let nextSquare = this.nextSquare()\r\n        const limit = 100\r\n        for (let i = 0; i < limit * 2; i++) {\r\n            if (nextSquare) {\r\n                for (let shape of shapes) {\r\n                    if (shape.transform.position.yZeroed.equals(nextSquare.yZeroed)) {\r\n                        return shape\r\n                    }\r\n                }\r\n                nextSquare = this.nextSquare()\r\n            }\r\n        }\r\n        return null\r\n    }\r\n\r\n    private * nextSquareGenerator() {\r\n        let startClone = this.from.clone()\r\n        let dirClone = this.dir.clone()\r\n        const gridSize = Config.gridSize\r\n        const firstTileCenter = startClone.map(v => Math.floor(v / gridSize) * gridSize + gridSize / 2).yZeroed\r\n        yield firstTileCenter\r\n        let firstYield = true\r\n        while (true) {\r\n            const [nextTileCenter, nextIntersection] = this.nextSquareInner(startClone, dirClone)\r\n            if (firstYield) {\r\n                firstYield = false\r\n            }\r\n            yield nextTileCenter\r\n            startClone = nextIntersection\r\n        }\r\n    }\r\n\r\n    private nextSquareInner(start: Vec3, dir: Vec3) {\r\n        const gridSize = Config.gridSize\r\n        if (dir.x >= 0) {\r\n            start.x += gridSize * 0.0001\r\n        } else {\r\n            start.x -= gridSize * 0.0001\r\n        }\r\n        if (dir.z >= 0) {\r\n            start.z += gridSize * 0.0001\r\n        } else {\r\n            start.z -= gridSize * 0.0001\r\n        }\r\n        const firstTileCenter = start.map(v => Math.floor(v / gridSize) * gridSize + gridSize / 2).yZeroed\r\n        let nextIntersectingAxes = Vec3.zero\r\n        if (start.x * dir.x > 0) {\r\n            nextIntersectingAxes.x = Math.ceil(start.x / gridSize) * gridSize\r\n        } else {\r\n            nextIntersectingAxes.x = Math.floor(start.x / gridSize) * gridSize\r\n        }\r\n        if (start.z * dir.z > 0) {\r\n            nextIntersectingAxes.z = Math.ceil(start.z / gridSize) * gridSize\r\n        } else {\r\n            nextIntersectingAxes.z = Math.floor(start.z / gridSize) * gridSize\r\n        }\r\n        const diff = start.substract(nextIntersectingAxes).abs\r\n        const diffRatio = Math.abs(diff.z / diff.x)\r\n        const dirRatio = Math.abs(dir.z / dir.x)\r\n        let nextSquareInDirection, nextIntersection\r\n        if (diffRatio > dirRatio) {\r\n            nextSquareInDirection = new Vec3(1, 0, 0)\r\n            nextIntersection = new Vec3(\r\n                nextIntersectingAxes.x,\r\n                0,\r\n                start.z + (dir.z / dir.x) * (nextIntersectingAxes.x - start.x),\r\n            )\r\n        } else {\r\n            if (diffRatio < dirRatio) {\r\n                nextSquareInDirection = new Vec3(0, 0, 1)\r\n            } else {\r\n                nextSquareInDirection = new Vec3(1, 0, 1)\r\n            }\r\n            nextIntersection = new Vec3(\r\n                start.x + (dir.x / dir.z) * (nextIntersectingAxes.z - start.z),\r\n                0,\r\n                nextIntersectingAxes.z,\r\n            )\r\n        }\r\n        const nextSquare = new Vec3(\r\n            dir.x > 0 ? nextSquareInDirection.x : -nextSquareInDirection.x,\r\n            0,\r\n            dir.z > 0 ? nextSquareInDirection.z : -nextSquareInDirection.z,\r\n        )\r\n        const nextTileCenter = firstTileCenter.add(nextSquare.multiply(gridSize))\r\n        return [nextTileCenter, nextIntersection]\r\n    }\r\n}","import texture from '../../../textures/uvTest.png'\r\nimport { hexToRgb, Vec3 } from '../../utils'\r\nimport Shape from './Shape'\r\nimport Config from '../../Config'\r\nimport { Program } from '../../programs/Program'\r\n\r\nexport default class Plane extends Shape {\r\n    VERTICES = new Float32Array([\r\n        0.5, 0, 0.5,\r\n        -0.5, 0, -0.5,\r\n        -0.5, 0, 0.5,\r\n        0.5, 0, -0.5,\r\n        -0.5, 0, -0.5,\r\n        0.5, 0, 0.5,\r\n    ])\r\n\r\n    TEXCOORDS = new Float32Array([\r\n        1, 1,\r\n        0, 0,\r\n        0, 1,\r\n        1, 0,\r\n        0, 0,\r\n        1, 1,\r\n    ])\r\n\r\n    COLORS = new Uint8Array([\r\n        80, 70, 200,\r\n        80, 70, 200,\r\n        80, 70, 200,\r\n        80, 70, 200,\r\n        80, 70, 200,\r\n        80, 70, 200,\r\n    ])\r\n\r\n    importedTexture = texture\r\n\r\n    constructor(gl: WebGLRenderingContext, program: Program) {\r\n        super(gl, program)\r\n        this.transform.scale.set(Config.gridSize, 1, Config.gridSize)\r\n    }\r\n\r\n    setColor(color: string) {\r\n        let colors = Vec3.arrayToVec3Array(this.COLORS)\r\n        colors = colors.map(c => hexToRgb(color))\r\n        this.COLORS = new Uint8Array(Vec3.vec3ArrayToArray(colors))\r\n    }\r\n}","import texture from '../../../../textures/objects.png'\r\nimport AudioPlayer from '../../../BetterAudio'\r\nimport Camera from '../../../Camera'\r\nimport Config from '../../../Config'\r\nimport { Program } from '../../../programs/Program'\r\nimport { degToRad, Vec2, Vec3 } from '../../../utils'\r\nimport Plane from '../Plane'\r\nimport BetterAudio from '../../../BetterAudio'\r\nimport UI from '../../ui/UI'\r\n\r\nexport default abstract class Pickup extends Plane {\r\n    importedTexture = texture\r\n    abstract audio: BetterAudio\r\n\r\n    pickupRange = Config.gridSize * 0.5\r\n    pickedUp = false\r\n\r\n    private firstTextureSet = false\r\n    protected abstract textureNumber: number\r\n\r\n    onCreation() {\r\n        this.transform.scale = Vec3.one.multiply(Config.gridSize)\r\n        this.transform.rotation.x = degToRad(90)\r\n        this.setTexture(this.textureNumber)\r\n    }\r\n\r\n    lookAtCamera(cameraY: number) {\r\n        this.transform.rotation.y = -cameraY\r\n    }\r\n\r\n    private texturesInLine = 8\r\n\r\n    get textureSize() {\r\n        return 1 / this.texturesInLine\r\n    }\r\n\r\n    canBePickedUp(camera: Camera) {\r\n        return true\r\n    }\r\n\r\n    pickUp(camera: Camera) {\r\n        if (!this.pickedUp && this.canBePickedUp(camera)) {\r\n            this.onPickedUp(camera)\r\n            this.audio.play()\r\n            UI.instance.flashYellow()\r\n            this.pickedUp = true\r\n        }\r\n    }\r\n\r\n    onPickedUp(camera: Camera) { }\r\n\r\n    setTexture(textureNumber: number) {\r\n        if (textureNumber == this.textureNumber && this.firstTextureSet) return\r\n        this.textureNumber = textureNumber\r\n        let verticesVec2Array = Vec2.arrayToVec2Array(this.initialTexcoords)\r\n        const texturePos = new Vec2(textureNumber % this.texturesInLine, Math.floor(textureNumber / this.texturesInLine)).multiply(this.textureSize)\r\n        verticesVec2Array = verticesVec2Array.map(vertex => vertex.multiply(this.textureSize).add(texturePos))\r\n        this.TEXCOORDS = new Float32Array(Vec2.vec2ArrayToArray(verticesVec2Array))\r\n        if (!this.firstTextureSet) {\r\n            this.firstTextureSet = true\r\n            this.updateBuffers()\r\n        }\r\n    }\r\n}","import Camera from '../../../Camera'\r\nimport { degToRad, Vec2, Vec3 } from '../../../utils'\r\nimport UI from '../../ui/UI'\r\nimport Pickup from './Pickup'\r\nimport audio from \"../../../../sounds/P_AMMO.wav\"\r\nimport BetterAudio from '../../../BetterAudio'\r\n\r\nexport default class Ammo extends Pickup {\r\n    textureNumber = 43\r\n    ammoCount = 4\r\n    audio = new BetterAudio(audio)\r\n\r\n    onPickedUp(camera: Camera) {\r\n        UI.instance.ammo += this.ammoCount\r\n        if (UI.instance.weapon == 'knife') {\r\n            UI.instance.weapon = UI.instance.weapons.availableTypes[UI.instance.weapons.availableTypes.length - 1]\r\n        }\r\n    }\r\n}","import Camera from '../../../Camera'\r\nimport Config from '../../../Config'\r\nimport { degToRad, Vec2, Vec3 } from '../../../utils'\r\nimport Pickup from './Pickup'\r\nimport audio from \"../../../../sounds/P_AMMO.wav\"\r\nimport BetterAudio from '../../../BetterAudio'\r\n\r\nexport default class Flag extends Pickup {\r\n    textureNumber = 6\r\n    audio = new BetterAudio(audio)\r\n    onCreation() {\r\n        super.onCreation()\r\n        const scale = 0.5\r\n        this.transform.scale = this.transform.scale.multiply(scale)\r\n        this.transform.position.y = -50\r\n    }\r\n\r\n    onPickedUp(camera: Camera) {\r\n    }\r\n}","import FieldData from '../../../../common/FieldData'\r\nimport texture from '../../../textures/guard.png'\r\nimport BetterAudio from '../../BetterAudio'\r\nimport Camera from '../../Camera'\r\nimport Config from '../../Config'\r\nimport Pathfinder from '../../Pathfinder'\r\nimport { PathfinderFieldData } from '../../Pathfinder'\r\nimport { Program } from '../../programs/Program'\r\nimport Raycaster from '../../Raycaster'\r\nimport { degToRad, log, radToDeg, Vec2, Vec3 } from '../../utils'\r\nimport UI from '../ui/UI'\r\nimport Door from './Door'\r\nimport Ammo from './pickups/Ammo'\r\nimport Flag from './pickups/Flag'\r\nimport Plane from './Plane'\r\nimport Shape from './Shape'\r\nimport audioShot from \"../../../sounds/WSND0021.wav\"\r\n\r\nimport audioDie1 from \"../../../sounds/WSND0012.wav\"\r\nimport audioDie2 from \"../../../sounds/WSND0013.wav\"\r\nimport audioDie4 from \"../../../sounds/WSND0034.wav\"\r\nimport audioDie5 from \"../../../sounds/WSND0035.wav\"\r\nimport audioDie6 from \"../../../sounds/WSND0039.wav\"\r\nimport audioDie7 from \"../../../sounds/WSND0040.wav\"\r\nimport audioDie8 from \"../../../sounds/WSND0041.wav\"\r\nimport audioDie9 from \"../../../sounds/WSND0042.wav\"\r\nimport audioSight from \"../../../sounds/WSND0000.wav\"\r\n\r\nexport default class Enemy extends Plane {\r\n    loot: Ammo\r\n    tempFlag: Flag\r\n    pathfinderFields: PathfinderFieldData[] = []\r\n    score = 100\r\n    followingPlayer: Camera\r\n    importedTexture = texture\r\n    texturedWidth = 28 / 64\r\n\r\n    private textureRotation = 0\r\n    private texturesInLine = 8\r\n    private textureNumber: number\r\n    private readonly stateToTextureMap = new Map([\r\n        ['shooting', [48, 49, 50]],\r\n        ['standing', [0]],\r\n        ['walking', [8, 16, 24, 32]],\r\n        ['dying', [40, 41, 42, 43, 44]],\r\n        ['hit', [47, 0]],\r\n        ['dead', [44]],\r\n    ])\r\n\r\n    shotNoticeDistance = Config.gridSize * 10\r\n    private dir = Vec3.zero\r\n    private shootingDistance = Config.gridSize * 5\r\n    private damageDealed = 8\r\n    private walkingDirection = Vec3.zero\r\n    state = 'standing'\r\n    private timeSinceLastUpdate = 0\r\n    private hp = 100\r\n    private followingSpeed = Config.gridSize * 1.25\r\n    private nextDir: Vec3 = null\r\n    private timeSinceLastPathfinding = 0\r\n    private readonly initialState\r\n    private readonly pathfindingDelay = 0.5\r\n    private readonly frameTime = 0.2\r\n    readonly audioSight = new BetterAudio(audioSight)\r\n    private readonly audiosDie = [\r\n        new BetterAudio(audioDie1),\r\n        new BetterAudio(audioDie2),\r\n        new BetterAudio(audioDie4),\r\n        new BetterAudio(audioDie5),\r\n        new BetterAudio(audioDie6),\r\n        new BetterAudio(audioDie7),\r\n        new BetterAudio(audioDie8),\r\n        new BetterAudio(audioDie9),\r\n    ]\r\n    private readonly audioShot = new BetterAudio(audioShot)\r\n\r\n    constructor(gl: WebGLRenderingContext, program: Program, type?: string) {\r\n        super(gl, program)\r\n        this.loot = new Ammo(this.gl, program)\r\n        this.tempFlag = new Flag(this.gl, program)\r\n        this.tempFlag.setInitialState()\r\n        this.transform.rotation.x = degToRad(90)\r\n        if (type == \"x\") {\r\n            this.walkingDirection = Vec3.right\r\n            this.state = \"walking\"\r\n            this.dir = this.walkingDirection\r\n        } else if (type == \"z\") {\r\n            this.walkingDirection = Vec3.forward\r\n            this.state = \"walking\"\r\n            this.dir = this.walkingDirection\r\n        } else if (type == \"up\") {\r\n            this.dir = Vec3.forward\r\n        } else if (type == \"down\") {\r\n            this.dir = Vec3.backward\r\n        } else if (type == \"left\") {\r\n            this.dir = Vec3.left\r\n        } else if (type == \"right\") {\r\n            this.dir = Vec3.right\r\n        }\r\n        this.initialState = this.state\r\n    }\r\n\r\n    get isDead() {\r\n        return this.hp <= 0\r\n    }\r\n\r\n    update(deltaTime: number, camera: Camera) {\r\n        if (UI.instance.state == 'end') {\r\n            this.followingPlayer = null\r\n        } else {\r\n            this.timeSinceLastUpdate += deltaTime\r\n            const frameTime = this.state == \"shooting\" ? 0.3 : this.frameTime\r\n            if (this.timeSinceLastUpdate > frameTime) {\r\n                this.timeSinceLastUpdate = 0\r\n                const textures = this.stateToTextureMap.get(this.state)\r\n                const index = textures.indexOf(this.textureNumber) + 1\r\n                if (index < textures.length) {\r\n                    this.setTexture(textures[index])\r\n                } else {\r\n                    this.textureNumber = 0\r\n                    if (this.state == 'dying') {\r\n                        this.state = 'dead'\r\n                        UI.instance.enemiesKilled++\r\n                    } else if (this.state == 'hit') {\r\n                        this.state = 'walking'\r\n                    } else {\r\n                        this.setTexture(textures[0])\r\n                    }\r\n                }\r\n                if (this.state == \"shooting\" && index == textures.length - 1) {\r\n                    if (UI.instance.health > 0) {\r\n                        UI.instance.health -= Math.floor(Math.random() * (this.damageDealed * 2 - this.damageDealed * 0.75)) + this.damageDealed * 0.75\r\n                        UI.instance.flashRed()\r\n                        this.audioShot.play()\r\n                        camera.audioHit.play()\r\n                        if (UI.instance.health <= 0) {\r\n                            UI.instance.health = 0\r\n                            camera.killer = this\r\n                        }\r\n                    }\r\n                }\r\n                if (this.followingPlayer && UI.instance.health == 0) {\r\n                    this.followingPlayer = null\r\n                    this.dir = this.transform.position.to(camera.transform.position)\r\n                    this.state = \"standing\"\r\n                }\r\n            }\r\n            this.updateBuffers()\r\n        }\r\n    }\r\n\r\n    damage(value: number) {\r\n        if (['dying', 'dead'].includes(this.state)) return\r\n        this.hp -= value\r\n        this.state = 'hit'\r\n        this.timeSinceLastUpdate = 0\r\n        if (this.hp <= 0) {\r\n            this.hp = 0\r\n            this.state = 'dying'\r\n            this.audiosDie[Math.floor(Math.random() * this.audiosDie.length)].play()\r\n        } else {\r\n            // this.audioPain.play()\r\n        }\r\n    }\r\n\r\n    lookAtCamera(cameraY: number) {\r\n        this.transform.rotation.y = -cameraY\r\n    }\r\n\r\n    pathfind(destination: Vec3) {\r\n\r\n    }\r\n\r\n    makeStepTowardsPlayer(deltaTime: number, doors: Door[]) {\r\n        this.timeSinceLastPathfinding += deltaTime\r\n        if (this.followingPlayer) {\r\n            if (this.timeSinceLastPathfinding >= this.pathfindingDelay) {\r\n                this.timeSinceLastPathfinding = 0\r\n                if (this.pathfinderFields.length <= 80) {\r\n                    this.pathfinderFields = Pathfinder.instance.getAllPathLocations(this.transform.position, this.followingPlayer.transform.position)\r\n                    this.pathfinderFields = this.pathfinderFields.map(v => {\r\n                        return {\r\n                            subGridPos: new Vec3(v.subGridPos.x, -30, v.subGridPos.z),\r\n                            shape: v.shape,\r\n                            realPos: v.realPos,\r\n                        }\r\n                    })\r\n                } else {\r\n                    this.state = \"standing\"\r\n                    this.followingPlayer = null\r\n                    this.pathfinderFields = []\r\n                }\r\n            }\r\n            if (this.pathfinderFields.length <= 1) return\r\n            this.dir = this.pathfinderFields[1].subGridPos.substract(this.transform.position).yZeroed.normalize\r\n            for (let i = 1; i < 3; i++) {\r\n                const futureField = this.pathfinderFields[i]\r\n                if (futureField && futureField.shape == \"door\") {\r\n                    const door = doors.find(d => d.initialTransform.position.yZeroed.equals(futureField.realPos.yZeroed))\r\n                    if (door) {\r\n                        if (door.canInteract) {\r\n                            door.toggle()\r\n                        }\r\n                    }\r\n                    break\r\n                }\r\n            }\r\n            this.transform.position = this.transform.position.add(this.dir.multiply(this.followingSpeed * deltaTime))\r\n            // this.followingPlayer = null\r\n        }\r\n    }\r\n\r\n    makeStepIfWalking(deltaTime: number, shapes: Shape[]) {\r\n        if (!this.followingPlayer && this.initialState == \"walking\" && this.state == \"walking\") {\r\n            const raycaster = Raycaster.fromDir(this.transform.position, this.dir)\r\n            const nextShape = raycaster.nextShape(shapes)\r\n            if (nextShape) {\r\n                const distance = this.transform.position.distanceTo(nextShape.transform.position)\r\n                if (distance <= Config.gridSize && !this.nextDir) {\r\n                    this.nextDir = this.dir.inverted\r\n                    this.state = \"standing\"\r\n                    setTimeout(() => {\r\n                        this.dir = this.nextDir\r\n                        setTimeout(() => {\r\n                            this.state = \"walking\"\r\n                            this.nextDir = null\r\n                        }, 500)\r\n                    }, 1000)\r\n                }\r\n                this.transform.position = this.transform.position.add(this.dir.multiply(this.followingSpeed * deltaTime))\r\n            }\r\n        }\r\n    }\r\n\r\n    rotateTexture(targetPosition: Vec3) {\r\n        let toTargetDir = targetPosition.substract(this.transform.position).yZeroed.normalize\r\n        let toTargetAngle = Math.atan2(toTargetDir.z, toTargetDir.x)\r\n        let walkingAngle = Math.atan2(this.dir.z, this.dir.x)\r\n        let angleDiff = radToDeg(walkingAngle - toTargetAngle)\r\n        if (angleDiff > 180) angleDiff -= 360\r\n        if (angleDiff < -180) angleDiff += 360\r\n        const correctedDiff = angleDiff > 0 ? angleDiff + 22.5 : angleDiff - 22.5\r\n        this.textureRotation = parseInt((correctedDiff / 45).toString())\r\n        return angleDiff\r\n    }\r\n\r\n    canSee(target: Vec3, shapes: Shape[]) {\r\n        const raycaster = Raycaster.fromTo(this.transform.position, target.yZeroed)\r\n        const nextShape = raycaster.nextShape(shapes)\r\n        if (!nextShape) return false\r\n        return nextShape.transform.position.yZeroed.distanceTo(this.transform.position.yZeroed) > this.transform.position.yZeroed.distanceTo(target.yZeroed)\r\n    }\r\n\r\n    tryToShoot(camera: Camera, shapes: Shape[]) {\r\n        if (this.state == 'dead' || this.state == \"dying\" || this.state == \"hit\" || !this.followingPlayer) return false\r\n        if (UI.instance.health > 0) {\r\n            if (\r\n                this.transform.position.distanceTo(camera.transform.position) <= this.shootingDistance\r\n                && this.canSee(camera.transform.position, shapes)\r\n            ) {\r\n                this.state = \"shooting\"\r\n                return true\r\n            } else {\r\n                this.state = \"walking\"\r\n                return false\r\n            }\r\n            // this.state = 'walking'\r\n        } else {\r\n            this.state = 'standing'\r\n            this.followingPlayer = null\r\n        }\r\n        return false\r\n    }\r\n\r\n    private get textureSize() {\r\n        return 1 / this.texturesInLine\r\n    }\r\n\r\n    private setTexture(textureNumber: number) {\r\n        // if (textureNumber == this.textureNumber) {\r\n        //     console.log('olewam', textureNumber)\r\n        //     return\r\n\r\n        // }\r\n        this.textureNumber = textureNumber\r\n\r\n        if (this.state == 'walking' || this.state == 'standing') {\r\n            if (this.textureRotation >= 0) {\r\n                textureNumber += this.textureRotation\r\n            } else {\r\n                textureNumber += this.textureRotation + this.texturesInLine\r\n            }\r\n        }\r\n\r\n        let verticesVec2Array = Vec2.arrayToVec2Array(this.initialTexcoords)\r\n        const texturePos = new Vec2(textureNumber % this.texturesInLine, Math.floor(textureNumber / this.texturesInLine)).multiply(this.textureSize)\r\n        verticesVec2Array = verticesVec2Array.map(vertex => vertex.multiply(this.textureSize).add(texturePos))\r\n        this.TEXCOORDS = new Float32Array(Vec2.vec2ArrayToArray(verticesVec2Array))\r\n    }\r\n}","import BetterAudio from '../../../BetterAudio'\r\nimport Camera from '../../../Camera'\r\nimport { degToRad, Vec2, Vec3 } from '../../../utils'\r\nimport UI from '../../ui/UI'\r\nimport Pickup from './Pickup'\r\n\r\nexport default abstract class HealthItem extends Pickup {\r\n    abstract healthRestored: number\r\n    abstract audio: BetterAudio\r\n\r\n    onPickedUp(camera: Camera) {\r\n        UI.instance.health += this.healthRestored\r\n        if (UI.instance.health > 100) {\r\n            UI.instance.health = 100\r\n        }\r\n    }\r\n\r\n    canBePickedUp(camera: Camera) {\r\n        return UI.instance.health < 100\r\n    }\r\n}","import HealthItem from './HealthItem'\r\nimport audio from \"../../../../sounds/P_FOOD.wav\"\r\nimport BetterAudio from '../../../BetterAudio'\r\n\r\nexport default class DogFood extends HealthItem {\r\n    healthRestored = 4\r\n    textureNumber = 11\r\n    audio = new BetterAudio(audio)\r\n}","import HealthItem from './HealthItem'\r\nimport audio from \"../../../../sounds/P_FOOD.wav\"\r\nimport BetterAudio from '../../../BetterAudio'\r\n\r\nexport default class Food extends HealthItem {\r\n    healthRestored = 10\r\n    textureNumber = 41\r\n    audio = new BetterAudio(audio)\r\n}","import HealthItem from './HealthItem'\r\nimport audio from \"../../../../sounds/P_MEDKIT.wav\"\r\nimport BetterAudio from '../../../BetterAudio'\r\n\r\nexport default class HealthPack extends HealthItem {\r\n    healthRestored = 25\r\n    textureNumber = 42\r\n    audio = new BetterAudio(audio)\r\n}","import Camera from '../../../Camera'\r\nimport { degToRad, Vec2, Vec3 } from '../../../utils'\r\nimport UI from '../../ui/UI'\r\nimport Pickup from './Pickup'\r\nimport audio from \"../../../../sounds/P_MGUN.wav\"\r\nimport BetterAudio from '../../../BetterAudio'\r\n\r\nexport default class Machinegun extends Pickup {\r\n    textureNumber = 44\r\n    audio = new BetterAudio(audio)\r\n\r\n    onPickedUp(camera: Camera) {\r\n        UI.instance.weapons.availableTypes.push('machinegun')\r\n        UI.instance.weapon = 'machinegun'\r\n    }\r\n}","export default new Map([\r\n    ['demo', 0],\r\n    ['deathcam', 1],\r\n    ['puddle', 2],\r\n    ['greenBarrel', 3],\r\n    ['table', 4],\r\n    ['blood', 5],\r\n    ['flag', 6],\r\n    ['standingLamp', 8],\r\n    ['goldenLamp', 9],\r\n    ['hangingSkeleton', 10],\r\n    ['pillar', 12],\r\n    ['bones1', 13],\r\n    ['pots', 14],\r\n    ['furnance', 15],\r\n    ['greenPlant', 16],\r\n    ['skeleton', 17],\r\n    ['sink', 18],\r\n    ['brownPlant', 19],\r\n    ['urn', 20],\r\n    ['bones2', 21],\r\n    ['bones3', 22],\r\n    ['table', 24],\r\n    ['lamp', 25],\r\n    ['morePots', 26],\r\n    ['armor', 27],\r\n    ['cage', 28],\r\n    ['spears', 29],\r\n    ['vines', 30],\r\n    ['skeletonCage', 32],\r\n    ['bones', 33],\r\n    ['bed', 36],\r\n    ['bucket', 40],\r\n    ['bloodBones', 57],\r\n    ['brownBarrel', 58],\r\n    ['well', 59],\r\n    ['emptyWell', 60],\r\n])","import { log, m4, Transform, Vec3 } from \"../../utils\";\r\n\r\nexport class GridBoundingBox {\r\n    center: Vec3\r\n    size: Vec3\r\n\r\n    constructor(center: Vec3, size: Vec3) {\r\n        this.center = center\r\n        this.size = size\r\n    }\r\n\r\n    get halfSize() {\r\n        return this.size.multiply(0.5)\r\n    }\r\n\r\n    get negativeCorner() {\r\n        return this.center.substract(this.halfSize)\r\n    }\r\n\r\n    get positiveCorner() {\r\n        return this.center.add(this.halfSize)\r\n    }\r\n\r\n    isColliding(v: Vec3) {\r\n        const pos = this.positiveCorner\r\n        const neg = this.negativeCorner\r\n        return neg.x <= v.x && v.x <= pos.x && neg.z <= v.z && v.z <= pos.z\r\n    }\r\n\r\n    pointSide(v: Vec3) {\r\n        const diff = this.center.substract(v)\r\n        const diffRotated = diff\r\n\r\n        let pointSide = Vec3.zero\r\n        if (diffRotated.x > this.halfSize.x) {\r\n            pointSide.x = -1\r\n        }\r\n        if (diffRotated.x < -this.halfSize.x) {\r\n            pointSide.x = 1\r\n        }\r\n        if (diffRotated.z > this.halfSize.z) {\r\n            pointSide.z = -1\r\n        }\r\n        if (diffRotated.z < -this.halfSize.z) {\r\n            pointSide.z = 1\r\n        }\r\n        return pointSide\r\n    }\r\n\r\n    nearestDistanceDirection(v: Vec3) {\r\n        const side = this.pointSide(v)\r\n        if (side.x && side.z) {\r\n            return v.substract(this.nearestCorner(v)).yZeroed.normalize\r\n        } else {\r\n            return side\r\n        }\r\n    }\r\n\r\n    // only a non rotated cuboid\r\n    pointFarthestSide(v: Vec3) {\r\n        const diff = this.center.substract(v)\r\n        let pointSide = this.pointSide(v)\r\n        if (pointSide.x && pointSide.z) {\r\n            if (Math.abs(diff.x) > Math.abs(diff.z)) {\r\n                pointSide.z = 0\r\n            } else {\r\n                pointSide.x = 0\r\n            }\r\n        }\r\n        return pointSide\r\n    }\r\n\r\n    // cuboid rotated by any value\r\n    nearestCorner(v: Vec3) {\r\n        const diff = this.center.substract(v)\r\n        if (diff.x <= 0 && diff.z <= 0) {\r\n            return this.center.substract(this.halfSize)\r\n        } else if (diff.x <= 0 && diff.z >= 0) {\r\n            const cornerRelative = new Vec3(-this.halfSize.x, 0, this.halfSize.z)\r\n            return this.center.substract(cornerRelative)\r\n        } else if (diff.x >= 0 && diff.z <= 0) {\r\n            const cornerRelative = new Vec3(this.halfSize.x, 0, -this.halfSize.z)\r\n            return this.center.substract(cornerRelative)\r\n        } else if (diff.x >= 0 && diff.z >= 0) {\r\n            return this.center.add(this.halfSize)\r\n        }\r\n    }\r\n\r\n    basePointsYZeroed() {\r\n        const a = this.halfSize.yZeroed\r\n        return [\r\n            this.center.add(a),\r\n            this.center.add(a.xInverted),\r\n            this.center.add(a.yInverted),\r\n            this.center.substract(a),\r\n        ]\r\n    }\r\n}","import texture from '../../../../textures/objects.png'\r\nimport Config from '../../../Config'\r\nimport { Program } from '../../../programs/Program'\r\nimport { degToRad, Vec2, Vec3 } from '../../../utils'\r\nimport Plane from '../Plane'\r\nimport DecorationMap from '../../../../../common/DecorationMap'\r\nimport { GridBoundingBox } from '../GridBoundingBox'\r\n\r\nexport default class Decoration extends Plane {\r\n    type: string\r\n    bb: GridBoundingBox\r\n\r\n    constructor(gl: WebGLRenderingContext, program: Program, type: string) {\r\n        super(gl, program)\r\n        this.type = type\r\n    }\r\n\r\n    createBB() {\r\n        this.bb = new GridBoundingBox(this.transform.position, Vec3.one.multiply(Config.gridSize))\r\n    }\r\n\r\n    get textureNumber() {\r\n        return DecorationMap.get(this.type)\r\n    }\r\n\r\n    importedTexture = texture\r\n\r\n    private firstTextureSet = false\r\n\r\n    onCreation() {\r\n        this.transform.scale = Vec3.one.multiply(Config.gridSize)\r\n        this.transform.rotation.x = degToRad(90)\r\n        this.setTexture(this.textureNumber)\r\n    }\r\n\r\n    lookAtCamera(cameraY: number) {\r\n        this.transform.rotation.y = -cameraY\r\n    }\r\n\r\n    private texturesInLine = 8\r\n\r\n    get textureSize() {\r\n        return 1 / this.texturesInLine\r\n    }\r\n\r\n    setTexture(textureNumber: number) {\r\n        let verticesVec2Array = Vec2.arrayToVec2Array(this.initialTexcoords)\r\n        const texturePos = new Vec2(textureNumber % this.texturesInLine, Math.floor(textureNumber / this.texturesInLine)).multiply(this.textureSize)\r\n        verticesVec2Array = verticesVec2Array.map(vertex => vertex.multiply(this.textureSize).add(texturePos))\r\n        this.TEXCOORDS = new Float32Array(Vec2.vec2ArrayToArray(verticesVec2Array))\r\n        if (!this.firstTextureSet) {\r\n            this.firstTextureSet = true\r\n            this.updateBuffers()\r\n        }\r\n    }\r\n}","import Camera from '../../../Camera'\r\nimport UI from '../../ui/UI'\r\nimport Pickup from './Pickup'\r\n\r\nexport default abstract class PointItem extends Pickup {\r\n    abstract textureNumber: number\r\n    abstract givenScore: number\r\n\r\n    onPickedUp(camera: Camera) {\r\n        UI.instance.score += this.givenScore\r\n        UI.instance.treasuresFound++\r\n    }\r\n}","import PointItem from './PointItem'\r\nimport audio from \"../../../../sounds/T_CROSS.wav\"\r\nimport BetterAudio from '../../../BetterAudio'\r\n\r\nexport default class GoldenCross extends PointItem {\r\n    textureNumber = 49\r\n    givenScore = 100\r\n    audio = new BetterAudio(audio)\r\n}","import PointItem from './PointItem'\r\nimport audio from \"../../../../sounds/T_CUP.wav\"\r\nimport BetterAudio from '../../../BetterAudio'\r\n\r\nexport default class GoldenCup extends PointItem {\r\n    textureNumber = 50\r\n    givenScore = 500\r\n    audio = new BetterAudio(audio)\r\n}","import PointItem from './PointItem'\r\nimport audio from \"../../../../sounds/T_CHEST.wav\"\r\nimport BetterAudio from '../../../BetterAudio'\r\n\r\nexport default class GoldenBox extends PointItem {\r\n    textureNumber = 51\r\n    givenScore = 1000\r\n    audio = new BetterAudio(audio)\r\n}","import PointItem from './PointItem'\r\nimport audio from \"../../../../sounds/T_CROWN.wav\"\r\nimport BetterAudio from '../../../BetterAudio'\r\n\r\nexport default class GoldenCrown extends PointItem {\r\n    textureNumber = 52\r\n    givenScore = 5000\r\n    audio = new BetterAudio(audio)\r\n}","import Camera from '../../../Camera'\r\nimport UI from '../../ui/UI'\r\nimport Pickup from './Pickup'\r\nimport audio from \"../../../../sounds/P_LIFE.wav\"\r\nimport BetterAudio from '../../../BetterAudio'\r\n\r\nexport default class PowerUp extends Pickup {\r\n    textureNumber = 56\r\n    audio = new BetterAudio(audio)\r\n    onPickedUp(camera: Camera) {\r\n        UI.instance.health = 100\r\n        UI.instance.ammo += 25\r\n        UI.instance.lives++\r\n    }\r\n}","import { Vec2, Vec3 } from '../../utils'\r\nimport Cuboid from './Cuboid'\r\nimport texture from '../../../textures/wall.png'\r\nimport Config from '../../Config'\r\nimport { Program } from '../../programs/Program'\r\nimport Interactable from './Interactable'\r\nimport UI from '../ui/UI'\r\nimport BetterAudio from '../../BetterAudio'\r\nimport audio from \"../../../sounds/WSND0030.wav\"\r\n\r\nexport default class Lever extends Cuboid implements Interactable {\r\n    importedTexture = texture\r\n    texturesInLine = 16\r\n    audio = new BetterAudio(audio)\r\n    value: string\r\n\r\n    constructor(gl: WebGLRenderingContext, program: Program, value: string) {\r\n        super(gl, program)\r\n        this.value = value\r\n    }\r\n\r\n    canInteract = true\r\n\r\n    lightTexture = 101\r\n    pressedTexture = 113\r\n\r\n    onCreation() {\r\n        this.transform.scale = Vec3.one.multiply(Config.gridSize)\r\n        this.setTexture(this.lightTexture)\r\n    }\r\n\r\n    updateBuffers() {\r\n        super.updateBuffers()\r\n    }\r\n\r\n    get darkTexture() {\r\n        return this.lightTexture\r\n    }\r\n\r\n    toggle() {\r\n        if (UI.instance.state != 'end') {\r\n            this.audio.play()\r\n            this.setTexture(this.pressedTexture)\r\n            UI.instance.state = 'end'\r\n            UI.instance.levelEnd.calculateValues()\r\n            UI.instance.endTime = new Date()\r\n            this.updateBuffers()\r\n        }\r\n    }\r\n}","import { Vec2, Vec3 } from '../../utils'\r\nimport Config from '../../Config'\r\nimport Wall from './Wall'\r\nimport Interactable from './Interactable'\r\nimport Camera from '../../Camera'\r\nimport audio from \"../../../sounds/WSND0015.wav\"\r\nimport BetterAudio from '../../BetterAudio'\r\nimport UI from '../ui/UI'\r\n\r\n\r\nexport default class WallSecretDoor extends Wall implements Interactable {\r\n    canInteract = true\r\n    dirToCalculate = false\r\n\r\n    private dir: Vec3\r\n    private opening = false\r\n    private openingSpeed = Config.gridSize * 0.7\r\n    audio = new BetterAudio(audio)\r\n\r\n    toggle() {\r\n        if (!this.opening) {\r\n            this.opening = true\r\n            UI.instance.secretsFound++\r\n            this.audio.play()\r\n        }\r\n    }\r\n\r\n    update(deltaTime: number, camera: Camera) {\r\n        if (this.opening) {\r\n            if (this.dirToCalculate) {\r\n                this.calculateDir(camera)\r\n            }\r\n            this.transform.position = this.transform.position.add(this.dir.multiply(deltaTime * this.openingSpeed))\r\n            if (this.initialTransform.position.distanceTo(this.transform.position) >= Config.gridSize * 2) {\r\n                this.opening = false\r\n                this.canInteract = false\r\n            }\r\n        }\r\n    }\r\n\r\n    calculateDir(camera: Camera) {\r\n        this.dir = Vec3.fromAngle(this.transform.rotation.y)\r\n        const toCamera = camera.transform.position.substract(this.transform.position)\r\n        if ((this.dir.x > 0 && toCamera.x > 0) || (this.dir.x < 0 && toCamera.x < 0)) {\r\n            this.dir.x = -this.dir.x\r\n        }\r\n        if ((this.dir.z > 0 && toCamera.z > 0) || (this.dir.z < 0 && toCamera.z < 0)) {\r\n            this.dir.z = -this.dir.z\r\n        }\r\n        this.dirToCalculate = false\r\n    }\r\n}","import FieldData from '../../common/FieldData';\r\nimport { degToRad, Vec3 } from './utils';\r\nimport Wall from './shapes/level/Wall'\r\nimport Enemy from './shapes/level/Enemy'\r\nimport Cuboid from './shapes/level/Cuboid';\r\nimport Door from './shapes/level/Door';\r\nimport Plane from './shapes/level/Plane';\r\nimport Shape from './shapes/level/Shape';\r\nimport Interactable from './shapes/level/Interactable';\r\n\r\nimport Pickup from './shapes/level/pickups/Pickup';\r\nimport Ammo from './shapes/level/pickups/Ammo'\r\n\r\nimport Config from './Config'\r\nimport { TextureProgram } from './programs/TextureProgram';\r\nimport { ColorProgram } from './programs/ColorProgram';\r\nimport { Program } from './programs/Program';\r\nimport DogFood from './shapes/level/pickups/DogFood';\r\nimport Food from './shapes/level/pickups/Food';\r\nimport HealthPack from './shapes/level/pickups/HealthPack';\r\nimport Machinegun from './shapes/level/pickups/Machinegun';\r\n\r\nimport Decoration from './shapes/level/decorations/Decoration';\r\nimport DecorationMap from '../../common/DecorationMap'\r\nimport NotCollidingFieldValues from '../../common/NotCollidingFieldValues';\r\nimport GoldenCross from './shapes/level/pickups/GoldenCross';\r\nimport GoldenCup from './shapes/level/pickups/GoldenCup';\r\nimport GoldenBox from './shapes/level/pickups/GoldenBox';\r\nimport GoldenCrown from './shapes/level/pickups/GoldenCrown';\r\nimport PowerUp from './shapes/level/pickups/PowerUp';\r\nimport Pathfinder from './Pathfinder';\r\nimport Lever from './shapes/level/Lever';\r\nimport WallSecretDoor from './shapes/level/WallSecretDoor';\r\nimport UI from './shapes/ui/UI';\r\nimport PointItem from './shapes/level/pickups/PointItem';\r\n\r\n\r\nexport default class Level {\r\n    width: number\r\n    height: number\r\n    center: Vec3\r\n    playerPosition: Vec3\r\n    enemies: Enemy[] = []\r\n    walls: Wall[] = []\r\n    secretWalls: WallSecretDoor[] = []\r\n    doors: Door[] = []\r\n    shapes: Shape[] = []\r\n    floor: Plane\r\n    ceiling: Plane\r\n    exits: Lever[]\r\n    collidingCuboids: Cuboid[] = []\r\n    interactables: Interactable[] = []\r\n    textureProgram: TextureProgram\r\n    colorProgram: ColorProgram\r\n    pickups: Pickup[] = []\r\n    decorations: Decoration[] = []\r\n\r\n    private readonly gl: WebGLRenderingContext\r\n    private fields: FieldData[]\r\n    gridFields: FieldData[]\r\n\r\n    constructor(gl: WebGLRenderingContext, textureProgram: TextureProgram, colorProgram: ColorProgram) {\r\n        this.gl = gl\r\n        this.textureProgram = textureProgram\r\n        this.colorProgram = colorProgram\r\n    }\r\n\r\n    load(level: number, callback?: () => void) {\r\n        this.loadLevel(level, () => {\r\n            this.createObjects()\r\n            Pathfinder.instance.prepareLevel(this)\r\n            callback?.()\r\n        })\r\n    }\r\n\r\n    spawnLoot(enemy: Enemy) {\r\n        if (enemy.loot) {\r\n            this.pickups.push(enemy.loot)\r\n            enemy.loot.transform.position = enemy.transform.position.clone()\r\n            // enemy.loot.transform.position.x += 30\r\n            // enemy.loot.transform.position.z += 30\r\n            enemy.loot.setInitialState()\r\n        }\r\n    }\r\n\r\n    get verticesCount() {\r\n        return this.shapes.map(el => el.verticesCount).reduce((a, b) => a + b)\r\n    }\r\n\r\n    private loadLevel(number: number, callback?: () => void) {\r\n        import(`../levels/${number}.json`)\r\n            .then(({ default: level }) => {\r\n                this.width = level.width\r\n                this.height = level.height\r\n                this.center = new Vec3(this.width * Config.gridSize / 2, 0, this.height * Config.gridSize / 2)\r\n                this.fields = JSON.parse(JSON.stringify(level.fields))\r\n                this.checkWallsDirections()\r\n                this.changeWallsNeighboursTextures()\r\n                this.applyGridSize()\r\n                this.gridFields = JSON.parse(JSON.stringify(level.fields))\r\n                callback?.()\r\n            });\r\n    }\r\n\r\n    private checkWallsDirections() {\r\n        for (let door of this.fields.filter(f => f.value == 'door' || f.value == \"exitDoor\" || (f.value.toLowerCase().includes('secret') && f.value.toLowerCase().includes('wall')))) {\r\n            const horizontalNeighbours = this.fields\r\n                .filter(f => f.y == door.y && (f.x == door.x + 1 || f.x == door.x - 1))\r\n                .filter(f => f.value.toLowerCase().includes('wall'))\r\n            const verticalNeighbours = this.fields\r\n                .filter(f => f.x == door.x && (f.y == door.y + 1 || f.y == door.y - 1))\r\n                .filter(f => f.value.toLowerCase().includes('wall'))\r\n            if (horizontalNeighbours.length == 2 && verticalNeighbours.length == 0) {\r\n                door.rotation = 0\r\n            } else if (horizontalNeighbours.length == 0 && verticalNeighbours.length == 2) {\r\n                door.rotation = 270\r\n            }\r\n        }\r\n    }\r\n\r\n    private changeWallsNeighboursTextures() {\r\n        for (let door of this.fields.filter(f => f.value == 'door' || f.value == 'exitDoor')) {\r\n            for (let direction of [[0, -1], [0, 1], [-1, 0], [1, 0]]) {\r\n                const neighbour = this.fields.find(f => {\r\n                    return f.x == door.x + direction[0] && f.y == door.y + direction[1]\r\n                })\r\n                if (neighbour) {\r\n                    neighbour.wallDirection = direction\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private applyGridSize() {\r\n        for (let field of this.fields) {\r\n            field.x = (field.x * Config.gridSize) + Config.gridSize / 2\r\n            field.y = (field.y * Config.gridSize) + Config.gridSize / 2\r\n        }\r\n    }\r\n\r\n    private createObjects() {\r\n        const playerPositionData = this.fields.find(f => f.value == 'player')\r\n        this.playerPosition = new Vec3(playerPositionData.x, 0, playerPositionData.y)\r\n\r\n        this.walls = this.getLevelObjectsList('wall', Wall) as Wall[]\r\n        this.enemies = this.getLevelObjectsList('enemy', Enemy) as Enemy[]\r\n        this.doors = this.getLevelObjectsList('door', Door) as Door[]\r\n        const ammos = this.getLevelObjectsList('ammo', Ammo) as Ammo[]\r\n        const dogFoods = this.getLevelObjectsList('dogFood', DogFood) as DogFood[]\r\n        const foods = this.getLevelObjectsList('food', Food) as Food[]\r\n        const healthPacks = this.getLevelObjectsList('health', HealthPack) as HealthPack[]\r\n        const powerUps = this.getLevelObjectsList('powerUp', PowerUp) as PowerUp[]\r\n        const machineguns = this.getLevelObjectsList('machinegun', Machinegun) as Machinegun[]\r\n        const goldenCrosses = this.getLevelObjectsList('goldCross', GoldenCross) as GoldenCross[]\r\n        const goldenCups = this.getLevelObjectsList('goldCup', GoldenCup) as GoldenCup[]\r\n        const goldenBoxes = this.getLevelObjectsList('goldBox', GoldenBox) as GoldenBox[]\r\n        const goldenCrowns = this.getLevelObjectsList('goldCrown', GoldenCrown) as GoldenCrown[]\r\n\r\n        this.exits = []\r\n        this.exits.push(...this.getLevelObjectsList('exitLever', Lever) as Lever[])\r\n        this.exits.push(...this.getLevelObjectsList('secretExitLever', Lever) as Lever[])\r\n\r\n        this.decorations = []\r\n        for (let decorationName of DecorationMap.keys()) {\r\n            this.decorations.push(...this.getLevelObjectsList(decorationName, Decoration) as Decoration[])\r\n        }\r\n        this.decorations.filter(d => !NotCollidingFieldValues.includes(d.type)).forEach(d => d.createBB())\r\n\r\n        this.secretWalls = this.walls.filter(w => w instanceof WallSecretDoor).map(w => w as WallSecretDoor)\r\n        this.walls = this.walls.filter(w => !(w instanceof WallSecretDoor))\r\n        this.collidingCuboids = []\r\n        this.collidingCuboids.push(...this.walls)\r\n        this.collidingCuboids.push(...this.secretWalls)\r\n        this.collidingCuboids.push(...this.doors)\r\n        this.collidingCuboids.push(...this.exits)\r\n        this.interactables = []\r\n        this.interactables.push(...this.doors)\r\n        this.interactables.push(...this.secretWalls)\r\n        this.interactables.push(...this.exits)\r\n        this.pickups = []\r\n        this.pickups.push(...ammos)\r\n        this.pickups.push(...dogFoods)\r\n        this.pickups.push(...foods)\r\n        this.pickups.push(...healthPacks)\r\n        this.pickups.push(...powerUps)\r\n        this.pickups.push(...machineguns)\r\n        this.pickups.push(...goldenCrosses)\r\n        this.pickups.push(...goldenCups)\r\n        this.pickups.push(...goldenBoxes)\r\n        this.pickups.push(...goldenCrowns)\r\n\r\n        // this.doors[0].transform.position.x += 45\r\n\r\n        this.floor = new Plane(this.gl, this.colorProgram)\r\n        this.floor.setColor(\"#707070\")\r\n        this.floor.transform.position = this.center.clone()\r\n        this.floor.transform.position.y = -Config.gridSize / 2\r\n        this.floor.transform.scale.set(this.width * Config.gridSize, 1, this.height * Config.gridSize)\r\n\r\n        this.ceiling = new Plane(this.gl, this.colorProgram)\r\n        this.ceiling.setColor(\"#383838\")\r\n        this.ceiling.transform.position = this.center.clone()\r\n        this.ceiling.transform.position.y = Config.gridSize / 2\r\n        this.ceiling.transform.scale.set(this.width * Config.gridSize, 1, this.height * Config.gridSize)\r\n        this.ceiling.transform.rotation.z = degToRad(180)\r\n\r\n        // {\r\n        //     const health = new DogFood(this.gl, this.textureProgram)\r\n        //     health.transform.position.x = 1888\r\n        //     health.transform.position.z = 1344\r\n        //     health.setInitialState()\r\n        //     this.pickups.push(health)\r\n        // }\r\n        // {\r\n        //     const health = new Food(this.gl, this.textureProgram)\r\n        //     health.transform.position.x = 1888 - Config.gridSize * 1\r\n        //     health.transform.position.z = 1344\r\n        //     health.setInitialState()\r\n        //     this.pickups.push(health)\r\n        // }\r\n        // {\r\n        //     const health = new HealthPack(this.gl, this.textureProgram)\r\n        //     health.transform.position.x = 1888 - Config.gridSize * 2\r\n        //     health.transform.position.z = 1344\r\n        //     health.setInitialState()\r\n        //     this.pickups.push(health)\r\n        // }\r\n\r\n        UI.instance.enemiesCount = this.enemies.length\r\n        UI.instance.secretsCount = this.secretWalls.length\r\n        UI.instance.treasuresCount = this.pickups.filter(p => p instanceof PointItem).length\r\n\r\n        this.shapes = [\r\n            ...this.walls,\r\n            ...this.secretWalls,\r\n            ...this.enemies,\r\n            ...this.doors,\r\n            ...this.pickups,\r\n            ...this.decorations,\r\n            ...this.exits,\r\n            this.floor,\r\n            this.ceiling,\r\n        ]\r\n    }\r\n\r\n    private getLevelObjectsList<T extends Shape>(value: string, SpecificShape: new (gl: WebGLRenderingContext, program: Program, type?: string) => T) {\r\n        const objects: Shape[] = []\r\n        for (let field of this.fields.filter(f => f.value.toLowerCase().includes(value.toLowerCase()))) {\r\n            let shape\r\n            if (field.value.toLowerCase().includes('wall')) {\r\n                if (field.value.toLowerCase().includes('wallsecret')) {\r\n                    shape = new WallSecretDoor(this.gl, this.textureProgram, field.value)\r\n                } else {\r\n                    shape = new Wall(this.gl, this.textureProgram, field.value)\r\n                }\r\n            } else if (field.value.toLowerCase().includes(\"walking\")) {\r\n                if (field.value == 'enemyZWalking') {\r\n                    shape = new Enemy(this.gl, this.textureProgram, 'z')\r\n                } else if (field.value == 'enemyXWalking') {\r\n                    shape = new Enemy(this.gl, this.textureProgram, 'x')\r\n                }\r\n            } else if (field.value.toLowerCase().includes(\"door\")) {\r\n                if (field.value == 'exitDoor') {\r\n                    shape = new Door(this.gl, this.textureProgram, field.value)\r\n                } else {\r\n                    shape = new Door(this.gl, this.textureProgram)\r\n                }\r\n            } else if (field.value.toLowerCase().includes(\"enemy\")) {\r\n                for (let dir of ['up', 'down', 'left', 'right']) {\r\n                    if (field.value.toLowerCase().includes(dir)) {\r\n                        shape = new Enemy(this.gl, this.textureProgram, dir)\r\n                    }\r\n                }\r\n            } else {\r\n                shape = new SpecificShape(this.gl, this.textureProgram)\r\n            }\r\n            shape.transform.position.x = field.x\r\n            shape.transform.position.z = field.y\r\n            if (field.rotation) {\r\n                shape.transform.rotation.y = degToRad(field.rotation)\r\n            }\r\n            if (field.value.toLowerCase().includes('wall')) {\r\n                if (field.value.toLowerCase().includes('wallsecret')) {\r\n                    (shape as WallSecretDoor).dirToCalculate = true\r\n                }\r\n            }\r\n            shape.setInitialState()\r\n            if (field.wallDirection && shape instanceof Wall) {\r\n                const dir = new Vec3(field.wallDirection[0], 0, field.wallDirection[1])\r\n                if (dir.equals(Vec3.backward)) {\r\n                    shape.setTexture(shape.nearDoorDarkTexture, 0)\r\n                }\r\n                if (dir.equals(Vec3.forward)) {\r\n                    shape.setTexture(shape.nearDoorDarkTexture, 1)\r\n                }\r\n                if (dir.equals(Vec3.left)) {\r\n                    shape.setTexture(shape.nearDoorLightTexture, 3)\r\n                }\r\n                if (dir.equals(Vec3.right)) {\r\n                    shape.setTexture(shape.nearDoorLightTexture, 2)\r\n                }\r\n            } else if (shape instanceof Decoration) {\r\n                shape.type = value\r\n                shape.setTexture(shape.textureNumber)\r\n            }\r\n            objects.push(shape)\r\n        }\r\n        return objects\r\n    }\r\n}","import { Program } from '../../programs/Program'\r\nimport { m4, Vec3 } from '../../utils'\r\nimport Shape from '../level/Shape'\r\n\r\nexport default class Crosshair extends Shape {\r\n    readonly VERTICES = new Float32Array([\r\n        1, 1, 0,\r\n        -1, 1, 0,\r\n        -1, -1, 0,\r\n        -1, -1, 0,\r\n        1, -1, 0,\r\n        1, 1, 0,\r\n    ])\r\n\r\n    readonly COLORS = new Uint8Array([\r\n        200, 70, 0.520,\r\n        200, 70, 0.520,\r\n        200, 70, 0.520,\r\n        200, 70, 0.520,\r\n        200, 70, 0.520,\r\n        200, 70, 0.520,\r\n    ])\r\n\r\n    constructor(gl: WebGLRenderingContext, program: Program) {\r\n        super(gl, program)\r\n        this.transform.scale = Vec3.one.multiply(0.01)\r\n        this.transform.position.z = -2\r\n    }\r\n}","import { ColorProgram } from './programs/ColorProgram'\r\nimport { TextureProgram } from './programs/TextureProgram'\r\n\r\nimport { degToRad, log, m4, radToDeg, Vec3 } from './utils'\r\nimport Camera from './Camera'\r\nimport Input from './Input'\r\nimport Textures from './Textures'\r\n\r\nimport Level from './Level'\r\n\r\nimport Crosshair from './shapes/ui/Crosshair'\r\nimport Interactable from './shapes/level/Interactable'\r\nimport Config from './Config'\r\nimport UI from './shapes/ui/UI'\r\nimport Raycaster from './Raycaster'\r\n\r\n\r\nexport default class Game {\r\n    private readonly colorProgram: ColorProgram\r\n    private readonly textureProgram: TextureProgram\r\n    private readonly camera: Camera\r\n    private readonly textures: Textures\r\n    private readonly level: Level\r\n    private readonly crosshair: Crosshair\r\n    private readonly fixedUpdateInterval = 20\r\n    private gl: WebGLRenderingContext\r\n    private canvas: HTMLCanvasElement\r\n    private currentLevel = 1\r\n    private state = \"startScreen\"\r\n    private firstLevelLoaded = false\r\n\r\n    constructor() {\r\n\r\n        this.initWebgl()\r\n        this.colorProgram = new ColorProgram(this.gl)\r\n        this.textureProgram = new TextureProgram(this.gl)\r\n\r\n        this.camera = new Camera(this.gl, this.textureProgram)\r\n        this.camera.updateProjectionMatrix()\r\n        this.textures = new Textures(this.gl)\r\n        this.level = new Level(this.gl, this.textureProgram, this.colorProgram)\r\n        this.crosshair = new Crosshair(this.gl, this.colorProgram)\r\n        this.loadLevel(this.currentLevel)\r\n    }\r\n\r\n    private loadLevel(number: number) {\r\n        this.level.load(number, () => {\r\n            let shapes = []\r\n            shapes.push(...this.level.enemies.map(enemy => enemy.loot))\r\n            shapes.push(...this.level.enemies.map(enemy => enemy.tempFlag))\r\n            shapes.push(...this.level.shapes)\r\n            this.textures.load(shapes, () => {\r\n                this.camera.transform.position = this.level.playerPosition\r\n                this.camera.initialTransform = this.camera.transform.clone()\r\n                this.camera.collidingShapes = [...this.level.collidingCuboids, ...this.level.decorations.filter(decoration => decoration.bb)]\r\n                if (!this.firstLevelLoaded) {\r\n                    this.firstLevelLoaded = true\r\n                    this.startGameLoop()\r\n                }\r\n            })\r\n        })\r\n    }\r\n\r\n    private startGameLoop() {\r\n        let then = 0\r\n        const render = (now: number) => {\r\n            now *= 0.001  // convert to seconds\r\n            const deltaTime = now - then\r\n            then = now\r\n\r\n            this.draw(deltaTime)\r\n\r\n            requestAnimationFrame(render)\r\n        }\r\n        requestAnimationFrame(render)\r\n\r\n        const fixedDeltaTime = this.fixedUpdateInterval * 0.001\r\n        setInterval(() => {\r\n            this.fixedUpdate(fixedDeltaTime)\r\n        }, this.fixedUpdateInterval)\r\n    }\r\n\r\n    private fixedUpdate(deltaTime: number) {\r\n        if (Input.instance.interacting) {\r\n            const nearestInteractable = this.camera.nearest(\r\n                this.level.interactables\r\n                    .filter(i => i.canInteract)\r\n                    .filter(i => {\r\n                        const angle = this.camera.angleTo(i.transform.position)\r\n                        return Math.abs(angle) < 60\r\n                    })\r\n            ) as Interactable\r\n            if (nearestInteractable && this.camera.inInteractionDistance(nearestInteractable)) {\r\n                nearestInteractable.toggle()\r\n                Input.instance.justInteracted = true\r\n            }\r\n        }\r\n\r\n        this.camera.update(deltaTime)\r\n\r\n        for (let pickup of this.level.pickups.filter(pickup => !pickup.pickedUp)) {\r\n            if (this.camera.transform.position.horizontalDistanceTo(pickup.transform.position) <= pickup.pickupRange) {\r\n                pickup.pickUp(this.camera)\r\n            }\r\n        }\r\n\r\n        for (let door of this.level.doors) {\r\n            door.update(deltaTime)\r\n            if (door.opened) {\r\n                door.tryToClose(deltaTime, this.camera, this.level.enemies)\r\n            }\r\n        }\r\n        for (let secretWall of this.level.secretWalls) {\r\n            secretWall.update(deltaTime, this.camera)\r\n        }\r\n\r\n        const raycaster = Raycaster.fromDir(this.camera.transform.position, Vec3.fromAngle(this.camera.transform.rotation.y))\r\n        const shapeLookedAt = raycaster.nextShape(this.level.collidingCuboids)\r\n        for (let enemy of this.level.enemies) {\r\n            enemy.update(deltaTime, this.camera)\r\n            if (this.camera.isLookingAt(enemy) && shapeLookedAt) {\r\n                const enemyDistance = this.camera.transform.position.horizontalDistanceTo(enemy.transform.position)\r\n                const shapeLookedAtDistance = this.camera.transform.position.horizontalDistanceTo(shapeLookedAt.transform.position)\r\n                if (enemyDistance < shapeLookedAtDistance) {\r\n                    if (UI.instance.weapons.currentWeapon.justShot) {\r\n                        const distance = this.camera.transform.position.horizontalDistanceTo(enemy.transform.position)\r\n                        if (distance <= UI.instance.weapons.currentWeapon.range && !enemy.isDead) {\r\n                            enemy.damage(UI.instance.weapons.currentWeapon.damage)\r\n                            UI.instance.score += enemy.score\r\n                        }\r\n                        if (enemy.isDead) {\r\n                            this.level.spawnLoot(enemy)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (enemy.isDead) {\r\n                enemy.followingPlayer = null\r\n            } else {\r\n                const angleDiff = enemy.rotateTexture(this.camera.transform.position)\r\n                if (!enemy.followingPlayer) {\r\n                    let startFollowing = false\r\n\r\n\r\n                    // inShotNoticeDistance(camera: Camera) {\r\n                    //     return this.transform.position.horizontalDistanceTo(camera.transform.position) <= this.shotNoticeDistance\r\n                    // }\r\n                    const distance = enemy.transform.position.horizontalDistanceTo(this.camera.transform.position)\r\n                    if (enemy.canSee(this.camera.transform.position, this.level.collidingCuboids)) {\r\n                        if (UI.instance.weapons.currentWeapon.justShot) {\r\n                            startFollowing = true\r\n                        } else if (Math.abs(angleDiff) <= 90) {\r\n\r\n                            startFollowing = true\r\n                        } else if (distance <= Config.gridSize * 2) {\r\n\r\n                            startFollowing = true\r\n                        }\r\n                    }\r\n                    if (startFollowing) {\r\n                        enemy.followingPlayer = this.camera\r\n                        if (UI.instance.health > 0) {\r\n                            enemy.audioSight.play()\r\n                        }\r\n                        enemy.state = \"walking\"\r\n                    }\r\n                }\r\n                const canShot = enemy.tryToShoot(this.camera, this.level.collidingCuboids)\r\n                // console.log(enemy.state)\r\n                if (!canShot) {\r\n                    enemy.makeStepTowardsPlayer(deltaTime, this.level.doors)\r\n                }\r\n                enemy.makeStepIfWalking(deltaTime, this.level.collidingCuboids)\r\n            }\r\n        }\r\n\r\n        if (UI.instance.health == 0 && UI.instance.state == \"game\") {\r\n            this.camera.audioDeath.play()\r\n            UI.instance.state = \"dead\"\r\n            setTimeout(() => {\r\n                UI.instance.takeLife()\r\n                this.camera.transform = this.camera.initialTransform\r\n                UI.instance.state = \"game\"\r\n                this.camera.killer = null\r\n                this.loadLevel(this.currentLevel)\r\n            }, 4000)\r\n        }\r\n        if (this.camera.killer) {\r\n            this.camera.lookAtKillerStep(deltaTime)\r\n        }\r\n        UI.instance.update(deltaTime)\r\n        // console.log(this.state)\r\n        // console.log(UI.instance.health)\r\n    }\r\n\r\n    private draw(deltaTime: number) {\r\n        this.setDrawSettings()\r\n        // this.level.shapes.forEach(s => s.updateBuffers())\r\n\r\n        // this.crosshair.draw(this.camera.projectionMatrix)\r\n        this.level.floor.draw(this.camera.viewProjectionMatrix)\r\n        this.level.ceiling.draw(this.camera.viewProjectionMatrix)\r\n\r\n        for (let pickup of this.level.pickups.filter(pickup => !pickup.pickedUp)) {\r\n            pickup.lookAtCamera(this.camera.transform.rotation.y)\r\n            pickup.draw(this.camera.viewProjectionMatrix)\r\n        }\r\n\r\n        for (let decoration of this.level.decorations) {\r\n            decoration.lookAtCamera(this.camera.transform.rotation.y)\r\n            decoration.draw(this.camera.viewProjectionMatrix)\r\n        }\r\n\r\n        if (Input.instance.renderWalls) {\r\n            for (let wall of this.level.walls) {\r\n                wall.draw(this.camera.viewProjectionMatrix)\r\n            }\r\n            for (let wall of this.level.secretWalls) {\r\n                wall.draw(this.camera.viewProjectionMatrix)\r\n            }\r\n        }\r\n\r\n        for (let exit of this.level.exits) {\r\n            exit.draw(this.camera.viewProjectionMatrix)\r\n        }\r\n\r\n        for (let door of this.level.doors) {\r\n            door.draw(this.camera.viewProjectionMatrix)\r\n        }\r\n\r\n        for (let enemy of this.level.enemies) {\r\n            enemy.lookAtCamera(this.camera.transform.rotation.y)\r\n            enemy.draw(this.camera.viewProjectionMatrix)\r\n            if (Config.debug) {\r\n                for (let field of enemy.pathfinderFields) {\r\n                    enemy.tempFlag.transform.position = field.subGridPos\r\n                    enemy.tempFlag.lookAtCamera(this.camera.transform.rotation.y)\r\n                    enemy.tempFlag.draw(this.camera.viewProjectionMatrix)\r\n                }\r\n            }\r\n        }\r\n        UI.instance.draw(this.canvas)\r\n    }\r\n\r\n    private initWebgl() {\r\n        this.canvas = document.getElementById(\"canvas\") as HTMLCanvasElement\r\n        this.canvas.width = 608 * Config.uiScale\r\n        this.canvas.height = 304 * Config.uiScale;\r\n\r\n        UI.instance.init();\r\n\r\n        this.gl = this.canvas.getContext(\"webgl\")\r\n\r\n        if (!this.gl) {\r\n            alert(\"No webgl for you\")\r\n        }\r\n\r\n        this.gl.clearColor(0, 0, 0, 0)\r\n\r\n        this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n        this.gl.enable(this.gl.BLEND);\r\n\r\n        this.gl.enable(this.gl.CULL_FACE)\r\n        this.gl.enable(this.gl.DEPTH_TEST)\r\n    }\r\n\r\n    private setDrawSettings() {\r\n        this.resizeCanvasToDisplaySize(this.gl.canvas)\r\n\r\n        this.gl.viewport(0, 0, this.gl.canvas.width, this.gl.canvas.height)\r\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.DEPTH_BUFFER_BIT)\r\n\r\n        Input.instance.update()\r\n    }\r\n\r\n    private resizeCanvasToDisplaySize(canvas: HTMLCanvasElement) {\r\n        // const displayWidth = canvas.clientWidth\r\n        // const displayHeight = canvas.clientHeight\r\n        const displayWidth = 608 * Config.uiScale\r\n        const displayHeight = 304 * Config.uiScale\r\n\r\n        const resizeNeeded = canvas.width !== displayWidth || canvas.height !== displayHeight\r\n\r\n        if (resizeNeeded) {\r\n            canvas.width = displayWidth\r\n            canvas.height = displayHeight\r\n            this.camera.updateProjectionMatrix()\r\n        }\r\n\r\n        return resizeNeeded\r\n    }\r\n}","import \"./style.css\";\r\nimport Game from \"./components/Game\";\r\nimport favicon from \"./favicon.ico\"\r\n\r\nwindow.onload = () => {\r\n    new Game()\r\n}"],"names":["leafPrototypes","getProto","inProgress","dataWebpackPrefix","___CSS_LOADER_EXPORT___","push","module","id","exports","cssWithMappingToString","list","toString","this","map","item","content","needLayer","concat","length","join","i","modules","media","dedupe","supports","layer","undefined","alreadyImportedModules","_i","_i2","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","sourceURLs","sources","source","sourceRoot","stylesInDOM","getIndexByIdentifier","identifier","result","modulesToDom","options","idCountMap","identifiers","base","count","indexByIdentifier","obj","css","sourceMap","references","updater","addElementStyle","byIndex","splice","api","domAPI","update","newObj","remove","lastIdentifiers","newList","index","newLastIdentifiers","_index","memo","insert","style","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","e","getTarget","Error","appendChild","element","createElement","setAttributes","attributes","styleElement","nonce","setAttribute","insertStyleElement","styleTagTransform","apply","parentNode","removeChild","removeStyleElement","styleSheet","cssText","firstChild","createTextNode","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","code","ids","t","keys","Object","__webpack_module_cache__","moduleId","cachedModule","__webpack_modules__","m","n","getter","__esModule","d","a","getPrototypeOf","value","mode","ns","create","r","def","current","indexOf","getOwnPropertyNames","forEach","key","definition","defineProperty","enumerable","get","f","chunkId","all","reduce","promises","u","prop","prototype","hasOwnProperty","call","l","url","done","script","needAttach","scripts","getElementsByTagName","s","getAttribute","charset","timeout","nc","src","onScriptComplete","prev","event","onerror","onload","clearTimeout","doneFns","fn","setTimeout","bind","type","Symbol","toStringTag","p","installedChunks","j","installedChunkData","promise","reject","error","errorType","realSrc","message","name","request","webpackJsonpCallback","parentChunkLoadingFunction","chunkIds","moreModules","runtime","some","chunkLoadingGlobal","self","Program","constructor","gl","vertexShaderSource","fragmentShaderSource","vertexShader","createShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","program","createProgram","use","useProgram","attribute","getAttribLocation","uniform","getUniformLocation","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","deleteShader","attachShader","linkProgram","getProgramParameter","LINK_STATUS","deleteProgram","ColorProgram","super","info","position","color","uniforms","matrix","TextureProgram","texcoord","loadTexture","callback","texture","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","Uint8Array","image","Image","addEventListener","radToDeg","Math","PI","degToRad","m4","translation","v","x","y","z","identity","rotate","mTarget","multiply","xRotation","yRotation","zRotation","angleInRadians","c","cos","sin","scaling","translate","xRotate","yRotate","zRotate","scale","perspective","fieldOfViewInRadians","aspect","near","far","tan","rangeInv","makeZToWMatrix","fudgeFactor","b","a11","a12","a13","a14","a21","a22","a23","a24","a31","a32","a33","a34","a41","a42","a43","a44","b11","b12","b13","b14","b21","b22","b23","b24","b31","b32","b33","b34","b41","b42","b43","b44","multiplyScalar","scalar","el","det","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","inverse","dst","Array","m00","m01","m02","m03","m10","m20","m30","tmp_0","tmp_1","tmp_2","tmp_3","tmp_4","tmp_5","tmp_6","tmp_7","tmp_8","tmp_9","tmp_10","tmp_11","tmp_12","tmp_13","tmp_14","tmp_15","tmp_16","tmp_17","tmp_18","tmp_19","tmp_20","tmp_21","tmp_22","tmp_23","t0","t1","t2","t3","lookAt","zAxis","substract","normalize","xAxis","yAxis","cross","getPositionVector","getScaleVector","magnitude","getRotationMatrix","Vec2","set","static","array","vec","add","multiplyByVector","abs","equals","toVec3","one","zero","forward","backward","right","left","up","down","copy","xInverted","yInverted","zInverted","isGreater","isLess","dot","distanceTo","sqrt","horizontalDistanceTo","yZeroed","to","inverted","transformMat4","w","out","clone","angle","minusOneOrZeroOrOne","toVec2","Transform","rotation","originTranslation","reset","transform","Shape","firstBufferReady","bb","texturedWidth","updateBuffers","verticesTransformed","verticesVec3Array","verticesCount","VERTICES","xVertices","filter","_","yVertices","zVertices","size","max","min","sizeRotated","rotationMatrix","halfSize","halfSizeRotated","texturedSize","setInitialState","initialTransform","initialTexcoords","TEXCOORDS","slice","onCreation","setPositionBuffer","setColorBuffer","setTexcoordsBuffer","bindGeometry","positionLocation","enableVertexAttribArray","bindBuffer","ARRAY_BUFFER","positionBuffer","FLOAT","vertexAttribPointer","bindColors","colorLocation","colorBuffer","texcoordsLocation","texcoordsBuffer","bindTransform","matrixLocation","viewProjectionMatrix","uniformMatrix4fv","draw","webglTexture","_draw","primitiveType","TRIANGLES","drawArrays","createBuffer","bufferData","STATIC_DRAW","COLORS","CuboidBoundingBox","shape","vertices","negativeCorner","negativeCornerRotated","positiveCorner","positiveCornerRotated","isColliding","pos","neg","pointSide","diffRotated","nearestDistanceDirection","side","nearestCorner","pointSideRotated","pointFarthestSideRotated","pointFarthestSide","diff","cornerRelative","basePointsYZeroed","Cuboid","Float32Array","defaultColors","texturesInLine","setTexture","setColor","wall","wallTexcoords","initialWallTexcoords","resetColor","textureSize","textureNumber","wallNumber","newTexcoords","setTexcoordsToTexture","texcoords","verticesVec2Array","arrayToVec2Array","texturePos","floor","vertex","vec2ArrayToArray","gridSize","uiScale","debug","soundVolume","musicVolume","BetterAudio","sound","volume","playLoading","audio","Audio","Config","play","currentTime","playPromise","playIfNotPlayed","pause","loop","Door","importedTexture","openAudio","closeAudio","opening","closing","openingSpeed","openingLength","hiddenInWallScaleCorrection","lightTexture","lightSideTexture","darkTexture","darkSideTexture","translationFinal","mFinal","positionDeltaFinal","positionFinal","deltaTime","positionDelta","closed","opened","toggle","canInteract","tryToClose","camera","enemies","every","Menu","audioSelect","audioMove","audioBack","option","timeSinceLastBlink","timeSinceBlinkStart","blinkInterval","blinkDuration","optionSize","canvas","ctx","getContext","width","height","menuUnselected","menuSelected","menuSelectedBlink","UI","instance","state","drawImage","LevelEnd","displayTime","bonusScore","animation","enemiesRatio","secretsRatio","treasuresRatio","imageSmoothingEnabled","levelEnd","uiElements","font","setInterval","calculateValues","endTime","Date","timeDiff","getTime","startTime","toTimeString","substring","playTimeSeconds","enemiesKilled","enemiesCount","secretsFound","secretsCount","treasuresFound","treasuresCount","ratio","score","drawTime","drawBonusScore","drawRatios","drawDigit","parseInt","digit","Weapon","fireRate","damage","initTextures","loopTextures","shootTexture","range","shooting","willShoot","justShot","textureIndex","currentTextures","isAutomatic","isTextureLastInit","framesCount","getNextTexture","getNextShootingTexture","getNextStoppedShootingTexture","Weapons","availableTypes","weapons","texturesCount","timeSinceLastUpdate","currentWeapon","find","weapon","Input","lastNumber","includes","setShooting","ammo","shot","shoot","decreaseAmmo","frameTime","context","row","col","LoadingScreen","progress","loadingTime","beforeLoadingDelay","afterLoadingDelay","fillStyle","fillRect","DeathScreen","frame","started","reversed","pixels","createImageData","start","interval","setPixelRed","offset","setPixelTransparent","feistelNet","input","nl","clearInterval","putImageData","audioSplash","audioMenu","audioLevel","lives","health","faceDirection","faceState","faceAnimationSteps","lastFaceAnimationStepsCount","showingMenu","flashing","flashCompletion","flashDuration","menu","loadingScreen","deathScreen","init","ui","elements","startScreen","uiCanvas","getElementById","onclick","onkeydown","onkeyup","takeLife","currentStep","duration","shift","startFaceAnimation","direction","stepsCount","random","clearRect","drawNumber","drawWeaponUI","drawFace","flashColor","flashIntensity","faceColumn","faceRow","weaponNumber","number","digits","split","reverse","entries","flashRed","flashYellow","sprinting","interacting","justInteracted","noclip","renderWalls","justChangedRenderWalls","pressedKeys","addKeyUpListener","addKeyDownListener","addAdditionalListeners","inputsBlocked","isPressed","Camera","killer","audioHit","audioDeath","fov","zNear","zFar","rotationSpeed","movementSpeed","collisionRadius","interactionDistance","blockedDirections","updateProjectionMatrix","cameraMatrix","speed","move","collidingShapes","nearest","shapes","sort","inInteractionDistance","transformMatrix","deltaPosition","blockedDirection","checkCollisions","angleTo","targetPosition","toTargetDir","lookingAtDir","toTargetAngle","atan2","angleDiff","cuboidCollisionSide","cuboid","cameraToWallDirection","steps","collisionCandidates","currentRadius","collidingPointTranslation","collidingPoint","candidate","collisionSide","nearestCornerDiff","uniqueBlockedDirections","findIndex","isLookingAt","enemy","targetXDir","enemyLeft","enemyRight","angleLeft","angleRight","projectionMatrix","fieldOfViewRadians","lookAtKillerStep","Textures","load","alreadyCreatedTextures","Map","textures","Set","loadHtmlImages","textureToHtmlImageMap","has","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","NEAREST_MIPMAP_LINEAR","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","generateMipmap","importedTextures","htmlImages","imagesToLoad","onImageLoad","Wall","nearDoorLightTexture","nearDoorDarkTexture","textureColor","toLowerCase","textureName","lastLetter","substr","_darkTexture","_lightTexture","Pathfinder","allSubFieldsCreated","envFields","open","subdivisions","subGridSize","prepareLevel","level","gridFields","subFieldPosData","gridPos","subGridPosToGridPos","envField","walkable","NotCollidingFieldValues","gridPosToRealPos","realPosVec2","realPosToSubGridPos","gridPosVec3","getAllPathLocations","from","subGridFrom","subGridTo","_getAllPathfindLocations","subGridField","subGridPos","subGridPosToRealPos","realPos","startField","PathField","endField","leastFCostField","getPathUsingParents","validNeighbours","getValidNeighbours","neighbour","calculateCost","acc","loc","fCost","field","gCostWithParent","gCost","parent","hDiff","hCost","neighbourPos","subFieldAlreadyCreated","allWalkable","corner","subField","end","path","Raycaster","dir","squareGenerator","nextSquareGenerator","nextSquare","next","nextShape","limit","startClone","dirClone","firstTileCenter","firstYield","nextTileCenter","nextIntersection","nextSquareInner","nextIntersectingAxes","ceil","diffRatio","dirRatio","nextSquareInDirection","Plane","colors","hexToRgb","exec","Pickup","pickupRange","pickedUp","firstTextureSet","lookAtCamera","cameraY","canBePickedUp","pickUp","onPickedUp","Ammo","ammoCount","Flag","Enemy","pathfinderFields","textureRotation","stateToTextureMap","shotNoticeDistance","shootingDistance","damageDealed","walkingDirection","hp","followingSpeed","nextDir","timeSinceLastPathfinding","pathfindingDelay","audioSight","audiosDie","audioShot","loot","tempFlag","initialState","isDead","followingPlayer","pathfind","destination","makeStepTowardsPlayer","doors","futureField","door","makeStepIfWalking","fromDir","rotateTexture","correctedDiff","canSee","fromTo","tryToShoot","HealthItem","healthRestored","DogFood","Food","HealthPack","Machinegun","GridBoundingBox","center","Decoration","createBB","DecorationMap","PointItem","givenScore","GoldenCross","GoldenCup","GoldenBox","GoldenCrown","PowerUp","Lever","pressedTexture","WallSecretDoor","dirToCalculate","calculateDir","toCamera","Level","textureProgram","colorProgram","walls","secretWalls","collidingCuboids","interactables","pickups","decorations","loadLevel","createObjects","spawnLoot","default","fields","parse","checkWallsDirections","changeWallsNeighboursTextures","applyGridSize","horizontalNeighbours","verticalNeighbours","wallDirection","playerPositionData","playerPosition","getLevelObjectsList","ammos","dogFoods","foods","healthPacks","powerUps","machineguns","goldenCrosses","goldenCups","goldenBoxes","goldenCrowns","exits","decorationName","ceiling","SpecificShape","objects","Crosshair","Game","fixedUpdateInterval","currentLevel","firstLevelLoaded","initWebgl","crosshair","decoration","startGameLoop","render","now","requestAnimationFrame","fixedDeltaTime","fixedUpdate","nearestInteractable","pickup","secretWall","shapeLookedAt","startFollowing","distance","setDrawSettings","exit","alert","clearColor","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","enable","BLEND","CULL_FACE","DEPTH_TEST","resizeCanvasToDisplaySize","viewport","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","displayWidth","displayHeight","resizeNeeded"],"sourceRoot":""}